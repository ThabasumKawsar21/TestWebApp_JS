var LocationCount;
var Duplicatecount = false;




$(document).unbind('keydown').bind('keydown', function (event) {
    if (event.keyCode === 8) {
        var doPrevent = true;
        var types = ["text", "password", "file", "search", "email", "number", "date", "color", "datetime", "datetime-local", "month", "range", "search", "tel", "time", "url", "week"];
        var d = $(event.srcElement || event.target);
        var disabled = d.prop("readonly") || d.prop("disabled");
        if (!disabled) {
            if (d[0].isContentEditable) {
                doPrevent = false;
            } else if (d.is("input")) {
                var type = d.attr("type");
                if (type) {
                    type = type.toLowerCase();
                }
                if (types.indexOf(type) > -1) {
                    doPrevent = false;
                }
            } else if (d.is("textarea")) {
                doPrevent = false;
            }
        }
        if (doPrevent) {
            event.preventDefault();
            return false;
        }
    }
});

function allplyallcompany() {
    $(".changecomany").val($("#txtothers").val());
}

function isNumberKey(evt) {
    var charCode = (evt.which) ? evt.which : evt.keyCode;
    if (charCode > 31 && (charCode < 48 || charCode > 57))
        return false;
    return true;
}

function isvalidmobile(evt) {
    if (evt != "-1") {
        var Countrycode = document.getElementById("tdtxtCountryCode" + evt + "");
        var Countrycodetext = Countrycode.options[Countrycode.selectedIndex].text;
        var mobile = $("#tdtxtmobileno" + evt).val();
        if (Countrycodetext == "+91") {
            if (mobile.length > 10 || mobile.length < 10) {
                $("#spnerrorspan").text("Enter Valid Mobile Number.");
                $("#tdtxtmobileno" + evt).css('border-color', '#f4633a');
                $("#spnerror").show();
                $("#fade").hide();
                $("#modal").hide();
                return false;
            }
            else {
                $("#tdtxtmobileno" + evt).css('border', '1px solid #d6d6d6');
                $("#spnerror").hide();
            }
        }
        else {
            if (mobile.length > 1) {
                $("#tdtxtmobileno" + evt).css('border', '1px solid #d6d6d6');
                $("#spnerror").hide();
            }
        }
    }
    else {
        var Countrycode1 = document.getElementById("tdtxtCountryCode");
        var Countrycodetext1 = Countrycode1.options[Countrycode1.selectedIndex].text;
        var mobile1 = $("#tdtxtmobileno").val();
        if (Countrycodetext1 == "+91") {
            if (mobile1.length > 10 || mobile1.length < 10) {
                $("#spnerrorspan").text("Enter Valid Mobile Number.");
                $("#tdtxtmobileno").css('border-color', '#f4633a');
                $("#spnerror").show();
                $("#fade").hide();
                $("#modal").hide();
                return false;
            }
            else {
                $("#tdtxtmobileno").css('border', '1px solid #d6d6d6');
                $("#spnerror").hide();
            }
        }
        else {
            if (mobile1.length > 1) {
                $("#tdtxtmobileno").css('border', '1px solid #d6d6d6');
                $("#spnerror").hide();
            }
        }
    }
}
function off() {
    document.getElementById("overlay").style.display = "none";
}

function hide_dp() {
    $(".visitdatetex").datepicker('hide');
}

$(document).ready(function () {
    //if (AlertMessage == 'Y') {
    //    $("#coronaguideline").addClass('show');
    //}
    //else {
    //    $("#coronaguideline").removeClass('show');
    //}
    //document.getElementById("overlay").style.display = "block";           
    $("#fade").show();
    $("#modal").show();

    $.ajax({
        url: 'HomePage.aspx/GetCovidValue',
        data: '',
        dataType: "json",
        type: "POST",
        contentType: "application/json; charset=utf-8",
        success: function (data) {
            if (data.d == 'Y') {
                $("#coronaguideline").addClass('show');
            }
            else {
                $("#coronaguideline").removeClass('show');
            }
        },
        error: function () {
        }
    });

    $("#AddMoreLocation").removeAttr("disabled");
    var input = document.getElementById("txtSerachbox");
    input.addEventListener("keyup", function (event) {
        event.preventDefault();
        var X = $("#txtSerachbox").val();
        if (X != null && X != "" && X != undefined) {
            if (event.keyCode === 13) {
                //var btntext = $("#btnSearch").text();
                //if (btntext == "Search") {
                document.getElementById("btnSearch").click();
                $(".dataaccesscheckbox1").prop("checked", false);
                //}
                //else {
                //    $("#btnSearch").text("Search");
                //    $("#txtSerachbox").val("");
                //    $.ajax({
                //        type: "POST",
                //        url: "HomePage.aspx/GetRecentVisitors",
                //        contentType: "application/json;charset=utf-8",
                //        data: "{'visitorCount': " + parseInt("10") + "}",
                //        dataType: "json",
                //        success: function (data) {
                //            var RecentData_append = "";
                //            if (data.d == "" || data.d == null || data.d == undefined) {
                //                $("#RecentVisitortablebody").html("<tr style='height:395px;'><td></td><td></td><td></td><td style='width:184px;color:#596679;font:14px Proxima-Nova-Sbold;'>No Recent Visitors Found</td><td></td><td></td><td></td></tr>");
                //                $("#fade").hide();
                //                $("#modal").hide();
                //            }
                //            else {
                //                var Recentdata = JSON.parse(data.d);
                //                if (Recentdata.length > 0) {
                //                    for (var i = 0; i < Recentdata.length; i++) {
                //                        if (i % 2 == 0) {
                //                            RecentData_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Recentdata[i].VisitorId + "'>";
                //                        }
                //                        else {
                //                            RecentData_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Recentdata[i].VisitorId + "'>";
                //                        }
                //                        RecentData_append += "<td style='width:44px;text-align:center;'>";
                //                        RecentData_append += "<input type='checkbox' value='" + Recentdata[i].VisitorId + "' class='dataaccesscheckbox' id='tdchkselect" + Recentdata[i].VisitorId + "' onchange='UserSelectChange(" + Recentdata[i].VisitorId + ")'>";
                //                        RecentData_append += "</td>";
                //                        RecentData_append += "<td class='Recentvisitortabletd' style='width:168px;'>";
                //                        RecentData_append += "<input type='text' id='tdtxtvisitorName" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].VisitorFullName + "' disabled />";
                //                        RecentData_append += "</td>";
                //                        RecentData_append += "<td class='Recentvisitortabletd' style='width:150px;'>";
                //                        RecentData_append += "<input type='text' id='tdtxtcompany" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].Company + "' disabled />";
                //                        RecentData_append += "</td>";
                //                        RecentData_append += "<td class='Recentvisitortabletd' style='width:158px;'>";
                //                        RecentData_append += "<select type='text' id='tdtxtvisitortype" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' disabled ><option>" + Recentdata[i].VisitorType + "</option></select>";
                //                        RecentData_append += "</td>";
                //                        RecentData_append += "<td class='Recentvisitortabletd' style='width:215px;'>";
                //                        var Mobile = Recentdata[i].MobileNo.split('-');
                //                        RecentData_append += "<select type='text' id='tdtxtCountryCode" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' style='width:40px;' disabled ><option>" + Mobile[0] + "</option></select>-<input id='tdtxtmobileno" + Recentdata[i].VisitorId + "' maxlength='10' onkeypress='return isNumberKey(event)' onfocusout='return isvalidmobile(" + Recentdata[i].VisitorId + ")' style='margin-left:2%;' class='Recentvisitortabletextbox' type='text' value='" + Mobile[1] + "' disabled />";
                //                        RecentData_append += "</td>";
                //                        RecentData_append += "<td class='Recentvisitortabletd' style='width:120px;'>";
                //                        if (Recentdata[i].PermitITEquipments == true) {
                //                            RecentData_append += "<a title='Please click here to add equipment details' id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#00b140;cursor:pointer;' onclick='OpenEquipment(" + Recentdata[i].VisitorId + ",0)' name='" + Recentdata[i].VisitorId + "'>Yes</a>";
                //                        }
                //                        else {
                //                            RecentData_append += "<a title='Please click here to add equipment details' id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#596679;cursor:pointer;' onclick='OpenEquipment(" + Recentdata[i].VisitorId + ",0)' name='0'>No</a>";
                //                        }
                //                        RecentData_append += "</td>";
                //                        RecentData_append += "<td style='width:48px;'>";
                //                        RecentData_append += "<img id='tdimgsave" + Recentdata[i].VisitorId + "' title='Save' src='images/New%20Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;  background: url(images/New%20Images/VMS-Icons.png) no-repeat -37px -235px;' onclick='SaveTableRow(" + Recentdata[i].VisitorId + ")' />";
                //                        RecentData_append += "<img id='tdimgcancel" + Recentdata[i].VisitorId + "' title='Cancel' src='images/New%20Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;  background: url(images/New%20Images/VMS-Icons.png) no-repeat -288px -163px;' onclick='CancelTableRow(" + Recentdata[i].VisitorId + ")' />";
                //                        RecentData_append += "<img id='tdimgedit" + Recentdata[i].VisitorId + "' title='Edit' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;' onclick='EditTableRow(" + Recentdata[i].VisitorId + ")' />";
                //                        RecentData_append += "</td>";
                //                        RecentData_append += "</tr >";
                //                    }
                //                    $("#RecentVisitortablebody").html(RecentData_append);
                //                    $('.divRecentvisitor').slimScroll({
                //                        height: '432px',
                //                        width: '100%'
                //                    });
                //                }
                //                else {
                //                    $("#fade").hide();
                //                    $("#modal").hide();
                //                }
                //            }

                //        },
                //        error: function (result) {
                //            $("#fade").hide();
                //            $("#modal").hide();
                //        }
                //    });
                //}
            }
            else {
                //$("#btnSearch").text("Search");
                $(".dataaccesscheckbox1").prop("checked", false);
            }
        }
        else {
            //$("#btnSearch").text("Search");
            $(".dataaccesscheckbox1").prop("checked", false);
            $.ajax({
                type: "POST",
                url: "HomePage.aspx/GetRecentVisitors",
                contentType: "application/json;charset=utf-8",
                data: "{'visitorCount': " + parseInt("9") + "}",
                dataType: "json",
                success: function (data) {
                    var RecentData_append = "";
                    if (data.d == "" || data.d == null || data.d == undefined) {
                        $("#RecentVisitortablebody").html("<tr style='height:395px;'><td></td><td></td><td></td><td style='width:210px;color:#596679;font:14px Arial-Regular;'>No Recent Visitors Found</td><td></td><td></td><td></td></tr>");
                        $("#tblRecentvisitor tbody td").css("border", "none");
                        $("#tblRecentvisitor thead td").css("border", "2px solid #dfe9f4");
                        $("#fade").hide();
                        $("#modal").hide();
                    }
                    else {
                        var Recentdata = JSON.parse(data.d);
                        if (Recentdata.length > 0) {
                            for (var i = 0; i < Recentdata.length; i++) {
                                if (i % 2 == 0) {
                                    RecentData_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Recentdata[i].VisitorId + "'>";
                                }
                                else {
                                    RecentData_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Recentdata[i].VisitorId + "'>";
                                }
                                RecentData_append += "<td style='width:44px;text-align:center;'>";
                                RecentData_append += "<input type='checkbox' value='" + Recentdata[i].VisitorId + "' class='dataaccesscheckbox' id='tdchkselect" + Recentdata[i].VisitorId + "' onchange='UserSelectChange(" + Recentdata[i].VisitorId + ")'>";
                                RecentData_append += "</td>";
                                RecentData_append += "<td class='Recentvisitortabletd' style='width:168px;'>";
                                RecentData_append += "<input type='text' maxlength='25' id='tdtxtvisitorName" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].VisitorFullName + "' disabled />";
                                RecentData_append += "</td>";
                                RecentData_append += "<td class='Recentvisitortabletd' style='width:215px;'>";
                                var Mobile = Recentdata[i].MobileNo.split('-');
                                RecentData_append += "<select type='text' id='tdtxtCountryCode" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' style='width:54px;' disabled ><option>" + Mobile[0] + "</option></select>-<input id='tdtxtmobileno" + Recentdata[i].VisitorId + "' maxlength='10' onkeypress='return isNumberKey(event)' onfocusout='return isvalidmobile(" + Recentdata[i].VisitorId + ")' style='margin-left:0%;width:73px;' class='Recentvisitortabletextbox' type='text' value='" + Mobile[1] + "' disabled />";
                                RecentData_append += "</td>";
                                RecentData_append += "<td class='Recentvisitortabletd' style='width:150px;'>";
                                RecentData_append += "<input type='text' maxlength='25' id='tdtxtcompany" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].Company + "' disabled />";
                                RecentData_append += "</td>";
                                RecentData_append += "<td class='Recentvisitortabletd' style='width:158px;'>";
                                RecentData_append += "<select type='text' id='tdtxtvisitortype" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' disabled ><option>" + Recentdata[i].VisitorType + "</option></select>";
                                RecentData_append += "</td>";

                                RecentData_append += "<td class='Recentvisitortabletd' style='width:120px;'>";
                                if (Recentdata[i].PermitITEquipments == true) {
                                    RecentData_append += "<a title='Please click here to add equipment details' id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#00b140;cursor:pointer;text-decoration:underline;' onclick='OpenEquipment(" + Recentdata[i].VisitorId + ",0)' name='" + Recentdata[i].VisitorId + "'>Yes</a>";
                                }
                                else {
                                    RecentData_append += "<a title='Please click here to add equipment details' id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#596679;cursor:pointer;' name='0'>No</a>";
                                }
                                RecentData_append += "</td>";
                                RecentData_append += "<td style='width:48px;'>";
                                RecentData_append += "<img id='tdimgsave" + Recentdata[i].VisitorId + "' title='Save' src='images/New%20Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;  background: url(images/New%20Images/VMS-Icons.png) no-repeat -37px -235px;' onclick='SaveTableRow(" + Recentdata[i].VisitorId + ")' />";
                                RecentData_append += "<img id='tdimgcancel" + Recentdata[i].VisitorId + "' title='Cancel' src='images/New%20Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;  background: url(images/New%20Images/VMS-Icons.png) no-repeat -288px -163px;' onclick='CancelTableRow(" + Recentdata[i].VisitorId + ")' />";
                                RecentData_append += "<img id='tdimgedit" + Recentdata[i].VisitorId + "' title='Edit' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;' onclick='EditTableRow(" + Recentdata[i].VisitorId + ")' />";
                                RecentData_append += "</td>";
                                RecentData_append += "</tr >";
                            }
                            $("#RecentVisitortablebody").html(RecentData_append);
                            $('.divRecentvisitor').slimScroll({
                                height: '432px',
                                width: '100%'
                            });
                        }
                        else {
                            $("#fade").hide();
                            $("#modal").hide();
                        }
                    }

                },
                error: function (result) {
                    $("#fade").hide();
                    $("#modal").hide();
                }
            });
        }
    });
    $("#ddlpurpose").css('Z-index', '0');
    $("#ddlpurpose").css('opacity', '1');
    $(function () {
        $("#imgdate").on("click", function (e) {
            $('#sandbox-container input').datepicker('show');
        });

        $('#ddllocationlist').select2({
            matcher: function (params, data) {
                if ($.trim(params.term) === '') { return data; }
                if (typeof data.text === 'undefined') { return null; }
                var q = params.term.toLowerCase();
                if (data.text.toLowerCase().indexOf(q) > -1 || data.id.toLowerCase().indexOf(q) > -1) {
                    return $.extend({}, data, true);
                }
                return null;
            }
        });
    });

    var CurrentLocation = document.getElementById("hdnLocationCode").value;

    $('#ddllocationlist').val(CurrentLocation);
    $('#ddllocationlist').trigger('change');

    $(function () {
        $('#sandbox-container input').datepicker({
            clearBtn: true,
            multidate: true,
            todayHighlight: true,
            startDate: "new Date()"
        });

    });
    $("#txtstarttime").kendoTimePicker({
        dateInput: true,
        value: "09:00",
        format: "HH:mm",
        interval: 15
    });
    $("#txtendtime").kendoTimePicker({
        dateInput: true,
        value: "18:00",
        interval: 15,
        format: "HH:mm",
        change: function (e) {
            var start = $("#txtstarttime").val();
            var end = $("#txtendtime").val();
            if (start != "" || start != null || start != undefined) {
                var dtStart = new window.Date("1/1/2011 " + start);
                var dtEnd = new window.Date("1/1/2011 " + end);
                var difference_in_milliseconds = dtEnd - dtStart;
                if (difference_in_milliseconds <= 0) {
                    $("#Timespnerrorspan").text("To Time should be greater than From Time");
                    $("#txtstarttime").css('border-color', '#f4633a');
                    $("#Timespnerror").show();
                    $("#txtendtime").css('border-color', '#f4633a');
                    $("#fade").hide();
                    $("#modal").hide();
                    return false;
                }
                else {
                    $("#Timespnerror").hide();
                }
            }
        }
    });
    var span = document.getElementsByClassName("close")[0];
    var modal = document.getElementById('myModal');
    var Cartmodal = document.getElementById('CardModel');
    var BulkModel = document.getElementById('BulkModel');
    span.onclick = function () {
        modal.style.display = "none";
        Cartmodal.style.display = "none";
        BulkModel.style.display = "none";
    }
    $(".btnPreviewSubmit").click(function () {
        //$("#btnSearch").text("Search");
        $("#txtSerachbox").val("");
        var text = $(".btnPreviewSubmit").text();
        if (text == "Preview & Submit") {
            var tbody = $("#tbodycart");
            if (tbody.children().length != 0) {
                Cartmodal.style.display = "block";
            }
        }
        else if (text == "Submit Bulk Associates") {
            $("#fade").show();
            $("#modal").show();
            var Visitordrop = document.getElementById("ddlpurpose");
            var VisitorType = Visitordrop.options[Visitordrop.selectedIndex].text;
            if (VisitorType == "Select Visitor Type") {
                $("#visitorspnerror").show();
                $("#ddlpurpose").css('border-color', '#f4633a');
                $("#fade").hide();
                $("#modal").hide();
                return false;
            }
            else {
                $("#ddlpurpose").css('border-color', '#0033a0');
            }
            var Others = "";
            if (VisitorType == "Others") {
                Others = $("#txtothers").val();
                if (Others == "" || Others == null | Others == undefined) {
                    $("#Otherspnerror").show();
                    $("#txtothers").css('border-color', '#f4633a');
                    $("#fade").hide();
                    $("#modal").hide();
                    return false;
                }
            }
            else {
                $("#txtothers").css('border-color', '#d6d6d6');
            }
            var HostId = "";
            //if (HostId == "" || HostId == null || HostId == undefined) {
            //    $("#lblerrormessage").text("Enter Host ID");
            //    $("#txthostID").css('border-color', '#f4633a');
            //    $("#fade").hide();
            //    $("#modal").hide();
            //    return false;
            //}
            var Date = $("#txtvisitdate").val();
            if (Date == "" || Date == null || Date == undefined) {
                $("#datespnerror").show();
                $("#txtvisitdate").css('border-color', '#f4633a');
                $("#fade").hide();
                $("#modal").hide();
                return false;
            }
            else {
                $("#txtvisitdate").css('border-color', '#d6d6d6');
            }
            var StartTime = $("#txtstarttime").val();
            if (StartTime == "" || StartTime == null || StartTime == undefined || StartTime == "Start Time") {
                $("#Timespnerrorspan").text("select Start Time");
                $("#Timespnerror").show();
                $("#txtstarttime").css('border-color', '#f4633a');
                $("#fade").hide();
                $("#modal").hide();
                return false;
            }
            else {
                $("#txtstarttime").css('border-color', '#d6d6d6');
            }
            var ToTime = $("#txtendtime").val();
            if (ToTime == "" || ToTime == null || ToTime == undefined || ToTime == "End Time") {
                $("#Timespnerrorspan").text("select End Time");
                $("#txtendtime").css('border-color', '#f4633a');
                $("#Timespnerror").show();
                $("#fade").hide();
                $("#modal").hide();
                return false;
            }
            else {
                $("#txtendtime").css('border-color', '#d6d6d6');
            }

            var start = StartTime;
            var end = ToTime;
            var dtStart = new window.Date("1/1/2011 " + start);
            var dtEnd = new window.Date("1/1/2011 " + end);
            var difference_in_milliseconds = dtEnd - dtStart;
            if (difference_in_milliseconds <= 0) {
                $("#Timespnerrorspan").text("To Time should be greater than From Time");
                $("#txtstarttime").css('border-color', '#f4633a');
                $("#Timespnerror").show();
                $("#txtendtime").css('border-color', '#f4633a');
                $("#fade").hide();
                $("#modal").hide();
                return false;
            }
            else {
                $("#txtstarttime").css('border-color', '#d6d6d6');
                $("#txtendtime").css('border-color', '#d6d6d6');
            }

            var currenttoday = new window.Date();
            var currentdate = ('0' + (currenttoday.getMonth() + 1)).slice(-2) + '/' + ('0' + currenttoday.getDate()).slice(-2) + '/' + currenttoday.getFullYear();
            var s = Date.split(',');
            for (var x = 0; x < s.length; x++) {
                //var indexcurrentdate = Date.indexOf(currentdate);
                if (currentdate == s[x]) {
                    var now = new window.Date();
                    var hh = now.getHours();
                    var min = now.getMinutes();
                    var ampm = (hh >= 12) ? 'PM' : 'AM';
                    hh = hh % 12;
                    hh = hh ? hh : 12;
                    hh = hh < 10 ? '0' + hh : hh;
                    min = min < 10 ? '0' + min : min;
                    var time = hh + ":" + min + " " + ampm;
                    var dtStart = new window.Date("1/1/2011 " + time);
                    var dtEnd = new window.Date("1/1/2011 " + start);
                    var difference_in_milliseconds = dtEnd - dtStart;
                    if (difference_in_milliseconds <= 0) {
                        $("#Timespnerrorspan").text("Start time should not be past time.");
                        $("#txtstarttime").css('border-color', '#f4633a');
                        $("#Timespnerror").show();
                        $("#txtendtime").css('border-color', '#f4633a');
                        $("#fade").hide();
                        $("#modal").hide();
                        return false;
                    }
                    else {
                        $("#txtstarttime").css('border-color', '#d6d6d6');
                        $("#txtendtime").css('border-color', '#d6d6d6');
                    }
                }
            }


            var LocationNamedrop = document.getElementById("ddllocationlist");
            var LocationName = LocationNamedrop.options[LocationNamedrop.selectedIndex].text;
            if (LocationName == "Select Visiting Location") {
                $("#Locationspnerror").show();
                $(".select2-selection select2-selection--single").css('border-color', '#f4633a');
                $("#fade").hide();
                $("#modal").hide();
                return false;
            }
            else {
                $(".select2-selection select2-selection--single").css('border-color', '#d6d6d6');
            }
            $.ajax({
                type: "POST",
                url: "HomePage.aspx/InsertBulkRecords",
                contentType: "application/json;charset=utf-8",
                data: '{"locationName": "' + LocationName + '","hostId":"' + HostId + '","date":"' + Date + '","startTime":"' + StartTime + '","totime":"' + ToTime + '","status":"Insert","visitorType":"' + VisitorType + '","others":"' + Others + '"}',
                dataType: "json",
                success: function (data) {
                    $(".dataaccesscheckbox1").removeAttr("disabled");
                    $.ajax({
                        type: "POST",
                        url: "HomePage.aspx/GetRecentVisitors",
                        contentType: "application/json;charset=utf-8",
                        data: "{'visitorCount':" + parseInt("9") + "}",
                        dataType: "json",
                        success: function (data) {
                            if (data.d == "" || data.d == null || data.d == undefined) {
                                $("#RecentVisitortablebody").html("<tr style='height:395px;'><td></td><td></td><td></td><td style='width:210px;color:#596679;font:14px Arial-Regular;'>No Recent Visitors Found</td><td></td><td></td><td></td></tr>");
                                $("#tblRecentvisitor tbody td").css("border", "none");
                                $("#tblRecentvisitor thead td").css("border", "2px solid #dfe9f4");
                                $("#fade").hide();
                                $("#modal").hide();
                            }
                            else {
                                var Recentdata = JSON.parse(data.d);
                                var RecentData_append = "";
                                if (Recentdata.length > 0) {
                                    for (var i = 0; i < Recentdata.length; i++) {
                                        if (i % 2 == 0) {
                                            RecentData_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Recentdata[i].VisitorId + "'>";
                                        }
                                        else {
                                            RecentData_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Recentdata[i].VisitorId + "'>";
                                        }
                                        RecentData_append += "<td style='width:44px;text-align:center;'>";
                                        RecentData_append += "<input type='checkbox' value='" + Recentdata[i].VisitorId + "' class='dataaccesscheckbox' id='tdchkselect" + Recentdata[i].VisitorId + "' onchange='UserSelectChange(" + Recentdata[i].VisitorId + ")'>";
                                        RecentData_append += "</td>";
                                        RecentData_append += "<td class='Recentvisitortabletd' style='width:168px;'>";
                                        RecentData_append += "<input type='text' maxlength='25' id='tdtxtvisitorName" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].VisitorFullName + "' disabled />";
                                        RecentData_append += "</td>";
                                        RecentData_append += "<td class='Recentvisitortabletd' style='width:215px;'>";
                                        var Mobile = Recentdata[i].MobileNo.split('-');
                                        RecentData_append += "<input type='text' id='tdtxtCountryCode" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' style='width:28px;' value='" + Mobile[0] + "' disabled />-<input id='tdtxtmobileno" + Recentdata[i].VisitorId + "' maxlength='10' style='margin-left:0%;width:73px;' class='Recentvisitortabletextbox' type='text' value='" + Mobile[1] + "' disabled />";
                                        RecentData_append += "</td>";
                                        RecentData_append += "<td class='Recentvisitortabletd' style='width:150px;'>";
                                        RecentData_append += "<input type='text' maxlength='25' id='tdtxtcompany" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].Company + "' disabled />";
                                        RecentData_append += "</td>";
                                        RecentData_append += "<td class='Recentvisitortabletd' style='width:158px;'>";
                                        RecentData_append += "<select type='text' id='tdtxtvisitortype" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' disabled ><option>" + Recentdata[i].VisitorType + "</option></select>";
                                        RecentData_append += "</td>";

                                        RecentData_append += "<td class='Recentvisitortabletd' style='width:120px;'>";
                                        if (Recentdata[i].PermitITEquipments == true) {
                                            RecentData_append += "<a title='Please click here to add equipment details' id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#00b140;cursor:pointer;text-decoration:underline;' onclick='OpenEquipment(" + Recentdata[i].VisitorId + ",0)' name='" + Recentdata[i].VisitorId + "'>Yes</a>";
                                        }
                                        else {
                                            RecentData_append += "<a title='Please click here to add equipment details' id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#596679;cursor:pointer;' onclick='OpenEquipment(" + Recentdata[i].VisitorId + ",0)' name='0'>No</a>";
                                        }
                                        RecentData_append += "</td>";
                                        RecentData_append += "<td style='width:48px;text-align:center;'>";
                                        RecentData_append += "<img id='tdimgsave" + Recentdata[i].VisitorId + "' title='Save' src='images/New%20Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;  background: url(images/New%20Images/VMS-Icons.png) no-repeat -37px -235px;' onclick='SaveTableRow(" + Recentdata[i].VisitorId + ")' />";
                                        RecentData_append += "<img id='tdimgcancel" + Recentdata[i].VisitorId + "' title='Cancel' src='images/New%20Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;  background: url(images/New%20Images/VMS-Icons.png) no-repeat -288px -163px;' onclick='CancelTableRow(" + Recentdata[i].VisitorId + ")' />";
                                        RecentData_append += "<img id='tdimgedit" + Recentdata[i].VisitorId + "' title='Edit' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;' onclick='EditTableRow(" + Recentdata[i].VisitorId + ")' />";
                                        RecentData_append += "</td>";
                                        RecentData_append += "</tr >";
                                    }
                                    $("#RecentVisitortablebody").html(RecentData_append);
                                    $('.divRecentvisitor').slimScroll({
                                        height: '432px',
                                        width: '100%'
                                    });
                                }
                                $(".btnPreviewSubmit").text("Preview & Submit");
                                $(".btnPreviewSubmit").css("background-color", "#d9d9d9");
                                $(".btnPreviewSubmit").attr("disabled", "disabled");
                                $(".btnPreviewSubmit").attr("title", "Preview & Submit");
                                $(".btnAddCart").html("<img src='images/New%20Images/img_trans.gif' class='addtocarticon'>&nbsp; Add to Cart");
                                $(".btnAddCart").css("background-color", "#d9d9d9");
                                $(".btnAddCart").attr("disabled", "disabled");
                                $(".btnAddCart").attr("title", "Add to Cart");
                                $("#fade").hide();
                                $("#modal").hide();
                                document.getElementById("ddlpurpose").value = "0";
                                $('#ddllocationlist').val("0");
                                $('#ddllocationlist').trigger('change');
                                $('#sandbox-container input').datepicker('update', '');
                                $("#txtstarttime").val("09:00");
                                $("#txtendtime").val("18:00");
                                $("#txthostID").val("");
                                $("#AddMoreLocation").html("<img src='images/New%20Images/img_trans.gif' class='AddmoreDivimg' /> Add More Location");
                                $("#AddMoreLocation").attr("onclick", "AddExtraLocation(0)");
                                $("#AddMoreLocation").css("margin-left", "127px");
                                $("#spnerror").hide();
                                $("#txtothers").hide();
                                $("#divtxtothers").hide();
                            }
                        },
                        error: function (result) {
                            $("#fade").hide();
                            $("#modal").hide();
                        }
                    });

                    document.getElementById('Sucessmessage').style.display = 'block';
                    $("#Sucessmessagebody").html("Successfully submitted the request. A confirmation mail will be sent shortly.");
                },
                error: function (result) {
                    $("#fade").hide();
                    $("#modal").hide();
                }
            });
        }
        else if (text == "Update") {
            $("#fade").show();
            $("#modal").show();
            var Visitordrop = document.getElementById("ddlpurpose");
            var VisitorType = Visitordrop.options[Visitordrop.selectedIndex].text;
            if (VisitorType == "Select Visitor Type") {
                $("#ddlpurpose").css('border-color', '#f4633a');
                $("#visitorspnerror").show();
                $("#fade").hide();
                $("#modal").hide();
                return false;
            }
            else {
                $("#ddlpurpose").css('border-color', '#0033a0');
            }
            var Others = "";
            if (VisitorType == "Others") {
                Others = $("#txtothers").val();
                if (Others == null || Others == "" || Others == undefined) {
                    $("#Otherspnerror").show();
                    $("#txtothers").css('border-color', '#f4633a');
                    $("#fade").hide();
                    $("#modal").hide();
                    return false;
                }
                else {
                    $("#txtothers").css('border-color', '#d6d6d6');
                }
            }
            var MobileNo = $("#tdtxtCountryCode option:selected").text() + '-' + $("#tdtxtmobileno").val();
            if (MobileNo == "" || MobileNo == null || MobileNo == undefined) {
                $("#spnerrorspan").text("Enter Mobile Number");
                $("#tdtxtmobileno").css('border-color', '#f4633a');
                $("#spnerror").show();
                $("#fade").hide();
                $("#modal").hide();
                return false;
            }
            else {
                var Color = $("#tdtxtmobileno").css('border-color');
                if (Color == "rgb(214, 214, 214)") {
                    $("#tdtxtmobileno").css('border-color', '#d6d6d6');
                }
            }
            var code = $("#tdtxtCountryCode option:selected").text()
            var mob = $("#tdtxtmobileno").val();
            if (code == "+91") {
                if (mob.length < 10 || mob.length > 10) {
                    $("#spnerrorspan").text("Enter Valid Mobile Number");
                    $("#tdtxtmobileno").css('border-color', '#f4633a');
                    $("#spnerror").show();
                    $("#fade").hide();
                    $("#modal").hide();
                    return false;
                }
                else {
                    var Color = $("#tdtxtmobileno").css('border-color');
                    if (Color == "rgb(214, 214, 214)") {
                        $("#tdtxtmobileno").css('border-color', '#d6d6d6');
                    }
                }
            }
            var Name = $("#tdtxtvisitorName").val();
            if (Name == "" || Name == null || Name == undefined) {
                $("#spnerrorspan").text("Enter Visitor Name");
                $("#tdtxtvisitorName").css('border-color', '#f4633a');
                $("#spnerror").show();
                $("#fade").hide();
                $("#modal").hide();
                return false;
            }
            else {
                var Color = $("#tdtxtvisitorName").css('border-color');
                if (Color == "rgb(214, 214, 214)") {
                    $("#tdtxtvisitorName").css('border-color', '#d6d6d6');
                }
            }

            var Organization = $("#tdtxtcompany").val();
            if (VisitorType != "Family Members") {
                if (Organization == "" || Organization == null || Organization == undefined) {
                    $("#spnerrorspan").text("Enter Visitor organization");
                    $("#tdtxtcompany").css('border-color', '#f4633a');
                    $("#spnerror").show();
                    $("#fade").hide();
                    $("#modal").hide();
                    return false;
                } else {
                    var Color = $("#tdtxtcompany").css('border-color');
                    if (Color == "rgb(214, 214, 214)") {
                        $("#tdtxtcompany").css('border-color', '#d6d6d6');
                    }
                }
            }
            else {
                if (Organization == "Optional") {
                    Organization = "";
                }
            }

            var LocationNamedrop = document.getElementById("ddllocationlist");
            var LocationName = LocationNamedrop.options[LocationNamedrop.selectedIndex].text;
            if (LocationName == "Select Visiting Location") {
                $(".select2-container--default .select2-selection--single").css('border-color', '#f4633a');
                $("#Locationspnerror").show();
                $("#fade").hide();
                $("#modal").hide();
                return false;
            }
            else {
                $(".select2-container--default .select2-selection--single").css('border-color', '#d6d6d6');
            }
            //var HostId = $("#txthostID").val();
            //if (HostId == "" || HostId == null || HostId == undefined) {
            //    $("#spnerror").text("*Error : Enter Host ID");
            //    $("#txthostID").css('border-color', '#f4633a');
            //    $("#spnerror").show();
            //    $("#fade").hide();
            //    $("#modal").hide();
            //    return false;
            //}
            var indexlocation = LocationName.indexOf("IND");
            var HostId = $("#txthostID").val();
            if (VisitorType == "Client" && indexlocation >= 0) {
                if (HostId == "" || HostId == null || HostId == undefined) {
                    $("#Hostspnerrorspan").text("Enter Host ID");
                    $("#Hostspnerror").show();
                    $("#txthostID").css('border-color', '#f4633a');
                    $("#fade").hide();
                    $("#modal").hide();
                    return false;
                }
                else {
                    $("#txthostID").css('border-color', '#d6d6d6');
                }
                var hastindex = HostId.indexOf('(');
                if (hastindex < 0) {
                    $("#Hostspnerrorspan").text("Enter valid Host ID");
                    $("#Hostspnerror").show();
                    $("#txthostID").css('border-color', '#f4633a');
                    $("#fade").hide();
                    $("#modal").hide();
                    return false;
                }
                else {
                    $("#txthostID").css('border-color', '#d6d6d6');
                }
            }
            var Date = $("#txtvisitdate").val();
            if (Date == "" || Date == null || Date == undefined) {
                $("#txtvisitdate").css("border-color", "#f4633a");
                $("#divimgdate").css("border-color", "#f4633a");
                $("#datespnerror").show();
                $("#fade").hide();
                $("#modal").hide();
                return false;
            }
            else {
                $("#txtvisitdate").css("border-color", "#d6d6d6");
                $("#divimgdate").css("border-color", "#d6d6d6");
            }

            var array = Date.split(',');
            array.sort(function (a, b) {
                return new window.Date(a) - new window.Date(b);
            });

            var dataadd = "";
            for (var z = 0; z < array.length; z++) {
                dataadd += array[z] + ",";
            }
            var date = dataadd.substring(0, dataadd.length - 1);
            Date = date;

            var StartTime = $("#txtstarttime").val();
            if (StartTime == "" || StartTime == null || StartTime == undefined || StartTime == "Start Time") {
                $("#Timespnerrorspan").text("Enter Start Time");
                $("#txtstarttime").css('border-color', '#f4633a');
                $("#Timespnerror").show();
                $("#fade").hide();
                $("#modal").hide();
                return false;
            }
            else {
                $("#txtstarttime").css('border-color', '#d6d6d6');
            }
            var ToTime = $("#txtendtime").val();
            if (ToTime == "" || ToTime == null || ToTime == undefined || ToTime == "End Time") {
                $("#Timespnerrorspan").text("Enter End Time");
                $("#txtendtime").css('border-color', '#f4633a');
                $("#Timespnerror").show();
                $("#fade").hide();
                $("#modal").hide();
                return false;
            }
            else {
                $("#txtendtime").css('border-color', '#d6d6d6');
            }
            var start = StartTime;
            var end = ToTime;
            var dtStart = new window.Date("1/1/2011 " + start);
            var dtEnd = new window.Date("1/1/2011 " + end);
            var difference_in_milliseconds = dtEnd - dtStart;
            if (difference_in_milliseconds <= 0) {
                $("#Timespnerrorspan").text("To Time should be greater than From Time");
                $("#txtstarttime").css('border-color', '#f4633a');
                $("#txtendtime").css('border-color', '#f4633a');
                $("#Timespnerrorspan").show();
                $("#fade").hide();
                $("#modal").hide();
                return false;
            }
            else {
                $("#txtstarttime").css('border-color', '#d6d6d6');
                $("#txtendtime").css('border-color', '#d6d6d6');
            }

            var currenttoday = new window.Date();
            var currentdate = ('0' + (currenttoday.getMonth() + 1)).slice(-2) + '/' + ('0' + currenttoday.getDate()).slice(-2) + '/' + currenttoday.getFullYear();
            var indexcurrentdate = Date.indexOf(currentdate);
            if (indexcurrentdate >= 0) {
                var now = new window.Date();
                var hh = now.getHours();
                var min = now.getMinutes();
                var ampm = (hh >= 12) ? 'PM' : 'AM';
                hh = hh % 12;
                hh = hh ? hh : 12;
                hh = hh < 10 ? '0' + hh : hh;
                min = min < 10 ? '0' + min : min;
                var time = hh + ":" + min + " " + ampm;
                var dtStart = new window.Date("1/1/2011 " + time);
                var dtEnd = new window.Date("1/1/2011 " + start);
                var difference_in_milliseconds = dtEnd - dtStart;
                if (difference_in_milliseconds <= 0) {
                    $("#Timespnerrorspan").text("Start time should not be past time.");
                    $("#txtstarttime").css('border-color', '#f4633a');
                    $("#Timespnerror").show();
                    $("#txtendtime").css('border-color', '#f4633a');
                    $("#fade").hide();
                    $("#modal").hide();
                    return false;
                }
                else {
                    $("#txtstarttime").css('border-color', '#d6d6d6');
                    $("#txtendtime").css('border-color', '#d6d6d6');
                }
            }

            var IsEquipmentcheck = $("#tdaequipment").text();
            var IsEquipment = "";
            var IsEquipmenttempID = "";
            if (IsEquipmentcheck == "Yes") {
                IsEquipment = "1";
                IsEquipmenttempID = $("#tdaequipment").attr("name");
            }
            else if (IsEquipmentcheck == "No") {
                IsEquipment = "0";
                IsEquipmenttempID = "0";
            }
            else {
                IsEquipment = "0";
            }

            var isDatacenterAccesscheck = document.getElementById("dataccess").text;
            var isDatacenterAccess = "";
            if (isDatacenterAccesscheck == "Update Datacenter Access Details") {
                isDatacenterAccess = "1";
            }
            else {
                isDatacenterAccess = "0";
            }
            if (LocationCount == undefined || LocationCount == "" || LocationCount == null) {
                LocationCount = 0;
            }
            var RequestID = document.getElementById("hdnRequestID").value;
            var VisitID = document.getElementById("hdnVisitDetailsID").value;
            var VistorID = document.getElementById("hdnvisitorID").value;
            $.ajax({
                type: "POST",
                url: "HomePage.aspx/UpdateRequestData",
                contentType: "application/json;charset=utf-8",
                data: '{"visitorType": "' + VisitorType + '","mobileNo":"' + MobileNo + '","name":"' + Name + '","organization":"' + Organization + '","locationName":"' + LocationName + '","hostId":"' + HostId + '","date":"' + Date + '","startTime":"' + StartTime + '","totime":"' + ToTime + '","isEquipment":"' + IsEquipment + '","visitorID":"' + VistorID + '","requestID":"' + RequestID + "~" + VisitID + '","isEquipmenttempID":"' + IsEquipmenttempID + '","others":"' + Others + '"}',
                dataType: "json",
                success: function (data) {

                    debugger;
                    if (data.d.indexOf("Validation failed") > -1) {
                        var message = data.d.split('|')[1];
                        $("#Timespnerrorspan").text(message);
                        $("#Timespnerror").show();
                        $("#txtstarttime").css('border-color', '#f4633a');
                        $("#fade").hide();
                        $("#modal").hide();
                        return false;
                    }
                    if (data.d == "fail") {
                        $("#spnerrorspan").text("* Error : Duplicate Entry. Request not submitted");
                        $("#spnerror").show();
                        $("#fade").hide();
                        $("#modal").hide();
                        var Cartmodal = document.getElementById('CardModel');
                        Cartmodal.style.display = "none";
                        var SucessModel = document.getElementById('SucessModel');
                        SucessModel.style.display = "none";
                        return false;
                    }
                    else {

                        document.getElementById('ddlpurpose').value = "0";

                        $("#txthostID").val("");
                        $("#txtvisitdate").datepicker('update', '');
                        $('#ddllocationlist').val("0");
                        $('#ddllocationlist').trigger('change');
                        $("#txtstarttime").val("09:00");
                        $("#txtendtime").val("18:00");
                        //document.getElementById("dataccess").checked = false;
                        $(".btnAddCart").css("pointer-events", "none");
                        $(".btnAddCart").css("background-color", "#d9d9d9");
                        $(".btnPreviewSubmit").text("Preview & Submit");
                        $(".btnPreviewSubmit").css("background-color", "#d9d9d9");
                        $(".btnPreviewSubmit").attr("disabled", "disabled");
                        $(".btnPreviewSubmit").attr("title", "Preview & Submit");
                        $("#spnerror").hide();
                        $("#tdtxtmobileno").css("border-color", "transparent");
                        $("#tdtxtcompany").css("border-color", "transparent");
                        $("#tdtxtvisitorName").css("border-color", "transparent");
                        $("#ddlpurpose").css("border", "1px solid #0033a0");
                        $("#txthostID").css("border-bottom", "1px solid #d6d6d6");
                        $("#txthostID").val("");
                        $("#ddlpurpose").removeAttr("disabled");
                        ////$.ajax({
                        ////    type: "POST",
                        ////    url: "HomePage.aspx/GetRecentVisitors",
                        ////    contentType: "application/json;charset=utf-8",
                        ////    data: "{'visitorCount':" + parseInt("10") + "}",
                        ////    dataType: "json",
                        ////    success: function (data) {
                        ////        var Recentdata = JSON.parse(data.d);
                        ////        var RecentData_append = "";
                        ////        if (Recentdata.length > 0) {
                        ////            for (var i = 0; i < Recentdata.length; i++) {
                        ////                if (i % 2 == 0) {
                        ////                    RecentData_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Recentdata[i].VisitorId + "'>";
                        ////                }
                        ////                else {
                        ////                    RecentData_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Recentdata[i].VisitorId + "'>";
                        ////                }
                        ////                RecentData_append += "<td style='width:44px;text-align:center;'>";
                        ////                RecentData_append += "<input type='checkbox' value='" + Recentdata[i].VisitorId + "' class='dataaccesscheckbox' id='tdchkselect" + Recentdata[i].VisitorId + "' onchange='UserSelectChange(" + Recentdata[i].VisitorId + ")'>";
                        ////                RecentData_append += "</td>";
                        ////                RecentData_append += "<td class='Recentvisitortabletd' style='width:168px;'>";
                        ////                RecentData_append += "<input type='text' id='tdtxtvisitorName" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].VisitorFullName + "' disabled />";
                        ////                RecentData_append += "</td>";
                        ////                RecentData_append += "<td class='Recentvisitortabletd' style='width:150px;'>";
                        ////                RecentData_append += "<input type='text' id='tdtxtcompany" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].Company + "' disabled />";
                        ////                RecentData_append += "</td>";
                        ////                RecentData_append += "<td class='Recentvisitortabletd' style='width:158px;'>";
                        ////                RecentData_append += "<select type='text' id='tdtxtvisitortype" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' disabled ><option>" + Recentdata[i].VisitorType + "</option></select>";
                        ////                RecentData_append += "</td>";
                        ////                RecentData_append += "<td class='Recentvisitortabletd' style='width:212px;'>";
                        ////                var Mobile = Recentdata[i].MobileNo.split('-');
                        ////                RecentData_append += "<select type='text' id='tdtxtCountryCode" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' style='width:40px;' disabled ><option>" + Mobile[0] + "</option></select>-<input id='tdtxtmobileno" + Recentdata[i].VisitorId + "' style='margin-left:2%;' class='Recentvisitortabletextbox' type='text' value='" + Mobile[1] + "' disabled />";
                        ////                RecentData_append += "</td>";
                        ////                RecentData_append += "<td class='Recentvisitortabletd' style='width:120px;'>";
                        ////                if (Recentdata[i].PermitITEquipments == true) {
                        ////                    RecentData_append += "<a id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#006583;cursor:pointer;' onclick='OpenEquipment(" + Recentdata[i].VisitorId + ",0)' name='0'>Yes</a>";
                        ////                }
                        ////                else {
                        ////                    RecentData_append += "<a id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#596679;cursor:pointer;' onclick='OpenEquipment(" + Recentdata[i].VisitorId + ",0)' name='0'>No</a>";
                        ////                }
                        ////                RecentData_append += "</td>";
                        ////                RecentData_append += "<td style='width:48px;'>";
                        ////                RecentData_append += "<img id='tdimgsave" + Recentdata[i].VisitorId + "' src='images/New%20Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;  background: url(images/New%20Images/VMS-Icons.png) no-repeat -37px -235px;' onclick='SaveTableRow(" + Recentdata[i].VisitorId + ")' />";
                        ////                RecentData_append += "<img id='tdimgcancel" + Recentdata[i].VisitorId + "' src='images/New%20Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;  background: url(images/New%20Images/VMS-Icons.png) no-repeat -288px -163px;' onclick='CancelTableRow(" + Recentdata[i].VisitorId + ")' />";
                        ////                RecentData_append += "<img id='tdimgedit" + Recentdata[i].VisitorId + "' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;' onclick='EditTableRow(" + Recentdata[i].VisitorId + ")' />";
                        ////                RecentData_append += "</td>";
                        ////                RecentData_append += "</tr >";
                        ////            }
                        ////            $("#RecentVisitortablebody").html(RecentData_append);
                        ////        }
                        ////        $("#fade").hide();
                        ////        $("#modal").hide();

                        ////    },
                        ////    error: function (result) {
                        ////        $("#fade").hide();
                        ////        $("#modal").hide();
                        ////    }
                        ////});
                        document.getElementById('UpdateSucessmessage').style.display = 'block';
                        $("#UpdateSucessmessagebody").html("Request has been updated successfully.");
                        //location.href = "NewTrack.aspx";
                        $("#AddMoreLocation").css("pointer-events", "visible");
                        //$("#AddMoreLocation").css("background-color", "#00b140");
                        $("#fade").hide();
                        $("#modal").hide();
                    }
                },
                error: function (result) {
                    $("#fade").hide();
                    $("#modal").hide();
                }
            });

        }
        else if (text == "Update Bulk Entries") {
            $("#fade").show();
            $("#modal").show();
            var Visitordrop = document.getElementById("ddlpurpose");
            var VisitorType = Visitordrop.options[Visitordrop.selectedIndex].text;
            if (VisitorType == "Select Visitor Type") {
                $("#visitorspnerror").show();
                $("#ddlpurpose").css('border-color', '#f4633a');
                $("#fade").hide();
                $("#modal").hide();
                return false;
            }
            else {
                $("#ddlpurpose").css('border-color', '#0033a0');
            }
            var Others = "";
            if (VisitorType == "Others") {
                Others = $("#txtothers").val();
                if (Others == "" || Others == null | Others == undefined) {
                    $("#Otherspnerror").show();
                    $("#txtothers").css('border-color', '#f4633a');
                    $("#fade").hide();
                    $("#modal").hide();
                    return false;
                }
                else {
                    $("#txtothers").css('border-color', '#d6d6d6');
                }
            }
            var HostId = "";
            //if (HostId == "" || HostId == null || HostId == undefined) {
            //    $("#lblerrormessage").text("Enter Host ID");
            //    $("#txthostID").css('border-color', '#f4633a');
            //    $("#fade").hide();
            //    $("#modal").hide();
            //    return false;
            //}
            var Date = $("#txtvisitdate").val();
            if (Date == "" || Date == null || Date == undefined) {
                $("#spnerror").text("select Date");
                $("#txtvisitdate").css('border-color', '#f4633a');
                $("#fade").hide();
                $("#modal").hide();
                return false;
            } else {
                $("#txtvisitdate").css('border-color', '#d6d6d6');
            }
            var StartTime = $("#txtstarttime").val();
            if (StartTime == "" || StartTime == null || StartTime == undefined || StartTime == "Start Time") {
                $("#datespnerror").show();
                $("#txtstarttime").css('border-color', '#f4633a');
                $("#fade").hide();
                $("#modal").hide();
                return false;
            }
            else {
                $("#txtstarttime").css('border-color', '#d6d6d6');
            }
            var ToTime = $("#txtendtime").val();
            if (ToTime == "" || ToTime == null || ToTime == undefined || ToTime == "End Time") {
                $("#Timespnerrorspan").text("select End Time");
                $("#Timespnerrorspan").show();
                $("#txtendtime").css('border-color', '#f4633a');
                $("#fade").hide();
                $("#modal").hide();
                return false;
            } else {
                $("#txtendtime").css('border-color', '#d6d6d6');
            }

            var start = StartTime;
            var end = ToTime;
            var dtStart = new window.Date("1/1/2011 " + start);
            var dtEnd = new window.Date("1/1/2011 " + end);
            var difference_in_milliseconds = dtEnd - dtStart;
            if (difference_in_milliseconds <= 0) {
                $("#Timespnerrorspan").text("To Time should be greater than From Time");
                $("#txtstarttime").css('border-color', '#f4633a');
                $("#Timespnerror").show();
                $("#txtendtime").css('border-color', '#f4633a');
                $("#fade").hide();
                $("#modal").hide();
                return false;
            } else {
                $("#txtstarttime").css('border-color', '#d6d6d6');
                $("#txtendtime").css('border-color', '#d6d6d6');
            }

            var currenttoday = new window.Date();
            var currentdate = ('0' + (currenttoday.getMonth() + 1)).slice(-2) + '/' + ('0' + currenttoday.getDate()).slice(-2) + '/' + currenttoday.getFullYear();
            var indexcurrentdate = Date.indexOf(currentdate);
            if (indexcurrentdate >= 0) {
                var now = new window.Date();
                var hh = now.getHours();
                var min = now.getMinutes();
                var ampm = (hh >= 12) ? 'PM' : 'AM';
                hh = hh % 12;
                hh = hh ? hh : 12;
                hh = hh < 10 ? '0' + hh : hh;
                min = min < 10 ? '0' + min : min;
                var time = hh + ":" + min + " " + ampm;
                var dtStart = new window.Date("1/1/2011 " + time);
                var dtEnd = new window.Date("1/1/2011 " + start);
                var difference_in_milliseconds = dtEnd - dtStart;
                if (difference_in_milliseconds <= 0) {
                    $("#Timespnerrorspan").text("Start time should not be past time.");
                    $("#txtstarttime").css('border-color', '#f4633a');
                    $("#Timespnerror").show();
                    $("#txtendtime").css('border-color', '#f4633a');
                    $("#fade").hide();
                    $("#modal").hide();
                    return false;
                }
                else {
                    $("#txtstarttime").css('border-color', '#d6d6d6');
                    $("#txtendtime").css('border-color', '#d6d6d6');
                }
            }

            var LocationNamedrop = document.getElementById("ddllocationlist");
            var LocationName = LocationNamedrop.options[LocationNamedrop.selectedIndex].text;
            if (LocationName == "Select Visiting Location") {
                $("#Locationspnerror").show();
                $(".select2-selection select2-selection--single").css('border-color', '#f4633a');
                $("#fade").hide();
                $("#modal").hide();
                return false;
            }
            else {
                $(".select2-selection select2-selection--single").css('border-color', '#d6d6d6');
            }
            var requesID = document.getElementById("hdnRequestID").value;
            var VisitorID = document.getElementById("hdnvisitorID").value;
            var visitID = document.getElementById("hdnVisitDetailsID").value;
            var fq = requesID + "~" + VisitorID + "~" + visitID;
            $.ajax({
                type: "POST",
                url: "HomePage.aspx/InsertBulkRecords",
                contentType: "application/json;charset=utf-8",
                data: '{"locationName": "' + LocationName + '","hostId":"' + HostId + '","date":"' + Date + '","startTime":"' + StartTime + '","totime":"' + ToTime + '","status":"' + fq + '","visitorType":"' + VisitorType + '","others":"' + Others + '"}',
                dataType: "json",
                success: function (data) {
                    //$.ajax({
                    //    type: "POST",
                    //    url: "HomePage.aspx/GetRecentVisitors",
                    //    contentType: "application/json;charset=utf-8",
                    //    data: "{'visitorCount':" + parseInt("10") + "}",
                    //    dataType: "json",
                    //    success: function (data) {
                    //        if (data.d == "" || data.d == null || data.d == undefined) {
                    //            $("#tblRecentvisitor thead tr td").css("border", "2px solid #dfe9f4");
                    //            $("#tblRecentvisitor tbody tr td").css("border", "none");
                    //            $("#RecentVisitortablebody").html("<tr style='height:395px;'><td></td><td></td><td></td><td style='width:189px;color:#596679;font:14px Arial-Regular;'>No Recent Visitors Found</td><td></td><td></td><td></td></tr>");
                    //            $("#fade").hide();
                    //            $("#modal").hide();
                    //        }
                    //        else {
                    //            var Recentdata = JSON.parse(data.d);
                    //            var RecentData_append = "";
                    //            if (Recentdata.length > 0) {
                    //                for (var i = 0; i < Recentdata.length; i++) {
                    //                    if (i % 2 == 0) {
                    //                        RecentData_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Recentdata[i].VisitorId + "'>";
                    //                    }
                    //                    else {
                    //                        RecentData_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Recentdata[i].VisitorId + "'>";
                    //                    }
                    //                    RecentData_append += "<td style='width:44px;text-align:center;'>";
                    //                    RecentData_append += "<input type='checkbox' value='" + Recentdata[i].VisitorId + "' class='dataaccesscheckbox' id='tdchkselect" + Recentdata[i].VisitorId + "' onchange='UserSelectChange(" + Recentdata[i].VisitorId + ")'>";
                    //                    RecentData_append += "</td>";
                    //                    RecentData_append += "<td class='Recentvisitortabletd' style='width:168px;'>";
                    //                    RecentData_append += "<input type='text' id='tdtxtvisitorName" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].VisitorFullName + "' disabled />";
                    //                    RecentData_append += "</td>";
                    //                    RecentData_append += "<td class='Recentvisitortabletd' style='width:215px;'>";
                    //                    var Mobile = Recentdata[i].MobileNo.split('-');
                    //                    RecentData_append += "<input type='text' id='tdtxtCountryCode" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' style='width:28px;' value='" + Mobile[0] + "' disabled />-<input id='tdtxtmobileno" + Recentdata[i].VisitorId + "' style='margin-left:2%;width:80px;' maxlength='10' onkeypress='return isNumberKey(event)' onfocusout='return isvalidmobile(" + Recentdata[i].VisitorId + ")' class='Recentvisitortabletextbox' type='text' value='" + Mobile[1] + "' disabled />";
                    //                    RecentData_append += "</td>";
                    //                    RecentData_append += "<td class='Recentvisitortabletd' style='width:150px;'>";
                    //                    RecentData_append += "<input type='text' id='tdtxtcompany" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].Company + "' disabled />";
                    //                    RecentData_append += "</td>";
                    //                    RecentData_append += "<td class='Recentvisitortabletd' style='width:158px;'>";
                    //                    RecentData_append += "<select type='text' id='tdtxtvisitortype" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' disabled ><option>" + Recentdata[i].VisitorType + "</option></select>";
                    //                    RecentData_append += "</td>";

                    //                    RecentData_append += "<td class='Recentvisitortabletd' style='width:120px;'>";
                    //                    if (Recentdata[i].PermitITEquipments == true) {
                    //                        RecentData_append += "<a title='Please click here to add equipment details' id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#00b140;cursor:pointer;text-decoration:underline;' onclick='OpenEquipment(" + Recentdata[i].VisitorId + ",0)' name='" + Recentdata[i].VisitorId + "'>Yes</a>";
                    //                    }
                    //                    else {
                    //                        RecentData_append += "<a title='Please click here to add equipment details' id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#596679;cursor:pointer;' name='0'>No</a>";
                    //                    }
                    //                    RecentData_append += "</td>";
                    //                    RecentData_append += "<td style='width:48px;text-align:center;'>";
                    //                    RecentData_append += "<img id='tdimgsave" + Recentdata[i].VisitorId + "' title='Save' src='images/New%20Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;  background: url(images/New%20Images/VMS-Icons.png) no-repeat -37px -235px;' onclick='SaveTableRow(" + Recentdata[i].VisitorId + ")' />";
                    //                    RecentData_append += "<img id='tdimgcancel" + Recentdata[i].VisitorId + "' title='Cancel' src='images/New%20Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;  background: url(images/New%20Images/VMS-Icons.png) no-repeat -288px -163px;' onclick='CancelTableRow(" + Recentdata[i].VisitorId + ")' />";
                    //                    RecentData_append += "<img id='tdimgedit" + Recentdata[i].VisitorId + "' title='Edit' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;' onclick='EditTableRow(" + Recentdata[i].VisitorId + ")' />";
                    //                    RecentData_append += "</td>";
                    //                    RecentData_append += "</tr >";
                    //                }
                    //                $("#RecentVisitortablebody").html(RecentData_append);
                    //                $('.divRecentvisitor').slimScroll({
                    //                    height: '432px',
                    //                    width: '100%'
                    //                });
                    //            }
                    //            $(".btnPreviewSubmit").text("Preview & Submit");
                    //            $(".btnPreviewSubmit").css("background-color", "#d9d9d9");
                    //            $(".btnPreviewSubmit").attr("disabled", "disabled");
                    //            $(".btnPreviewSubmit").attr("title", "Preview & Submit");
                    //            $("#fade").hide();
                    //            $("#modal").hide();
                    //            document.getElementById("ddlpurpose").value = "0";
                    //            $('#ddllocationlist').val("0");
                    //            $('#ddllocationlist').trigger('change');
                    //            $('#sandbox-container input').datepicker('update', '');
                    //            $("#txtstarttime").val("09:00");
                    //            $("#txtendtime").val("18:00");
                    //            $("#txthostID").val("");
                    //            $("#AddMoreLocation").html("<img src='images/New%20Images/img_trans.gif' class='AddmoreDivimg' /> Add More Location");
                    //            $("#AddMoreLocation").attr("onclick", "AddExtraLocation(0)");
                    //            $("#AddMoreLocation").css("margin-left", "127px");
                    //        }
                    //    },
                    //    error: function (result) {
                    //        $("#fade").hide();
                    //        $("#modal").hide();
                    //    }
                    //});
                    location.href = "NewTrack.aspx";
                },
                error: function (result) {
                    $("#fade").hide();
                    $("#modal").hide();
                }
            });
        }

    });
    $(".CartImg").click(function () {
        var tbody = $("#tbodycart");
        if (tbody.children().length != 0) {
            Cartmodal.style.display = "block";
        }
        //$("#btnSearch").text("Search");
        $("#txtSerachbox").val("");
    });
    $(".close").click(function () {
        Cartmodal.style.display = "none";
        var SucessModel = document.getElementById('SucessModel');
        SucessModel.style.display = "none";
        BulkModel.style.display = "none";
        var Visitordrop = document.getElementById("ddlpurpose");
        var VisitorType = Visitordrop.options[Visitordrop.selectedIndex].text;
        document.getElementById("BulkUploadframe").src = "BulkUpload.aspx?purposeText=" + VisitorType + "";
    });
    $("#btnNodelete").click(function () {
        $("#btnYesdelete").removeAttr("onclick");
    });
    window.onclick = function (event) {
        if (event.target == modal) {
            modal.style.display = "none";
            Cartmodal.style.display = "none";
            BulkModel.style.display = "none";
            document.getElementById("tdchkeuipment").checked = false;
        }
    }
    var RequestID = document.getElementById("hdnRequestID").value;
    var VisitDetailsID = document.getElementById("hdnVisitDetailsID").value;
    var VisitorID = document.getElementById("hdnvisitorID").value;
    if (RequestID == "" || RequestID == null || RequestID == undefined) {
        $.ajax({
            type: "POST",
            url: "HomePage.aspx/GetRecentVisitors",
            contentType: "application/json;charset=utf-8",
            data: "{'visitorCount':" + parseInt("9") + "}",
            dataType: "json",
            success: function (data) {
                var RecentData_append = "";
                if (data.d == "" || data.d == null || data.d == undefined) {
                    $("#RecentVisitortablebody").html("<tr style='height:395px;'><td></td><td></td><td></td><td style='width:210px;color:#596679;font:14px Arial-Regular;'>No Recent Visitors Found</td><td></td><td></td><td></td></tr>");
                    $("#tblRecentvisitor tbody td").css("border", "none");
                    $("#tblRecentvisitor thead td").css("border", "2px solid #dfe9f4");
                    $("#fade").hide();
                    $("#modal").hide();
                }
                else {
                    var Recentdata = JSON.parse(data.d);
                    if (Recentdata.length > 0) {
                        for (var i = 0; i < Recentdata.length; i++) {
                            if (i % 2 == 0) {
                                RecentData_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Recentdata[i].VisitorId + "'>";
                            }
                            else {
                                RecentData_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Recentdata[i].VisitorId + "'>";
                            }
                            RecentData_append += "<td style='width:44px;text-align:center;'>";
                            RecentData_append += "<input type='checkbox' value='" + Recentdata[i].VisitorId + "' class='dataaccesscheckbox' id='tdchkselect" + Recentdata[i].VisitorId + "' onchange='UserSelectChange(" + Recentdata[i].VisitorId + ")'>";
                            RecentData_append += "</td>";
                            RecentData_append += "<td class='Recentvisitortabletd' style='width:181px;'>";
                            RecentData_append += "<input type='text' maxlength='25' id='tdtxtvisitorName" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].VisitorFullName + "' disabled />";
                            RecentData_append += "</td>";
                            RecentData_append += "<td class='Recentvisitortabletd' style='width:215px;'>";
                            var Mobile = Recentdata[i].MobileNo.split('-');
                            RecentData_append += "<select type='text' id='tdtxtCountryCode" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' style='width:28px;' disabled ><option>" + Mobile[0] + "</option></select>-<input id='tdtxtmobileno" + Recentdata[i].VisitorId + "' style='margin-left:0%;width:73px;' maxlength='10' class='Recentvisitortabletextbox' onkeypress='return isNumberKey(event)' onfocusout='return isvalidmobile(" + Recentdata[i].VisitorId + ")'  type='text' value='" + Mobile[1] + "' disabled />";
                            RecentData_append += "</td>";
                            RecentData_append += "<td class='Recentvisitortabletd' style='width:171px;'>";
                            RecentData_append += "<input type='text' maxlength='25' id='tdtxtcompany" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].Company + "' disabled />";
                            RecentData_append += "</td>";
                            RecentData_append += "<td class='Recentvisitortabletd' style='width:159px;'>";
                            RecentData_append += "<select type='text' id='tdtxtvisitortype" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' disabled ><option>" + Recentdata[i].VisitorType + "</option></select>";
                            RecentData_append += "</td>";

                            RecentData_append += "<td class='Recentvisitortabletd' style='width:112px;'>";
                            if (Recentdata[i].PermitITEquipments == true) {
                                RecentData_append += "<a title='Please click here to add equipment details' id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#00b140;cursor:pointer;text-decoration:underline;' onclick='OpenEquipment(" + Recentdata[i].VisitorId + ",0)' name='" + Recentdata[i].VisitorId + "'>Yes</a>";
                            }
                            else {
                                RecentData_append += "<a title='Please click here to add equipment details' id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#596679;cursor:pointer;' name='0'>No</a>";
                            }
                            RecentData_append += "</td>";
                            RecentData_append += "<td style='width:56px;text-align:center;'>";
                            RecentData_append += "<img id='tdimgsave" + Recentdata[i].VisitorId + "' title='Save' src='images/New%20Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;  background: url(images/New%20Images/VMS-Icons.png) no-repeat -37px -235px;' onclick='SaveTableRow(" + Recentdata[i].VisitorId + ")' />";
                            RecentData_append += "<img id='tdimgcancel" + Recentdata[i].VisitorId + "' title='Cancel' src='images/New%20Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;  background: url(images/New%20Images/VMS-Icons.png) no-repeat -288px -163px;' onclick='CancelTableRow(" + Recentdata[i].VisitorId + ")' />";
                            RecentData_append += "<img id='tdimgedit" + Recentdata[i].VisitorId + "' title='Edit' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;' onclick='EditTableRow(" + Recentdata[i].VisitorId + ")' />";
                            RecentData_append += "</td>";
                            RecentData_append += "</tr >";
                        }
                        $("#RecentVisitortablebody").html(RecentData_append);

                        $('.divRecentvisitor').slimScroll({
                            height: '432px',
                            width: '100%'
                        });
                    }
                    else {
                        $("#fade").hide();
                        $("#modal").hide();
                    }

                }

            },
            error: function (result) {
                $("#fade").hide();
                $("#modal").hide();
            }
        });

        $.ajax({
            type: "POST",
            url: "HomePage.aspx/GetVisitorCart",
            contentType: "application/json;charset=utf-8",
            data: '{}',
            dataType: "json",
            async: true,
            success: function (data) {
                var Cart = JSON.parse(data.d);
                var Cart_append = "";
                if (Cart.length > 0) {
                    $(".btnPreviewSubmit").css("background-color", "#00b140");
                    $(".btnPreviewSubmit").removeAttr("disabled");
                    $("#spncartcount").css("color", "#d9d9d9");
                    $(".CartImg").css("background", "url('.../../images/New Images/VMS-Icons.png') no-repeat -192px -289px");
                }
                for (var i = 0; i < Cart.length; i++) {
                    $("#spncartcount").text("(" + (i + 1) + ")");
                    $("#spncartcount1").text((i + 1));
                    $("#spncartcount").css("color", "#00b140");
                    $(".CartImg").css("background", "url('.../../images/New Images/VMS-Icons.png') no-repeat -192px -228px");
                    if (parseInt(Cart[i].Ismultilocation) == 0) {
                        if (i % 2 == 0) {
                            Cart_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Cart[i].CartID + "'>";
                        }
                        else {
                            Cart_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Cart[i].CartID + "'>";
                        }
                        Cart_append += "<td class='Recentvisitortabletd' style='color:#0033a0;font:14px Arial-Bold;padding-left:15px;' title=\"" + Cart[i].VisitorName + "\">";
                        if (parseInt(Cart[i].isDatacenterAccess) == 0) {
                            Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "";
                        }
                        else {
                            Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "<img src='images/New%20Images/img_trans.gif' style='background:url(images/New%20Images/VMS-Icons.png) no-repeat -452px -232px;height:21px;margin-left:4px;margin-top:3%;' />";
                        }
                        Cart_append += "</td>";
                        Cart_append += "<td class='Recentvisitortabletd' title=\"" + Cart[i].LocationName + "\">";
                        Cart_append += "" + Cart[i].LocationName.slice(0, parseInt(15)) + (Cart[i].LocationName.length > parseInt(15) ? "..." : "") + "";
                        Cart_append += "</td>";
                        Cart_append += "<td class='Recentvisitortabletd' style='width:18%;' title='" + Cart[i].HostID + "'>";
                        Cart_append += "" + Cart[i].HostID.slice(0, parseInt(15)) + (Cart[i].HostID.length > parseInt(15) ? "..." : "") + "";
                        Cart_append += "</td>";
                        Cart_append += "<td  class='Recentvisitortabletd' style='width:37%;' title=" + Cart[i].Date + ">";
                        var Splitdate = Cart[i].Date.split(',');
                        if (Splitdate.length == 1) {
                            ConcaSpt = Splitdate;
                        }
                        else {
                            var ConcaSpt = "";
                            for (var w = 0; w < Splitdate.length; w++) {
                                var splitsingledata = Splitdate[w].split('/');
                                ConcaSpt += splitsingledata[0] + "/" + splitsingledata[1] + ",";
                            }
                            ConcaSpt = ConcaSpt.slice(0, -1);
                        }

                        // var spltfrom = Splitdate[0];
                        //var spltto = Splitdate[Splitdate.length - 1];

                        //if (spltfrom == spltto) {
                        //  ConcaSpt = Splitdate;
                        //}
                        //else {
                        //  ConcaSpt = spltfrom + " to " + spltto;
                        // }

                        Cart_append += "" + ConcaSpt.slice(0, parseInt(20)) + (ConcaSpt.length > parseInt(20) ? "..." : "") + " " + "-" + " " + Cart[i].FromTime + " " + "to" + " " + Cart[i].ToTime + "<br/>";
                        //}
                        Cart_append += "</td>";
                        Cart_append += "<td style='text-align:center;'>";
                        Cart_append += "<img class='editimage' id='tdimgedit" + Cart[i].CartID + "' title='Edit' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;' onclick='EditCart(" + Cart[i].CartID + ")' />";
                        Cart_append += "<img class='cancelimage' id='tdimgcancel" + Cart[i].CartID + "' title='Delete' src='images/New Images/img_trans.gif' style='height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -203px -94px;margin-left:4%;cursor:pointer;' onclick='DeleteCart(" + Cart[i].CartID + ")' />";
                        Cart_append += "</td>";
                        Cart_append += "</tr >";
                    }
                    else {
                        if (i % 2 == 0) {
                            Cart_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Cart[i].CartID + "'>";
                        }
                        else {
                            Cart_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Cart[i].CartID + "'>";
                        }
                        Cart_append += "<td class='Recentvisitortabletd' style='color:#0033a0;font:14px Arial-Bold;padding-left:15px;' title=\"" + Cart[i].VisitorName + "\">";
                        if (parseInt(Cart[i].isDatacenterAccess) == 0) {
                            Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "";
                        }
                        else {
                            Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "<img src='images/New%20Images/img_trans.gif' style='background:url(images/New%20Images/VMS-Icons.png) no-repeat -452px -232px;height:21px;margin-left:4px;margin-top:3%;' />";
                        }
                        Cart_append += "</td>";
                        Cart_append += "<td class='Recentvisitortabletd' title=\"" + Cart[i].LocationName + "\">";
                        Cart_append += "" + Cart[i].LocationName.slice(0, parseInt(15)) + (Cart[i].LocationName.length > parseInt(15) ? "..." : "") + "";
                        Cart_append += "</td>";
                        Cart_append += "<td class='Recentvisitortabletd' style='width:18%;' title='" + Cart[i].HostID + "'>";
                        Cart_append += "" + Cart[i].HostID.slice(0, parseInt(15)) + (Cart[i].HostID.length > parseInt(15) ? "..." : "" + "") + "";
                        Cart_append += "</td>";
                        Cart_append += "<td  class='Recentvisitortabletd' style='width:37%;' title=" + Cart[i].Date + ">";
                        var Splitdate = Cart[i].Date.split(',');
                        if (Splitdate.length == 1) {
                            ConcaSpt = Splitdate;
                        }
                        else {
                            var ConcaSpt = "";
                            for (var w = 0; w < Splitdate.length; w++) {
                                var splitsingledata = Splitdate[w].split('/');
                                ConcaSpt += splitsingledata[0] + "/" + splitsingledata[1] + ",";
                            }
                            ConcaSpt = ConcaSpt.slice(0, -1);
                        }

                        // var spltfrom = Splitdate[0];
                        //var spltto = Splitdate[Splitdate.length - 1];

                        //if (spltfrom == spltto) {
                        //  ConcaSpt = Splitdate;
                        //}
                        //else {
                        //  ConcaSpt = spltfrom + " to " + spltto;
                        // }

                        Cart_append += "" + ConcaSpt.slice(0, parseInt(20)) + (ConcaSpt.length > parseInt(20) ? "..." : "") + " " + "-" + " " + Cart[i].FromTime + " " + "to" + " " + Cart[i].ToTime + "<br/>";
                        //}
                        Cart_append += "</td>";
                        Cart_append += "<td style='text-align:center;'>";
                        Cart_append += "<img class='editimage' id='tdimgmultiple" + Cart[i].CartID + "' title='Expand' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -118px -95px;cursor:pointer;margin-left:-21px;' onclick='OpenMultiple(" + Cart[i].CartID + ")' />";
                        Cart_append += "<img class='editimage' id='tdimgedit" + Cart[i].CartID + "' title='Edit' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;margin-left:3%;' onclick='EditCart(" + Cart[i].CartID + ")' />";
                        Cart_append += "<img class='cancelimage' id='tdimgcancel" + Cart[i].CartID + "' title='Delete' src='images/New Images/img_trans.gif' style='height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -203px -94px;margin-left:4%;cursor:pointer;' onclick='DeleteCart(" + Cart[i].CartID + ")' />";
                        Cart_append += "</td>";
                        Cart_append += "</tr>";
                        for (var m = 0; m < Cart[i].LocationCount; m++) {
                            Cart_append += "<tr class='Recentvisitortablebodytrodd' style='display:none;' id='" + m + "Multipletr" + Cart[i].CartID + "'>";
                            Cart_append += "</tr>";
                        }
                    }
                }
                $("#tbodycart").html(Cart_append);
                $("#tbodycart1").html(Cart_append);
                $("#fade").hide();
                $("#modal").hide();
            },
            error: function (result) {
                $("#fade").hide();
                $("#modal").hide();
            }
        });
    }
    if (RequestID != "") {
        //document.getElementById("hdnVisitorIDforDC").value = document.getElementById("hdnvisitorID").value;
        $("#fade").show();
        $("#modal").show();
        $.ajax({
            type: "POST",
            url: "HomePage.aspx/PopulateVisitorDetails",
            contentType: "application/json;charset=utf-8",
            data: '{"vistorDetailsID":"' + VisitDetailsID + '","visitorID":"' + VisitorID + '"}',
            dataType: "json",
            async: false,
            success: function (data) {
                $("#ddlpurpose").attr("disabled", "disabled");
                $("#ddlpurpose").css('background-color', '#d6d6d6');
                $(".txtserachbox").attr("disabled", "disabled");
                $(".txtserachbox").css('background-color', '#d9d9d9');
                $(".btnserach").attr("disabled", "disabled");
                $(".btnserach").css('background-color', '#d9d9d9');
                $(".btnserach").css('pointer-events', 'none');
                $(".divRecentvisitor").css("margin-top", "21px");
                $(".footerContainer").css("margin-top", "-23px");
                var Populate = JSON.parse(data.d);
                if (parseInt(Populate["0"].BULK) == 1) {
                    document.getElementById("ddlpurpose").value = Populate["0"].VISTORTYPE;
                    $("#ddlpurpose").attr("disabled", "disabled");
                    var Datespilt = Populate["0"].DATE.split(',');
                    for (var j = 0; j < Datespilt.length; j++) {
                        $('#sandbox-container input').datepicker('update', Datespilt[j]);
                    }

                    $('#sandbox-container input').datepicker({
                        clearBtn: true
                    });
                    var from = Populate["0"].STARTTIME;
                    var to = Populate["0"].ENDTIME;

                    $("#txtstarttime").val(from);
                    $("#txtendtime").val(to);
                    $("#txthostID").val(Populate["0"].HOSTID);
                    if (Populate["0"].VISTORTYPE == "Client") {
                        $("#txthostID").show();
                        $("#divhostID").show();
                    }
                    else if (Populate["0"].VISTORTYPE == "Others") {
                        $("#txtothers").show();
                        $("#txtothers").val(Populate["0"].OTHERS);
                        $("#divtxtothers").show();
                    }
                    if (Populate["0"].DATAACCESS == true) {
                        $("#Dataccessdiv0").show();
                        $("#dataccess").text("Update Datacenter Access Details");
                        $("#dataccess").attr("onclick", "OpenDatacenterUpdateform()");
                    }

                    $('#ddllocationlist').val(Populate["0"].LOCATION);
                    $('#ddllocationlist').trigger('change');
                    var RecentData_append = "";
                    RecentData_append += "<tr style='height:45px;'><td></td><td></td><td></td><td style='width:200px;font:14px Arial-Regular;color:#596679;'>" + Populate["0"].Entries + " " + "record(s) is/are available" + "</td><td></td><td></td><td>";
                    RecentData_append += "<img src= 'images/New%20Images/img_trans.gif' title='Cancel this Request' style= 'height:20px;width:20px;cursor:pointer; background: url(images/New%20Images/VMS-Icons.png) -203px -94px no-repeat;' onclick='DeleteData(" + document.getElementById("hdnVisitDetailsID").value + "," + Populate["0"].REQUESTID + ")' />";
                    RecentData_append += "<img src='images/New%20Images/img_trans.gif' title='Go Back' style='height:20px;width:20px;cursor:pointer;  background: url(images/New%20Images/VMS-Icons.png) no-repeat -288px -163px;'  onclick='backtrack()' />";
                    RecentData_append += "</td></tr> ";
                    $("#RecentVisitortablebody").html(RecentData_append);
                    $(".btnPreviewSubmit").text("Update Bulk Entries");
                    $(".btnPreviewSubmit").attr("title", "Update Bulk Entries");
                    $("#AddMoreLocation").html("<img src='images/New%20Images/img_trans.gif' class='AddmoreDivimg' /> Bulk Upload");
                    $("#AddMoreLocation").css("margin-left", "178px");
                    $("#AddMoreLocation").attr("onclick", "BulkUpload()");
                    document.getElementById('BulkUploadframe').src = "BulkUpload.aspx?purposeText=" + Populate["0"].VISTORTYPE + "";
                    $("#AddMoreLocation").attr("disabled", "disabled");
                    $(".btnAddCart").text("Back");
                    $(".btnAddCart").attr("title", "Back");
                }
                else {
                    $.ajax({
                        type: "POST",
                        url: "HomePage.aspx/GetVistorType",
                        contentType: "application/json;charset=utf-8",
                        data: "{}",
                        dataType: "json",
                        async: false,
                        success: function (data) {
                            var PurposeData = JSON.parse(data.d);
                            for (var k = 0; k < Populate.length; k++) {
                                RecentData_append += "<tr class='Recentvisitortablebodytrodd'>";
                                RecentData_append += "<td style='width:44px;text-align:center;'>";
                                RecentData_append += "<input type='checkbox' class='dataaccesscheckbox' id='tdchkselect' checked>";
                                RecentData_append += "</td>";
                                RecentData_append += "<td class='Recentvisitortabletd' style='width:168px;'>";
                                RecentData_append += "<input type='text' maxlength='25' id='tdtxtvisitorName' class='Recentvisitortableaftertextbox' Value='" + Populate["0"].VISITORNAME + "' placeholder='Visitor Name' />";
                                RecentData_append += "</td>";
                                RecentData_append += "<td class='Recentvisitortabletd' style='width:223px;'>";
                                RecentData_append += "<select id='tdtxtCountryCode' class='Recentvisitortableaftertextbox' style='width:55px;'><option></option></select>-<input id='tdtxtmobileno' style='margin-left:0%;width:90px;' class='Recentvisitortableaftertextbox' maxlength='10' onkeypress='return isNumberKey(event)' onfocusout='return isvalidmobile(-1)' type='text' placeholder='Mobile No' />";
                                RecentData_append += "</td>";
                                RecentData_append += "<td class='Recentvisitortabletd' style='width:158px;'>";
                                if (Populate["0"].VISTORTYPE == "Others") {
                                    RecentData_append += "<input type='text' maxlength='25' id='tdtxtcompany' class='Recentvisitortableaftertextbox' Value='" + Populate["0"].OTHERS + "'  placeholder='Organization' disabled />";
                                }
                                else {
                                    RecentData_append += "<input type='text' maxlength='25' id='tdtxtcompany' class='Recentvisitortableaftertextbox' Value='" + Populate["0"].ORGANIZATION + "'  placeholder='Organization' />";
                                }
                                RecentData_append += "</td>";
                                RecentData_append += "<td class='Recentvisitortabletd' style='width:150px;'>";
                                RecentData_append += "<select id='tdtxtvisitortype' class='Recentvisitortableaftertextbox' disabled>";
                                RecentData_append += "<option>Visitor Type</option>";
                                for (var i = 0; i < PurposeData.length; i++) {
                                    if (PurposeData[i] != "Guests" && PurposeData[i] != "Former Employee" && PurposeData[i] != "Associate Driver" && PurposeData[i] != "Auditors" && PurposeData[i] != "New Joinee" && PurposeData[i] != "Business Partner" && PurposeData[i] != "Select Purpose") {
                                        RecentData_append += "<option>" + PurposeData[i] + "</option>";
                                    }
                                }
                                RecentData_append += "</select>";
                                RecentData_append += "</td>";

                                RecentData_append += "<td class='Recentvisitortabletd' style='width:120px;'>";
                                if (Populate[k].EQUIPMENT == true) {
                                    RecentData_append += "<a title='Please click here to add equipment details' id='tdaequipment' href='#' style='color:#00b140;cursor:pointer;text-decoration:underline;' onclick='OpenEquipment(" + Populate["0"].VISITORID + ",1)' name='" + Populate["0"].VISITORID + "'>Yes</a>";
                                }
                                else {
                                    if (Populate["0"].VISTORTYPE == "Client") {
                                        RecentData_append += "<a title='Please click here to add equipment details' id='tdaequipment' href='#' style='color:rgb(0, 114, 143);cursor:pointer;text-decoration:underline;' onclick='OpenEquipment(" + Populate["0"].VISITORID + ",1)' name='" + Populate["0"].VISITORID + "'>No</a>";
                                    }
                                    else {
                                        RecentData_append += "<a title='Please click here to add equipment details' id='tdaequipment' href='#' style='color:rgb(0, 114, 143);cursor:pointer;text-decoration:underline;' onclick='OpenEquipment(" + Populate["0"].VISITORID + ",1)' name='0'>No</a>";
                                    }
                                }

                                RecentData_append += "</td>";
                                RecentData_append += "<td style='width:48px;text-align:center;'>";
                                ////RecentData_append += "<img id='tdimgsave' src='images/New%20Images/img_trans.gif' title='Save this Data' style='height:20px;width:20px;cursor:pointer; background: url(images/New%20Images/VMS-Icons.png) no-repeat -37px -235px;' onclick='UpdateData(" + Populate["0"].VISITORID + "," + Populate["0"].REQUESTID + ")' />";
                                RecentData_append += "<img id='tdimgcancel' title='Cancel this request' src='images/New%20Images/img_trans.gif' style='height:20px;width:20px;cursor:pointer; background: url(images/New%20Images/VMS-Icons.png) -203px -94px no-repeat;' onclick='DeleteData(" + document.getElementById("hdnVisitDetailsID").value + "," + Populate["0"].REQUESTID + ")' />";
                                RecentData_append += "</td>";
                                RecentData_append += "</tr >";

                                $("#RecentVisitortablebody").html(RecentData_append);
                                $.ajax({
                                    type: "POST",
                                    url: "HomePage.aspx/GetCountryCode",
                                    contentType: "application/json;charset=utf-8",
                                    data: "{}",
                                    async: false,
                                    dataType: "json",
                                    success: function (data) {
                                        var Locationdata = JSON.parse(data.d);
                                        var RecentData_append = "";
                                        for (var i = 0; i < Locationdata.length; i++) {
                                            RecentData_append += "<option value=" + Locationdata[i].Country + ">+" + Locationdata[i].Code + "</option>";
                                        }
                                        $("#tdtxtCountryCode").html(RecentData_append);
                                        $('#tdtxtCountryCode').select2({
                                            matcher: function (params, data) {
                                                if ($.trim(params.term) === '') { return data; }
                                                if (typeof data.text === 'undefined') { return null; }
                                                var q = params.term.toLowerCase();
                                                if (data.text.toLowerCase().indexOf(q) > -1 || data.id.toLowerCase().indexOf(q) > -1) {
                                                    return $.extend({}, data, true);
                                                }
                                                return null;
                                            }
                                        });




                                        $("#tdtxtvisitortype").val(Populate["0"].VISTORTYPE);
                                        if (Populate["0"].VISTORTYPE == "Others") {
                                            $("#txtothers").show();
                                            $("#divtxtothers").show();
                                            $("#txtothers").val(Populate["0"].OTHERS);
                                        }
                                        else {
                                            $("#txtothers").hide();
                                            $("#divtxtothers").hide();
                                        }
                                        var Mob = Populate["0"].MOBILENUMBER.split('-');

                                        //$('#tdtxtCountryCode').val('India');
                                        $('#tdtxtCountryCode option').map(function () {
                                            if ($(this).text() == Mob[0]) return this;
                                        }).attr('selected', 'selected');
                                        $('#tdtxtCountryCode').trigger('change');
                                        $("#tdtxtmobileno").val(Mob[1]);
                                        $("#ddlpurpose").val(Populate["0"].VISTORTYPE);
                                        var Datespilt = Populate["0"].DATE.split(' ');
                                        $("#txtvisitdate").datepicker("update", Datespilt[0]);
                                        var from = Populate["0"].STARTTIME;
                                        var to = Populate["0"].ENDTIME;

                                        $("#txtstarttime").val(from);
                                        $("#txtendtime").val(to);
                                        document.getElementById("hdnMHostID").value = Populate["0"].HOSTID;
                                        $("#txthostID").val(document.getElementById("hdnMHostID").value);
                                        $('#ddllocationlist').val(Populate["0"].LOCATION);
                                        $('#ddllocationlist').trigger('change');

                                        //if (Populate["0"].EQUIPMENT == false) {
                                        //    document.getElementById("tdchkeuipment").checked = false;
                                        //}
                                        //else {
                                        //    document.getElementById("tdchkeuipment").checked = true;
                                        //}

                                        $(".btnPreviewSubmit").text("Update");
                                        $(".btnPreviewSubmit").attr("title", "Update");
                                        $(".btnAddCart").text("Back");
                                        $(".btnAddCart").attr("title", "Back");
                                    },
                                    error: function (result) {
                                        $("#fade").hide();
                                        $("#modal").hide();
                                    }
                                });
                            }
                        },
                        error: function (result) {
                            $("#fade").hide();
                            $("#modal").hide();
                        }
                    });
                }
            },
            error: function (result) {
                $("#fade").hide();
                $("#modal").hide();
            }
        });
        $(".btnPreviewSubmit").css("background-color", "#00b140");
        $(".btnPreviewSubmit").removeAttr("disabled");
        $(".btnAddCart").css("background-color", "#00b140");
        $(".btnAddCart").removeAttr("disabled");
        $(".btnAddCart").css("pointer-events", "visible");
        $(".btnAddCart").css("text-align", "center");
        $("#AddMoreLocation").attr("disabled", "disabled");
        $("#AddMoreLocation").css("pointer-events", "none");
        $("#AddMoreLocation").css("color", "#d9d9d9");
        $(".AddmoreDivimg").css("background", "url('.../../images/New Images/VMS-Icons.png') no-repeat -458px -172px");
        $("#fade").hide();
        $("#modal").hide();
        $.ajax({
            type: "POST",
            url: "HomePage.aspx/GetVisitorCart",
            contentType: "application/json;charset=utf-8",
            data: '{}',
            dataType: "json",
            async: true,
            success: function (data) {
                var Cart = JSON.parse(data.d);
                var Cart_append = "";
                if (Cart.length > 0) {
                    $(".btnPreviewSubmit").css("background-color", "#00b140");
                    $(".btnPreviewSubmit").removeAttr("disabled");
                    $("#spncartcount").css("color", "#d9d9d9");
                    $(".CartImg").css("background", "url('.../../images/New Images/VMS-Icons.png') no-repeat -192px -289px");
                }
                for (var i = 0; i < Cart.length; i++) {
                    $("#spncartcount").text("(" + (i + 1) + ")");
                    $("#spncartcount1").text((i + 1));
                    $("#spncartcount").css("color", "#00b140");
                    $(".CartImg").css("background", "url('.../../images/New Images/VMS-Icons.png') no-repeat -192px -228px");
                    if (parseInt(Cart[i].Ismultilocation) == 0) {
                        if (i % 2 == 0) {
                            Cart_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Cart[i].CartID + "'>";
                        }
                        else {
                            Cart_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Cart[i].CartID + "'>";
                        }
                        Cart_append += "<td class='Recentvisitortabletd' style='color:#0033a0;font:14px Arial-Bold;padding-left:15px;' title=\"" + Cart[i].VisitorName + "\">";
                        if (parseInt(Cart[i].isDatacenterAccess) == 0) {
                            Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "";
                        }
                        else {
                            Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "<img src='images/New%20Images/img_trans.gif' style='background:url(images/New%20Images/VMS-Icons.png) no-repeat -452px -232px;height:21px;margin-left:4px;margin-top:3%;' />";
                        }
                        Cart_append += "</td>";
                        Cart_append += "<td class='Recentvisitortabletd' title=\"" + Cart[i].LocationName + "\">";
                        Cart_append += "" + Cart[i].LocationName.slice(0, parseInt(15)) + (Cart[i].LocationName.length > parseInt(15) ? "..." : "") + "";
                        Cart_append += "</td>";
                        Cart_append += "<td class='Recentvisitortabletd' style='width:18%;' title='" + Cart[i].HostID + "'>";
                        Cart_append += "" + Cart[i].HostID.slice(0, parseInt(15)) + (Cart[i].HostID.length > parseInt(15) ? "..." : "") + "";
                        Cart_append += "</td>";
                        Cart_append += "<td  class='Recentvisitortabletd' style='width:37%;' title=" + Cart[i].Date + ">";
                        var Splitdate = Cart[i].Date.split(',');
                        if (Splitdate.length == 1) {
                            ConcaSpt = Splitdate;
                        }
                        else {
                            var ConcaSpt = "";
                            for (var w = 0; w < Splitdate.length; w++) {
                                var splitsingledata = Splitdate[w].split('/');
                                ConcaSpt += splitsingledata[0] + "/" + splitsingledata[1] + ",";
                            }
                            ConcaSpt = ConcaSpt.slice(0, -1);
                        }

                        // var spltfrom = Splitdate[0];
                        //var spltto = Splitdate[Splitdate.length - 1];

                        //if (spltfrom == spltto) {
                        //  ConcaSpt = Splitdate;
                        //}
                        //else {
                        //  ConcaSpt = spltfrom + " to " + spltto;
                        // }

                        Cart_append += "" + ConcaSpt.slice(0, parseInt(20)) + (ConcaSpt.length > parseInt(20) ? "..." : "") + " " + "-" + " " + Cart[i].FromTime + " " + "to" + " " + Cart[i].ToTime + "<br/>";
                        //}
                        Cart_append += "</td>";
                        Cart_append += "<td style='text-align:center;'>";
                        Cart_append += "<img class='editimage' id='tdimgedit" + Cart[i].CartID + "' title='Edit' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;' onclick='EditCart(" + Cart[i].CartID + ")' />";
                        Cart_append += "<img class='cancelimage' id='tdimgcancel" + Cart[i].CartID + "' title='Delete' src='images/New Images/img_trans.gif' style='height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -203px -94px;margin-left:4%;cursor:pointer;' onclick='DeleteCart(" + Cart[i].CartID + ")' />";
                        Cart_append += "</td>";
                        Cart_append += "</tr >";
                    }
                    else {
                        if (i % 2 == 0) {
                            Cart_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Cart[i].CartID + "'>";
                        }
                        else {
                            Cart_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Cart[i].CartID + "'>";
                        }
                        Cart_append += "<td class='Recentvisitortabletd' style='color:#0033a0;font:14px Arial-Bold;padding-left:15px;' title=\"" + Cart[i].VisitorName + "\">";
                        if (parseInt(Cart[i].isDatacenterAccess) == 0) {
                            Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "";
                        }
                        else {
                            Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "<img src='images/New%20Images/img_trans.gif' style='background:url(images/New%20Images/VMS-Icons.png) no-repeat -452px -232px;height:21px;margin-left:4px;margin-top:3%;' />";
                        }
                        Cart_append += "</td>";
                        Cart_append += "<td class='Recentvisitortabletd' title=\"" + Cart[i].LocationName + "\">";
                        Cart_append += "" + Cart[i].LocationName.slice(0, parseInt(15)) + (Cart[i].LocationName.length > parseInt(15) ? "..." : "") + "";
                        Cart_append += "</td>";
                        Cart_append += "<td class='Recentvisitortabletd' style='width:18%;' title='" + Cart[i].HostID + "'>";
                        Cart_append += "" + Cart[i].HostID.slice(0, parseInt(15)) + (Cart[i].HostID.length > parseInt(15) ? "..." : "" + "") + "";
                        Cart_append += "</td>";
                        Cart_append += "<td  class='Recentvisitortabletd' style='width:37%;' title=" + Cart[i].Date + ">";
                        var Splitdate = Cart[i].Date.split(',');
                        if (Splitdate.length == 1) {
                            ConcaSpt = Splitdate;
                        }
                        else {
                            var ConcaSpt = "";
                            for (var w = 0; w < Splitdate.length; w++) {
                                var splitsingledata = Splitdate[w].split('/');
                                ConcaSpt += splitsingledata[0] + "/" + splitsingledata[1] + ",";
                            }
                            ConcaSpt = ConcaSpt.slice(0, -1);
                        }

                        // var spltfrom = Splitdate[0];
                        //var spltto = Splitdate[Splitdate.length - 1];

                        //if (spltfrom == spltto) {
                        //  ConcaSpt = Splitdate;
                        //}
                        //else {
                        //  ConcaSpt = spltfrom + " to " + spltto;
                        // }

                        Cart_append += "" + ConcaSpt.slice(0, parseInt(20)) + (ConcaSpt.length > parseInt(20) ? "..." : "") + " " + "-" + " " + Cart[i].FromTime + " " + "to" + " " + Cart[i].ToTime + "<br/>";
                        //}
                        Cart_append += "</td>";
                        Cart_append += "<td style='text-align:center;'>";
                        Cart_append += "<img class='editimage' id='tdimgmultiple" + Cart[i].CartID + "' title='Expand' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -118px -95px;cursor:pointer;margin-left:-21px;' onclick='OpenMultiple(" + Cart[i].CartID + ")' />";
                        Cart_append += "<img class='editimage' id='tdimgedit" + Cart[i].CartID + "' title='Edit' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;margin-left:3%;' onclick='EditCart(" + Cart[i].CartID + ")' />";
                        Cart_append += "<img class='cancelimage' id='tdimgcancel" + Cart[i].CartID + "' title='Delete' src='images/New Images/img_trans.gif' style='height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -203px -94px;margin-left:4%;cursor:pointer;' onclick='DeleteCart(" + Cart[i].CartID + ")' />";
                        Cart_append += "</td>";
                        Cart_append += "</tr>";
                        for (var m = 0; m < Cart[i].LocationCount; m++) {
                            Cart_append += "<tr class='Recentvisitortablebodytrodd' style='display:none;' id='" + m + "Multipletr" + Cart[i].CartID + "'>";
                            Cart_append += "</tr>";
                        }
                    }
                }
                $("#tbodycart").html(Cart_append);
                $("#tbodycart1").html(Cart_append);
                $("#fade").hide();
                $("#modal").hide();
            },
            error: function (result) {
                $("#fade").hide();
                $("#modal").hide();
            }
        });
    }
    //$('.select2-dropdown').css("width", "260px");         
});

function ontotimeChange() {
    var start = $("#txtstarttime").val();
    var end = $("#txtendtime").val();
    if (start != "" || start != null || start != undefined) {
        var dtStart = new window.Date("1/1/2011 " + start);
        var dtEnd = new window.Date("1/1/2011 " + end);
        var difference_in_milliseconds = dtEnd - dtStart;
        if (difference_in_milliseconds <= 0) {
            $("#spnerror").text("*Error : To Time should be greater than From Time");
            $("#txtstarttime").css('border-color', '#f4633a');
            $("#spnerror").show();
            $("#txtendtime").css('border-color', '#f4633a');
            $("#fade").hide();
            $("#modal").hide();
            return false;
        }
    }
}

function appendZero(num, size) {
    var s = num + "";
    while (s.length < size) s = "0" + s;
    return s;
}

function bulkcancel(ID) {
    $("#ddlpurpose").removeAttr("disabled");
}

function backtrack() {
    location.href = "NewTrack.aspx";
    $("#ddlpurpose").removeAttr("disabled");
    $("#AddMoreLocation").removeAttr("disabled");
}

function SessionExpireAlert(timeout) {
    var seconds = timeout / 1000;
    setTimeout(function () {
        alert("Seession end in 13 sec")
    }, timeout - 20 * 1000);
    setTimeout(function () {
        window.location = "Index.aspx";
    }, timeout);
};

function OpenDatacenterUpdateform() {
    $("#fade").show();
    $("#modal").show();
    var ID = document.getElementById("hdnVisitorIDforDC").value;
    $.ajax({
        type: "POST",
        url: "HomePage.aspx/DCuniqueIDLink_update",
        contentType: "application/json;charset=utf-8",
        data: '{"dc_visitorid":"' + ID + '"}',
        dataType: "json",
        success: function (data) {
            var jsondata = JSON.parse(data.d);
            $("#fade").hide();
            $("#modal").hide();
            var myWindow = window.open("https://onecsitapps.cognizant.com/2235/Home/ExternalIndexEdit?uniqueid=" + jsondata + "", "", "width=700,height=430");
        },
        error: function (result) {
            $("#fade").hide();
            $("#modal").hide();
        }
    });
    $("#fade").hide();
    $("#modal").hide();
}

function OpenDatacenterform() {
    $("#fade").hide();
    $("#modal").hide();
    var ID = document.getElementById("hdnVisitorIDforDC").value;
    $(".Dataccessdiv").html("<a href='#' id='dataccess'  style='color:#0033a0;font:14px Arial-Regular;' onclick='OpenDatacenterUpdateform()'>Update Datacenter Access Details</a>");
    $.ajax({
        type: "POST",
        url: "HomePage.aspx/DCuniqueIDLink",
        contentType: "application/json;charset=utf-8",
        data: '{}',
        dataType: "json",
        success: function (data) {
            var jsondata = data.d;
            var splitjson = jsondata.split(',');
            $("#fade").hide();
            $("#modal").hide();
            document.getElementById("hdnVisitorIDforDC").value = splitjson[1];
            var myWindow = window.open("https://onecsitapps.cognizant.com/2235/Home/Index?uniqueid=" + splitjson[0] + "", "", "width=700,height=430");
        },
        error: function (result) {
            $("#fade").hide();
            $("#modal").hide();
        }
    });
}

function DataAccess() {
    $(".Dataccessdiv").html("<a href='#' id='dataccess' style='color:#0033a0;font:14px Arial-Regular;' onclick='OpenDatacenterform()'>Fill Datacenter Access Details</a>");
}

function SelectAll() {
    var s = $('.dataaccesscheckbox1').prop('checked');
    if (s == false) {
        $('.dataaccesscheckbox').prop('checked', false);
        $(".Recentvisitortablebodytrodd").css("background-color", "#ffffff");
        $(".Recentvisitortablebodytreven").css("background-color", "#FAFBFD");
        $(".btnAddCart").css("pointer-events", "none");
        $(".btnAddCart").css("background-color", "#d9d9d9 ");
        $(".btnAddCart").attr("disabled", "disabled");
        //$(".Recentvisitortabletextbox").css("color", "#596679");
        //$(".Recentvisitortabletextbox").css("font", "14px Arial-Regular");
    }
    else {
        $('.dataaccesscheckbox').prop('checked', true);
        $(".Recentvisitortablebodytrodd").css("background-color", "#E3EEF2");
        $(".Recentvisitortablebodytreven").css("background-color", "#E3EEF2");
        $(".btnAddCart").css("pointer-events", "visible");
        $(".btnAddCart").css("background-color", "#00b140");
        $(".btnAddCart").removeAttr("disabled");
        //$(".Recentvisitortabletextbox").css("color", "#334151");
        //$(".Recentvisitortabletextbox").css("font", "14px Arial-Bold");
    }
}

function OpenMultiple(ID) {
    $("#fade").show();
    $("#modal").show();
    $.ajax({
        type: "POST",
        url: "HomePage.aspx/GetCartLocation",
        contentType: "application/json;charset=utf-8",
        data: '{"cartID":"' + ID + '"}',
        dataType: "json",
        success: function (data) {
            var object = JSON.parse(data.d);
            //Cart_append += "<table>";
            for (var i = 0; i < object.length; i++) {
                var shown = $("#" + i + "Multipletr" + ID).css("display");
                if (shown == "table-row") {
                    $("#" + i + "Multipletr" + ID).hide();
                    $("#tdimgmultiple" + ID).css("background", "url(images/New%20Images/VMS-Icons.png) no-repeat -118px -95px");
                }
                else {
                    $("#tdimgmultiple" + ID).css("background", "url(images/New%20Images/VMS-Icons.png) no-repeat -162px -93px");
                    var Cart_append = "";
                    var splitdate = object[i].CartLocationDate.split(',');
                    //Cart_append += "<tr>";
                    Cart_append += "<td class='Recentvisitortabletd'>";
                    Cart_append += "</td>";
                    Cart_append += "<td class='Recentvisitortabletd' title='" + object[i].CartLocation + "'>";
                    Cart_append += "" + object[i].CartLocation.slice(0, parseInt(15)) + (object[i].CartLocation.length > parseInt(15) ? "..." : "") + "";
                    Cart_append += "</td>";
                    Cart_append += "<td class='Recentvisitortabletd' style='width:18%;' title='" + object[i].CartLocationHostID + "'>";
                    Cart_append += "" + object[i].CartLocationHostID.slice(0, parseInt(15)) + (object[i].CartLocationHostID.length > parseInt(15) ? "..." : "") + "";
                    Cart_append += "</td>";
                    Cart_append += "<td class='Recentvisitortabletd' style='width:37%;' title=" + object[i].CartLocationDate + ">";
                    //var Splitdate = object[i].CartLocationDate.split(',');
                    //var spltfrom = Splitdate[0];
                    //var spltto = Splitdate[Splitdate.length - 1];
                    //var ConcaSpt = "";
                    //if (spltfrom == spltto) {
                    //    ConcaSpt = Splitdate;
                    //}
                    //else {
                    //    ConcaSpt = spltfrom + " to " + spltto;
                    //}
                    //for (var f = 0; f < Splitdate.length; f++) {
                    var Splitdate = object[i].CartLocationDate.split(',');
                    if (Splitdate.length == 1) {
                        ConcaSpt = Splitdate;
                    }
                    else {
                        var ConcaSpt = "";
                        for (var w = 0; w < Splitdate.length; w++) {
                            var splitsingledata = Splitdate[w].split('/');
                            ConcaSpt += splitsingledata[0] + "/" + splitsingledata[1] + ",";
                        }
                        ConcaSpt = ConcaSpt.slice(0, -1);
                    }
                    Cart_append += "" + ConcaSpt.slice(0, parseInt(20)) + (ConcaSpt.length > parseInt(20) ? "..." : "") + " " + "-" + " " + object[i].CartLocationStartTime + " " + "to" + " " + object[i].CartLocationEndTime + "<br/>";
                    //}
                    Cart_append += "</td>";
                    Cart_append += "<td style='text-align:center;'>";
                    Cart_append += "</td>";
                    //Cart_append += "</tr>";
                    $("#" + i + "Multipletr" + ID).html(Cart_append);
                    $("#" + i + "Multipletr" + ID).show();
                }
            }
            //Cart_append += "</table>";                  
            $("#fade").hide();
            $("#modal").hide();
        },
        error: function (result) {
            $("#fade").hide();
            $("#modal").hide();
        }
    });
}

function GetAssociateDeails(ID) {
    if (ID == 0) {
        var text = $("#txthostID").val();
        if (text.length >= 2) {
            $("#txthostID").autocomplete({
                source: function (request, response) {
                    $.ajax({
                        url: 'HomePage.aspx/GetAssociateDetails',
                        data: '{"text":"' + text + '"}',
                        dataType: "json",
                        type: "POST",
                        contentType: "application/json; charset=utf-8",
                        success: function (data) {
                            var serachData = JSON.parse(data.d)
                            if (serachData.length > 0) {
                                response(serachData);
                            }
                            else {
                                var result = [
                                    {
                                        label: 'Entered Asssociate doesn’t belong to M+ level',
                                        value: response.term

                                    }
                                ];
                                response(result);

                            }
                        },
                        error: function (XMLHttpRequest, textStatus, errorThrown) {
                            var err = eval("(" + XMLHttpRequest.responseText + ")");
                            alert(err.Message)
                        }
                    });
                },
                minLength: 3
            });
        }
    }
    else {
        var text = $("#txthostID" + ID + "").val();
        if (text.length >= 2) {
            $("#txthostID" + ID + "").autocomplete({
                source: function (request, response) {
                    $.ajax({
                        url: 'HomePage.aspx/GetAssociateDetails',
                        data: '{"text":"' + text + '"}',
                        dataType: "json",
                        type: "POST",
                        contentType: "application/json; charset=utf-8",
                        success: function (data) {
                            var serachData = JSON.parse(data.d)
                            if (serachData.length > 0) {
                                response(serachData);
                            }
                            else {
                                var result = [
                                    {
                                        label: 'Entered Asssociate doesn’t belong to M+ leve1',
                                        value: response.term
                                    }
                                ];
                                response(result);
                            }
                        },
                        error: function (XMLHttpRequest, textStatus, errorThrown) {
                            var err = eval("(" + XMLHttpRequest.responseText + ")");
                            alert(err.Message)
                        }
                    });
                },
                minLength: 3
            });
        }
    }
}

function UpdateData(VisitorID, RequestID) {
    $("#fade").show();
    $("#modal").show();
    var MobileNo = $("#tdtxtCountryCode").val() + '-' + $("#tdtxtmobileno").val();
    if (MobileNo == "" || MobileNo == null || MobileNo == undefined) {
        $("#spnerrorspan").text("Enter Mobile Number");
        $("#tdtxtmobileno").css('border-color', '#f4633a');
        $("#spnerror").show();
        $("#fade").hide();
        $("#modal").hide();
        return false;
    } else {
        var Color = $("#tdtxtmobileno").css('border-color');
        if (Color == "rgb(214, 214, 214)") {
            $("#tdtxtmobileno").css('border-color', '#d6d6d6');
        }
    }
    var code = $("#tdtxtCountryCode").val();
    var mob = $("#tdtxtmobileno").val();
    if (code == "+91") {
        if (mob.length < 10 || mob.length > 10) {
            $("#spnerrorspan").text("Enter Valid Mobile Number");
            $("#tdtxtmobileno").css('border-color', '#f4633a');
            $("#spnerror").show();
            $("#fade").hide();
            $("#modal").hide();
            return false;
        }
        else {
            var Color = $("#tdtxtmobileno").css('border-color');
            if (Color == "rgb(214, 214, 214)") {
                $("#tdtxtmobileno").css('border-color', '#d6d6d6');
            }
        }
    }

    if (isNaN(mob)) {
        $("#spnerrorspan").text("Enter only Numbers");
        $("#tdtxtmobileno").css('border-color', '#f4633a');
        $("#spnerror").show();
        $("#fade").hide();
        $("#modal").hide();
        return false;
    }
    else {
        var Color = $("#tdtxtmobileno").css('border-color');
        if (Color == "rgb(214, 214, 214)") {
            $("#tdtxtmobileno").css('border-color', '#d6d6d6');
        }
    }
    var iszero = /^0*$/.test(mob);
    if (iszero == true) {
        $("#spnerrorspan").text("Enter Valid Mobile Number");
        $("#tdtxtmobileno").css('border-color', '#f4633a');
        $("#spnerror").show();
        $("#fade").hide();
        $("#modal").hide();
        return false;
    } else {
        var Color = $("#tdtxtmobileno").css('border-color');
        if (Color == "rgb(214, 214, 214)") {
            $("#tdtxtmobileno").css('border-color', '#d6d6d6');
        }
    }

    var Name = $("#tdtxtvisitorName").val();
    if (Name == "" || Name == null || Name == undefined) {
        $("#spnerrorspan").text("Enter Visitor Name");
        $("#tdtxtvisitorName").css('border-color', '#f4633a');
        $("#spnerror").show();
        $("#fade").hide();
        $("#modal").hide();
        return false;
    }
    else {
        var Color = $("#tdtxtvisitorName").css('border-color');
        if (Color == "rgb(214, 214, 214)") {
            $("#tdtxtvisitorName").css('border-color', '#d6d6d6');
        }
    }
    var Organization = $("#tdtxtcompany").val();
    if (VisitorType != "Family Members") {
        if (Organization == "" || Organization == null || Organization == undefined) {
            $("#spnerrorspan").text("Enter Visitor Organization");
            $("#tdtxtcompany").css('border-color', '#f4633a');
            $("#spnerror").show();
            $("#fade").hide();
            $("#modal").hide();
            return false;
        }
        else {
            var Color = $("#tdtxtcompany").css('border-color');
            if (Color == "rgb(214, 214, 214)") {
                $("#tdtxtcompany").css('border-color', '#d6d6d6');
            }
        }
    }
    else {
        if (Organization == "Optional") {
            Organization = "";
        }
    }
    var Visitordrop = document.getElementById("tdtxtvisitortype");
    var VisitorType = Visitordrop.options[Visitordrop.selectedIndex].text;
    if (VisitorType == "Select Visitor Type") {
        $("#tdtxtvisitortype").css('border-color', '#f4633a');
        $("#visitorspnerror").show();
        $("#fade").hide();
        $("#modal").hide();
        return false;
    }
    else {
        $("#tdtxtvisitortype").css('border-color', '#d6d6d6');
    }
    var Others = "";
    if (VisitorType == "Others") {
        Others = $("#txtothers").val();
        if (Others == "" || Others == null || Others == undefined) {
            $("#txtothers").css('border-color', '#f4633a');
            $("#Otherspnerror").show();
            $("#fade").hide();
            $("#modal").hide();
            return false;
        }
        else {
            $("#txtothers").css('border-color', '#d6d6d6');
        }
    }
    $.ajax({
        type: "POST",
        url: "HomePage.aspx/UpdateRequest",
        contentType: "application/json;charset=utf-8",
        data: '{"visitorID":"' + VisitorID + '","name":"' + Name + '","company":"' + Organization + '","mobileNo":"' + MobileNo + '","visitorType":"' + VisitorType + '","others":"' + Others + '"}',
        dataType: "json",
        success: function (data) {
            $("#tdtxtvisitorName").removeClass("Recentvisitortableaftertextbox");
            $("#tdtxtvisitorName").addClass("Recentvisitortabletextbox");
            $("#tdtxtvisitorName").attr("disabled", "disabled");
            $("#tdtxtCountryCode").removeClass("Recentvisitortableaftertextbox");
            $("#tdtxtCountryCode").addClass("Recentvisitortabletextbox");
            $("#tdtxtCountryCode").attr("disabled", "disabled");
            $("#tdtxtmobileno").removeClass("Recentvisitortableaftertextbox");
            $("#tdtxtmobileno").addClass("Recentvisitortabletextbox");
            $("#tdtxtmobileno").attr("disabled", "disabled");
            $("#tdtxtvisitorName").removeClass("Recentvisitortableaftertextbox");
            $("#tdtxtvisitorName").addClass("Recentvisitortabletextbox");
            $("#tdtxtvisitorName").attr("disabled", "disabled");
            $("#tdtxtcompany").removeClass("Recentvisitortableaftertextbox");
            $("#tdtxtcompany").addClass("Recentvisitortabletextbox");
            $("#tdtxtcompany").attr("disabled", "disabled");
            $("#tdtxtvisitortype").removeClass("Recentvisitortableaftertextbox");
            $("#tdtxtvisitortype").addClass("Recentvisitortabletextbox");
            $("#tdtxtvisitortype").attr("disabled", "disabled");
            //if (parseInt(jsondata) == 1) {
            //    $("#tdchkeuipment").prop("checked", true);
            //}
            //else {
            //    $("#tdchkeuipment").prop("checked", false);
            //}
            $("#tdaequipment").text("Yes");
            $("#tdaequipment").css("color", "#00b140");
            $("#tdaequipment").css("text-decoration", "#underline");
            $(".Recentvisitortablebodytrodd").css("background-color", "#E3EEF2");
            //$(".btnAddCart").removeAttr("disabled");
            //$(".btnAddCart").css("background-color", "#00728f");
            $("#tdtxtvisitorName").css("color", "#334151");
            $("#tdtxtvisitorName").css("font", "14px Arial-Regular");
            $("#tdtxtcompany").css("color", "#334151");
            $("#tdtxtcompany").css("font", "14px Arial-Regular");
            $("#tdtxtvisitortype").css("color", "#334151");
            $("#tdtxtvisitortype").css("font", "14px Arial-Regular");
            $("#tdtxtCountryCode").css("color", "#334151");
            $("#tdtxtCountryCode").css("font", "14px Arial-Regular");
            $("#tdtxtmobileno").css("color", "#334151");
            $("#tdtxtmobileno").css("font", "14px Arial-Regular");
            $("#tdaequipment").css("color", "#334151");
            $("#tdaequipment").css("font", "14px Arial-Regular");
            $("#fade").hide();
            $("#modal").hide();
        },
        error: function (result) {
            $("#fade").hide();
            $("#modal").hide();
        }
    });
}

function YesDelete(VisitorID, RequestID, status) {
    if (status == "ViewCancel") {
        $("#fade").show();
        $("#modal").show();
        $.ajax({
            type: "POST",
            url: "HomePage.aspx/CancelRequest",
            contentType: "application/json;charset=utf-8",
            data: '{"requestID":"' + RequestID + '","vistorID":"' + VisitorID + '"}',
            dataType: "json",
            success: function (data) {
                $("#btnYesdelete").removeAttr("onclick");
                //location.href = "NewTrack.aspx";
                $("#fade").hide();
                $("#modal").hide();
                document.getElementById('UpdateSucessmessage').style.display = 'block';
                $("#UpdateSucessmessagebody").html("Request has been cancelled successfully.");
            },
            error: function (result) {
                $("#fade").hide();
                $("#modal").hide();

            }
        });
    }
    else if (status == "Cartdelete") {
        $("#fade").show();
        $("#modal").show();
        $(".txtserachbox").removeAttr("disabled");
        $(".btnserach").removeAttr("disabled");
        $("#ddlpurpose").removeAttr("disabled");
        $.ajax({
            type: "POST",
            url: "HomePage.aspx/DeleteCart",
            contentType: "application/json;charset=utf-8",
            data: '{"cartID":"' + VisitorID + '"}',
            dataType: "json",
            success: function (data) {
                var Cart = JSON.parse(data.d);
                var Cart_append = "";
                if (Cart.length > 0) {
                    $(".btnPreviewSubmit").css("background-color", "#00b140");
                    $(".btnPreviewSubmit").removeAttr("disabled");
                }
                else {
                    $("#spncartcount").text("(0)");
                    $("#spncartcount").css("color", "#d9d9d9");
                    $(".CartImg").css("background", "url('.../../images/New Images/VMS-Icons.png') no-repeat -192px -289px");
                    var Cartmodal = document.getElementById('CardModel');
                    Cartmodal.style.display = "none";
                    $(".btnPreviewSubmit").css("background-color", "#d9d9d9");
                    $(".btnPreviewSubmit").attr("disabled", "disabled");
                    $("#btnNewVisitor").removeAttr("onclick");
                    $("#btnNewVisitor").css("background-color", "#d9d9d9");
                    $.ajax({
                        type: "POST",
                        url: "HomePage.aspx/GetRecentVisitors",
                        contentType: "application/json;charset=utf-8",
                        data: "{'visitorCount':" + parseInt("9") + "}",
                        dataType: "json",
                        success: function (data) {
                            if (data.d == "" || data.d == null || data.d == undefined) {
                                $("#RecentVisitortablebody").html("<tr style='height:395px;'><td></td><td></td><td></td><td style='width:210px;color:#596679;font:14px Arial-Regular;'>No Recent Visitors Found</td><td></td><td></td><td></td></tr>");
                                $("#tblRecentvisitor thead td").css("border", "2px solid #dfe9f4");
                                $("#tblRecentvisitor tbody td").css("border", "none");
                                $("#fade").hide();
                                $("#modal").hide();
                            }
                            else {
                                var Recentdata = JSON.parse(data.d);
                                var RecentData_append = "";
                                if (Recentdata.length > 0) {
                                    for (var i = 0; i < Recentdata.length; i++) {
                                        if (i % 2 == 0) {
                                            RecentData_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Recentdata[i].VisitorId + "'>";
                                        }
                                        else {
                                            RecentData_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Recentdata[i].VisitorId + "'>";
                                        }
                                        RecentData_append += "<td style='width:44px;text-align:center;'>";
                                        RecentData_append += "<input type='checkbox' value='" + Recentdata[i].VisitorId + "' class='dataaccesscheckbox' id='tdchkselect" + Recentdata[i].VisitorId + "' onchange='UserSelectChange(" + Recentdata[i].VisitorId + ")'>";
                                        RecentData_append += "</td>";
                                        RecentData_append += "<td class='Recentvisitortabletd' style='width:168px;'>";
                                        RecentData_append += "<input type='text' maxlength='25' id='tdtxtvisitorName" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].VisitorFullName + "' disabled />";
                                        RecentData_append += "</td>";
                                        RecentData_append += "<td class='Recentvisitortabletd' style='width:215px;'>";
                                        var Mobile = Recentdata[i].MobileNo.split('-');
                                        RecentData_append += "<select type='text' id='tdtxtCountryCode" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' style='width:28px;' disabled ><option>" + Mobile[0] + "</option></select>-<input id='tdtxtmobileno" + Recentdata[i].VisitorId + "' style='margin-left:0%;width:73px;' maxlength='10' onkeypress='return isNumberKey(event)' onfocusout='return isvalidmobile(" + Recentdata[i].VisitorId + ")' class='Recentvisitortabletextbox' type='text' value='" + Mobile[1] + "' disabled />";
                                        RecentData_append += "</td>";
                                        RecentData_append += "<td class='Recentvisitortabletd' style='width:158px;'>";
                                        RecentData_append += "<input type='text' maxlength='25' id='tdtxtcompany" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].Company + "' disabled />";
                                        RecentData_append += "</td>";
                                        RecentData_append += "<td class='Recentvisitortabletd' style='width:15px;'>";
                                        RecentData_append += "<select type='text' id='tdtxtvisitortype" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' disabled ><option>" + Recentdata[i].VisitorType + "</option></select>";
                                        RecentData_append += "</td>";

                                        RecentData_append += "<td class='Recentvisitortabletd' style='width:120px;>";
                                        if (Recentdata[i].PermitITEquipments == true) {
                                            RecentData_append += "<a title='Please click here to add equipment details' id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#00b140;cursor:pointer;text-decoration:underline;' onclick='OpenEquipment(" + Recentdata[i].VisitorId + ",0)' name='" + Recentdata[i].VisitorId + "'>Yes</a>";
                                        }
                                        else {
                                            RecentData_append += "<a title='Please click here to add equipment details' id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#596679;cursor:pointer;' name='0'>No</a>";
                                        }
                                        RecentData_append += "</td>";
                                        RecentData_append += "<td style='width:48px;text-align:center;'>";
                                        RecentData_append += "<img id='tdimgsave" + Recentdata[i].VisitorId + "' title='Save' src='images/New Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -37px -235px;' onclick='SaveTableRow(" + Recentdata[i].VisitorId + ")' />";
                                        RecentData_append += "<img id='tdimgcancel" + Recentdata[i].VisitorId + "' title='Cancel' src='images/New Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -288px -163px;' onclick='CancelTableRow(" + Recentdata[i].VisitorId + ")' />";
                                        RecentData_append += "<img id='tdimgedit" + Recentdata[i].VisitorId + "' title='Edit' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;' onclick='EditTableRow(" + Recentdata[i].VisitorId + ")' />";
                                        RecentData_append += "</td>";
                                        RecentData_append += "</tr >";
                                    }
                                    $("#RecentVisitortablebody").html(RecentData_append);
                                    $('.divRecentvisitor').slimScroll({
                                        height: '432px',
                                        width: '100%'
                                    });
                                }
                                $(".btnAddCart").css("pointer-events", "none");
                                $(".btnAddCart").css("background-color", "#d9d9d9");
                                $("#ddlpurpose").val("Select Visitor Type");
                                $("#txtvisitdate").val("");
                                $("#txtstarttime").val("09:00");
                                $("#txtendtime").val("18:00");
                                //$('#ddllocationlist').val("0");
                                //$('#ddllocationlist').trigger('change');
                                $("#txthostID").val("");
                                $("#fade").hide();
                                $("#modal").hide();
                                //for (var k = 0; k < LocationCount; k++) {
                                //    k = parseInt(k) + 1;
                                $(".divLocationdetails").remove();
                                //}
                                $("#AddMoreLocation").attr("onclick", "AddExtraLocation(0)");
                                $("#AddMoreLocation").css("margin-left", "127px");
                            }
                        },
                        error: function (result) {
                            $("#fade").hide();
                            $("#modal").hide();

                        }
                    });
                }
                for (var i = 0; i < Cart.length; i++) {
                    $("#spncartcount").text("(" + (i + 1) + ")");
                    $("#spncartcount1").text((i + 1));
                    $("#spncartcount").css("color", "#00b140");
                    $(".CartImg").css("background", "url('.../../images/New Images/VMS-Icons.png') no-repeat -192px -228px");
                    if (parseInt(Cart[i].Ismultilocation) == 0) {
                        if (i % 2 == 0) {
                            Cart_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Cart[i].CartID + "'>";
                        }
                        else {
                            Cart_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Cart[i].CartID + "'>";
                        }
                        Cart_append += "<td class='Recentvisitortabletd' style='color:#0033a0;font:14px Arial-Bold;padding-left:15px;' title=\"" + Cart[i].VisitorName + "\">";
                        if (parseInt(Cart[i].isDatacenterAccess) == 0) {
                            Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "";
                        }
                        else {
                            Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "<img src='images/New%20Images/img_trans.gif' style='background:url(images/New%20Images/VMS-Icons.png) no-repeat -452px -232px;height:21px;margin-left:4px;margin-top:3%;' />";
                        }
                        Cart_append += "</td>";
                        Cart_append += "<td class='Recentvisitortabletd' title=\"" + Cart[i].LocationName + "\">";
                        Cart_append += "" + Cart[i].LocationName.slice(0, parseInt(15)) + (Cart[i].LocationName.length > parseInt(15) ? "..." : "") + "";
                        Cart_append += "</td>";
                        Cart_append += "<td class='Recentvisitortabletd' style='width:18%;' title='" + Cart[i].HostID + "'>";
                        Cart_append += "" + Cart[i].HostID.slice(0, parseInt(15)) + (Cart[i].HostID.length > parseInt(15) ? "..." : "") + "";
                        Cart_append += "</td>";
                        Cart_append += "<td  class='Recentvisitortabletd' style='width:37%;' title=" + Cart[i].Date + ">";
                        var Splitdate = Cart[i].Date.split(',');
                        if (Splitdate.length == 1) {
                            ConcaSpt = Splitdate;
                        }
                        else {
                            var ConcaSpt = "";
                            for (var w = 0; w < Splitdate.length; w++) {
                                var splitsingledata = Splitdate[w].split('/');
                                ConcaSpt += splitsingledata[0] + "/" + splitsingledata[1] + ",";
                            }
                            ConcaSpt = ConcaSpt.slice(0, -1);
                        }

                        // var spltfrom = Splitdate[0];
                        //var spltto = Splitdate[Splitdate.length - 1];

                        //if (spltfrom == spltto) {
                        //  ConcaSpt = Splitdate;
                        //}
                        //else {
                        //  ConcaSpt = spltfrom + " to " + spltto;
                        // }

                        Cart_append += "" + ConcaSpt.slice(0, parseInt(20)) + (ConcaSpt.length > parseInt(20) ? "..." : "") + " " + "-" + " " + Cart[i].FromTime + " " + "to" + " " + Cart[i].ToTime + "<br/>";
                        //}
                        Cart_append += "</td>";
                        Cart_append += "<td style='text-align:center;'>";
                        Cart_append += "<img class='editimage' id='tdimgedit" + Cart[i].CartID + "' title='Edit' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;' onclick='EditCart(" + Cart[i].CartID + ")' />";
                        Cart_append += "<img class='cancelimage' id='tdimgcancel" + Cart[i].CartID + "' title='Delete' src='images/New Images/img_trans.gif' style='height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -203px -94px;margin-left:4%;cursor:pointer;' onclick='DeleteCart(" + Cart[i].CartID + ")' />";
                        Cart_append += "</td>";
                        Cart_append += "</tr >";
                    }
                    else {
                        if (i % 2 == 0) {
                            Cart_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Cart[i].CartID + "'>";
                        }
                        else {
                            Cart_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Cart[i].CartID + "'>";
                        }
                        Cart_append += "<td class='Recentvisitortabletd' style='color:#0033a0;font:14px Arial-Bold;padding-left:15px;' title=\"" + Cart[i].VisitorName + "\">";
                        if (parseInt(Cart[i].isDatacenterAccess) == 0) {
                            Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "";
                        }
                        else {
                            Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "<img src='images/New%20Images/img_trans.gif' style='background:url(images/New%20Images/VMS-Icons.png) no-repeat -452px -232px;height:21px;margin-left:4px;margin-top:3%;' />";
                        }
                        Cart_append += "</td>";
                        Cart_append += "<td class='Recentvisitortabletd' title=\"" + Cart[i].LocationName + "\">";
                        Cart_append += "" + Cart[i].LocationName.slice(0, parseInt(15)) + (Cart[i].LocationName.length > parseInt(15) ? "..." : "") + "";
                        Cart_append += "</td>";
                        Cart_append += "<td class='Recentvisitortabletd' style='width:18%;' title='" + Cart[i].HostID + "'>";
                        Cart_append += "" + Cart[i].HostID.slice(0, parseInt(15)) + (Cart[i].HostID.length > parseInt(15) ? "..." : "" + "") + "";
                        Cart_append += "</td>";
                        Cart_append += "<td  class='Recentvisitortabletd' style='width:37%;' title=" + Cart[i].Date + ">";
                        var Splitdate = Cart[i].Date.split(',');
                        if (Splitdate.length == 1) {
                            ConcaSpt = Splitdate;
                        }
                        else {
                            var ConcaSpt = "";
                            for (var w = 0; w < Splitdate.length; w++) {
                                var splitsingledata = Splitdate[w].split('/');
                                ConcaSpt += splitsingledata[0] + "/" + splitsingledata[1] + ",";
                            }
                            ConcaSpt = ConcaSpt.slice(0, -1);
                        }

                        // var spltfrom = Splitdate[0];
                        //var spltto = Splitdate[Splitdate.length - 1];

                        //if (spltfrom == spltto) {
                        //  ConcaSpt = Splitdate;
                        //}
                        //else {
                        //  ConcaSpt = spltfrom + " to " + spltto;
                        // }

                        Cart_append += "" + ConcaSpt.slice(0, parseInt(20)) + (ConcaSpt.length > parseInt(20) ? "..." : "") + " " + "-" + " " + Cart[i].FromTime + " " + "to" + " " + Cart[i].ToTime + "<br/>";
                        //}
                        Cart_append += "</td>";
                        Cart_append += "<td style='text-align:center;'>";
                        Cart_append += "<img class='editimage' id='tdimgmultiple" + Cart[i].CartID + "' title='Expand' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -118px -95px;cursor:pointer;margin-left:-21px;' onclick='OpenMultiple(" + Cart[i].CartID + ")' />";
                        Cart_append += "<img class='editimage' id='tdimgedit" + Cart[i].CartID + "' title='Edit' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;margin-left:3%;' onclick='EditCart(" + Cart[i].CartID + ")' />";
                        Cart_append += "<img class='cancelimage' id='tdimgcancel" + Cart[i].CartID + "' title='Delete' src='images/New Images/img_trans.gif' style='height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -203px -94px;margin-left:4%;cursor:pointer;' onclick='DeleteCart(" + Cart[i].CartID + ")' />";
                        Cart_append += "</td>";
                        Cart_append += "</tr>";
                        for (var m = 0; m < Cart[i].LocationCount; m++) {
                            Cart_append += "<tr class='Recentvisitortablebodytrodd' style='display:none;' id='" + m + "Multipletr" + Cart[i].CartID + "'>";
                            Cart_append += "</tr>";
                        }
                    }
                }
                $("#tbodycart").html(Cart_append);
                $("#tbodycart1").html(Cart_append);
                var CurrentLocation = document.getElementById("hdnLocationCode").value;
                $('#ddllocationlist').val(CurrentLocation);
                $('#ddllocationlist').trigger('change');
                $("#fade").hide();
                $("#modal").hide();
            },
            error: function (result) {
                $("#fade").hide();
                $("#modal").hide();
            }
        });
    }
    else if (status == "DeleteAllnew") {
        $.ajax({
            type: "POST",
            url: "HomePage.aspx/GetRecentVisitors",
            contentType: "application/json;charset=utf-8",
            data: "{'visitorCount':" + parseInt("9") + "}",
            dataType: "json",
            success: function (data) {
                if (data.d == "" || data.d == null || data.d == undefined) {
                    $("#RecentVisitortablebody").html("<tr style='height:395px;'><td></td><td></td><td></td><td style='width:210px;color:#596679;font:14px Arial-Regular;'>No Recent Visitors Found</td><td></td><td></td><td></td></tr>");
                    $("#tblRecentvisitor tbody td").css("border", "none");
                    $("#tblRecentvisitor thead td").css("border", "2px solid #dfe9f4");
                    $("#fade").hide();
                    $("#modal").hide();
                }
                else {
                    var Recentdata = JSON.parse(data.d);
                    var RecentData_append = "";
                    if (Recentdata.length > 0) {
                        for (var i = 0; i < Recentdata.length; i++) {
                            if (i % 2 == 0) {
                                RecentData_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Recentdata[i].VisitorId + "'>";
                            }
                            else {
                                RecentData_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Recentdata[i].VisitorId + "'>";
                            }
                            RecentData_append += "<td style='width:44px;text-align:center;'>";
                            RecentData_append += "<input type='checkbox' value='" + Recentdata[i].VisitorId + "' class='dataaccesscheckbox' id='tdchkselect" + Recentdata[i].VisitorId + "' onchange='UserSelectChange(" + Recentdata[i].VisitorId + ")'>";
                            RecentData_append += "</td>";
                            RecentData_append += "<td class='Recentvisitortabletd' style='width:168px;'>";
                            RecentData_append += "<input type='text' maxlength='25' id='tdtxtvisitorName" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].VisitorFullName + "' disabled />";
                            RecentData_append += "</td>";
                            RecentData_append += "<td class='Recentvisitortabletd' style='width:215px;'>";
                            var Mobile = Recentdata[i].MobileNo.split('-');
                            RecentData_append += "<select type='text' id='tdtxtCountryCode" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' style='width:28px;' disabled ><option>" + Mobile[0] + "</option></select>-<input id='tdtxtmobileno" + Recentdata[i].VisitorId + "' style='margin-left:0%;width:73px;' maxlength='10' onkeypress='return isNumberKey(event)' onfocusout='return isvalidmobile(" + Recentdata[i].VisitorId + ")' class='Recentvisitortabletextbox' type='text' value='" + Mobile[1] + "' disabled />";
                            RecentData_append += "</td>";
                            RecentData_append += "<td class='Recentvisitortabletd' style='width:158px;'>";
                            RecentData_append += "<input type='text' maxlength='25' id='tdtxtcompany" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].Company + "' disabled />";
                            RecentData_append += "</td>";
                            RecentData_append += "<td class='Recentvisitortabletd' style='width:15px;'>";
                            RecentData_append += "<select type='text' id='tdtxtvisitortype" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' disabled ><option>" + Recentdata[i].VisitorType + "</option></select>";
                            RecentData_append += "</td>";

                            RecentData_append += "<td class='Recentvisitortabletd' style='width:120px;>";
                            if (Recentdata[i].PermitITEquipments == true) {
                                RecentData_append += "<a title='Please click here to add equipment details' id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#00b140;cursor:pointer;text-decoration:underline;' onclick='OpenEquipment(" + Recentdata[i].VisitorId + ",0)' name='" + Recentdata[i].VisitorId + "'>Yes</a>";
                            }
                            else {
                                RecentData_append += "<a title='Please click here to add equipment details' id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#596679;cursor:pointer;' name='0'>No</a>";
                            }
                            RecentData_append += "</td>";
                            RecentData_append += "<td style='width:48px;text-align:center;'>";
                            RecentData_append += "<img id='tdimgsave" + Recentdata[i].VisitorId + "' title='Save' src='images/New Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -37px -235px;' onclick='SaveTableRow(" + Recentdata[i].VisitorId + ")' />";
                            RecentData_append += "<img id='tdimgcancel" + Recentdata[i].VisitorId + "' title='Cancel' src='images/New Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -288px -163px;' onclick='CancelTableRow(" + Recentdata[i].VisitorId + ")' />";
                            RecentData_append += "<img id='tdimgedit" + Recentdata[i].VisitorId + "' title='Edit' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;' onclick='EditTableRow(" + Recentdata[i].VisitorId + ")' />";
                            RecentData_append += "</td>";
                            RecentData_append += "</tr >";
                        }
                        $("#RecentVisitortablebody").html(RecentData_append);
                        $('.divRecentvisitor').slimScroll({
                            height: '432px',
                            width: '100%'
                        });
                    }
                    $(".btnAddCart").css("pointer-events", "none");
                    $(".btnAddCart").css("background-color", "#d9d9d9");
                    $("#ddlpurpose").val("Select Visitor Type");
                    $("#txtvisitdate").val("");
                    $("#txtstarttime").val("09:00");
                    $("#txtendtime").val("18:00");
                    //$('#ddllocationlist').val("0");
                    var s = document.getElementById("hdnLocationCode").value;
                    $('#ddllocationlist').val(s);
                    $('#ddllocationlist').trigger('change');
                    $("#txthostID").val("");
                    $("#fade").hide();
                    $("#modal").hide();
                    //for (var k = 0; k < LocationCount; k++) {
                    //    k = parseInt(k) + 1;
                    $(".divLocationdetails").remove();
                    //}
                    $("#AddMoreLocation").attr("onclick", "AddExtraLocation(0)");
                    $("#AddMoreLocation").css("margin-left", "127px");
                }
            },
            error: function (result) {
                $("#fade").hide();
                $("#modal").hide();

            }
        });
        document.getElementById("hdnCartID").value = "";
        $("#txtSerachbox").removeAttr("disabled");
        $("#btnSearch").removeAttr("disabled");
        document.getElementById("hdnnewvisitor").value = ""
        $("#tdDeleteall").html("EDIT");
        $(".btnAddCart").html("<img src='images/New%20Images/img_trans.gif' class='addtocarticon'>&nbsp; Add to Cart");
        $(".btnAddCart").css("background-color", "#d9d9d9");
        $(".btnAddCart").css("pointer-events", "none");
        $("#spnerror").hide();
        $("#ddlpurpose").css("border", "1px solid #0033a0");
        $("#btnNewVisitor").css("background-color", "#d9d9d9");
        $("#btnNewVisitor").removeAttr("onclick");
        $("#btnNewVisitor").attr("title", "Please select the visitor type to add a new visitor.");
    }
    else if (status == "CancelNewTableRow") {
        //if (VisitorID != 1) {
        $("#newvisitor" + VisitorID).remove();
        //}
        var newvisitor = document.getElementById("hdnnewvisitor").value;
        if (parseInt(newvisitor) != 0) {
            newvisitor = parseInt(newvisitor) - 1;
        }
        document.getElementById("hdnnewvisitor").value = newvisitor;
        if (parseInt(newvisitor) == 0) {
            $("#fade").show();
            $("#modal").show();
            $(".btnAddCart").html("<img src='images/New%20Images/img_trans.gif' class='addtocarticon'>&nbsp; Add to Cart");
            $("#spnerror").hide();
            $("#ddlpurpose").css("border", "1px solid #0033a0");
            $.ajax({
                type: "POST",
                url: "HomePage.aspx/GetRecentVisitors",
                contentType: "application/json;charset=utf-8",
                data: "{'visitorCount':" + parseInt("9") + "}",
                dataType: "json",
                success: function (data) {
                    if (data.d == "" || data.d == null || data.d == undefined) {
                        $("#RecentVisitortablebody").html("<tr style='height:395px;'><td></td><td></td><td></td><td style='width:210px;color:#596679;font:14px Arial-Regular;'>No Recent Visitors Found</td><td></td><td></td><td></td></tr>");
                        $("#tblRecentvisitor tbody td").css("border", "none");
                        $("#tblRecentvisitor thead td").css("border", "2px solid #dfe9f4");
                        $("#fade").hide();
                        $("#modal").hide();
                    }
                    else {
                        var Recentdata = JSON.parse(data.d);
                        var RecentData_append = "";
                        if (Recentdata.length > 0) {
                            for (var i = 0; i < Recentdata.length; i++) {
                                if (i % 2 == 0) {
                                    RecentData_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Recentdata[i].VisitorId + "'>";
                                }
                                else {
                                    RecentData_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Recentdata[i].VisitorId + "'>";
                                }
                                RecentData_append += "<td style='width:44px;text-align:center;'>";
                                RecentData_append += "<input type='checkbox' value='" + Recentdata[i].VisitorId + "' class='dataaccesscheckbox' id='tdchkselect" + Recentdata[i].VisitorId + "' onchange='UserSelectChange(" + Recentdata[i].VisitorId + ")'>";
                                RecentData_append += "</td>";
                                RecentData_append += "<td class='Recentvisitortabletd' style='width:168px;'>";
                                RecentData_append += "<input type='text' maxlength='25' id='tdtxtvisitorName" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].VisitorFullName + "' disabled />";
                                RecentData_append += "</td>";
                                RecentData_append += "<td class='Recentvisitortabletd' style='width:215px;'>";
                                var Mobile = Recentdata[i].MobileNo.split('-');
                                RecentData_append += "<select type='text' id='tdtxtCountryCode" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' style='width:28px;' disabled ><option>" + Mobile[0] + "</option></select>-<input id='tdtxtmobileno" + Recentdata[i].VisitorId + "' style='margin-left:0%;width:73px;' maxlength='10' onkeypress='return isNumberKey(event)' onfocusout='return isvalidmobile(" + Recentdata[i].VisitorId + ")' class='Recentvisitortabletextbox' type='text' value='" + Mobile[1] + "' disabled />";
                                RecentData_append += "</td>";
                                RecentData_append += "<td class='Recentvisitortabletd' style='width:158px;'>";
                                RecentData_append += "<input type='text' maxlength='25' id='tdtxtcompany" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].Company + "' disabled />";
                                RecentData_append += "</td>";
                                RecentData_append += "<td class='Recentvisitortabletd' style='width:15px;'>";
                                RecentData_append += "<select type='text' id='tdtxtvisitortype" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' disabled ><option>" + Recentdata[i].VisitorType + "</option></select>";
                                RecentData_append += "</td>";

                                RecentData_append += "<td class='Recentvisitortabletd' style='width:120px;>";
                                if (Recentdata[i].PermitITEquipments == true) {
                                    RecentData_append += "<a title='Please click here to add equipment details' id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#00b140;cursor:pointer;text-decoration:underline;' onclick='OpenEquipment(" + Recentdata[i].VisitorId + ",0)' name='" + Recentdata[i].VisitorId + "'>Yes</a>";
                                }
                                else {
                                    RecentData_append += "<a title='Please click here to add equipment details' id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#596679;cursor:pointer;' name='0'>No</a>";
                                }
                                RecentData_append += "</td>";
                                RecentData_append += "<td style='width:48px;text-align:center;'>";
                                RecentData_append += "<img id='tdimgsave" + Recentdata[i].VisitorId + "' title='Save' src='images/New Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -37px -235px;' onclick='SaveTableRow(" + Recentdata[i].VisitorId + ")' />";
                                RecentData_append += "<img id='tdimgcancel" + Recentdata[i].VisitorId + "' title='Cancel' src='images/New Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -288px -163px;' onclick='CancelTableRow(" + Recentdata[i].VisitorId + ")' />";
                                RecentData_append += "<img id='tdimgedit" + Recentdata[i].VisitorId + "' title='Edit' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;' onclick='EditTableRow(" + Recentdata[i].VisitorId + ")' />";
                                RecentData_append += "</td>";
                                RecentData_append += "</tr >";
                            }
                            $("#RecentVisitortablebody").html(RecentData_append);
                            $('.divRecentvisitor').slimScroll({
                                height: '432px',
                                width: '100%'
                            });
                        }
                        $(".btnAddCart").css("pointer-events", "none");
                        $(".btnAddCart").css("background-color", "#d9d9d9");
                        $("#ddlpurpose").val("Select Visitor Type");
                        $("#txtvisitdate").val("");
                        $("#txtstarttime").val("09:00");
                        $("#txtendtime").val("18:00");
                        $('#ddllocationlist').val("0");
                        $('#ddllocationlist').trigger('change');
                        $("#txthostID").val("");
                        $("#fade").hide();
                        $("#modal").hide();
                        //for (var k = 0; k < LocationCount; k++) {
                        //    k = parseInt(k) + 1;
                        $(".divLocationdetails").remove();
                        //}
                        $("#AddMoreLocation").attr("onclick", "AddExtraLocation(0)");
                        $("#AddMoreLocation").css("margin-left", "127px");
                    }
                },
                error: function (result) {
                    $("#fade").hide();
                    $("#modal").hide();

                }
            });
            document.getElementById("hdnCartID").value = "";
            $("#txtSerachbox").removeAttr("disabled");
            $("#btnSearch").removeAttr("disabled");
            document.getElementById("hdnnewvisitor").value = ""
            $("#tdDeleteall").html("EDIT");
            $("#btnNewVisitor").css("background-color", "#d9d9d9");
            $("#btnNewVisitor").removeAttr("onclick");
            $("#btnNewVisitor").attr("title", "Please select the visitor type to add a new visitor.");
        }
    }
    document.getElementById("Confirmmessage").style.display = "none";
    $("#btnYesdelete").removeAttr("onclick");
}

function DeleteData(VisitorID, RequestID) {
    document.getElementById("Confirmmessage").style.display = "block";
    $("#btnYesdelete").attr("onclick", "YesDelete(" + VisitorID + "," + RequestID + ",'ViewCancel')");
    $("#Confirmmessagebody").html("Are you sure you want to cancel this request ?");
}

function sortTable(n) {
    var table, rows, switching, i, x, y, shouldSwitch, dir, switchcount = 0;
    table = document.getElementById("tblRecentvisitor");
    switching = true;
    dir = "asc";
    while (switching) {
        switching = false;
        rows = table.getElementsByTagName("TR");
        for (i = 1; i < (rows.length - 1); i++) {
            shouldSwitch = false;
            x = rows[i].getElementsByTagName("TD")[n];
            y = rows[i + 1].getElementsByTagName("TD")[n];
            if (dir == "asc") {
                if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
                    $("#" + n).css("background", "url(images/New%20Images/VMS-Icons.png) no-repeat -423px -232px");
                    shouldSwitch = true;
                    break;
                }
            } else if (dir == "desc") {
                if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
                    $("#" + n).css("background", "url(images/New%20Images/VMS-Icons.png) no-repeat -403px -232px");
                    shouldSwitch = true;
                    break;
                }
            }
        }
        if (shouldSwitch) {
            rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
            switching = true;
            switchcount++;
        } else {
            if (switchcount == 0 && dir == "asc") {
                dir = "desc";
                switching = true;
            }
        }
    }
}

function SubmitRequestDetails() {
    $("#fade").show();
    $("#modal").show();
    var Isconfidance = document.getElementById("Confidential").checked;
    if (Isconfidance == true) {
        Isconfidance = "1";
    }
    else {
        Isconfidance = "0";
    }
    $.ajax({
        type: "POST",
        url: "HomePage.aspx/InsertAllDetails",
        contentType: "application/json;charset=utf-8",
        data: '{"isconfidance":"' + Isconfidance + '"}',
        dataType: "json",
        success: function (data) {
            debugger;
            if (data.d == "fail") {
                $("#spnerrorspan").text("* Error : Duplicate Entry. Request not submitted");
                $("#spnerror").show();
                $("#fade").hide();
                $("#modal").hide();
                var Cartmodal = document.getElementById('CardModel');
                Cartmodal.style.display = "none";
                var SucessModel = document.getElementById('SucessModel');
                SucessModel.style.display = "none";
                return false;
            }
            else {
                debugger;
                var Cartmodal = document.getElementById('CardModel');
                var SucessModel = document.getElementById('SucessModel');
                Cartmodal.style.display = "none";
                SucessModel.style.display = "block";
                $("#spnerror").hide();
                $(".editimage").hide();
                $(".cancelimage").hide();
                $(".divLocationdetails").remove();
                document.getElementById("ddlpurpose").value = 0;
                $("#txtvisitdate").datepicker('update', '');
                $("#txtstarttime").val("09:00");
                $("#txtendtime").val("18:00");
                $("#txthostID").val("");
                $("#ddllocationlist").val("0");
                $("#ddllocationlist").trigger("change");
                $(".Dataccessdiv").hide();
                $("#txthostID").hide();
                $("#divhostID").hide();
                $("#btnNewVisitor").css("background-color", "#d9d9d9");
                $("#btnNewVisitor").removeAttr("onclick");
                LocationCount = 0;
                $.ajax({
                    type: "POST",
                    url: "HomePage.aspx/GetRecentVisitors",
                    contentType: "application/json;charset=utf-8",
                    data: "{'visitorCount':" + parseInt("9") + "}",
                    dataType: "json",
                    success: function (data) {

                        if (data.d == "" || data.d == null || data.d == undefined) {
                            $("#RecentVisitortablebody").html("<tr style='height:395px;'><td></td><td></td><td></td><td style='width:210px;color:#596679;font:14px Arial-Regular;'>No Recent Visitors Found</td><td></td><td></td><td></td></tr>");
                            $("#tblRecentvisitor tbody td").css("border", "none");
                            $("#tblRecentvisitor thead td").css("border", "2px solid #dfe9f4");
                            $("#fade").hide();
                            $("#modal").hide();
                        }
                        else {
                            var Recentdata = JSON.parse(data.d);
                            var RecentData_append = "";
                            if (Recentdata.length > 0) {
                                for (var i = 0; i < Recentdata.length; i++) {
                                    if (i % 2 == 0) {
                                        RecentData_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Recentdata[i].VisitorId + "'>";
                                    }
                                    else {
                                        RecentData_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Recentdata[i].VisitorId + "'>";
                                    }
                                    RecentData_append += "<td style='width:44px;text-align:center;'>";
                                    RecentData_append += "<input type='checkbox' value='" + Recentdata[i].VisitorId + "' class='dataaccesscheckbox' id='tdchkselect" + Recentdata[i].VisitorId + "' onchange='UserSelectChange(" + Recentdata[i].VisitorId + ")'>";
                                    RecentData_append += "</td>";
                                    RecentData_append += "<td class='Recentvisitortabletd' style='width:168px;'>";
                                    RecentData_append += "<input type='text' maxlength='25' id='tdtxtvisitorName" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].VisitorFullName + "' disabled />";
                                    RecentData_append += "</td>";
                                    RecentData_append += "<td class='Recentvisitortabletd' style='width:215px;'>";
                                    var Mobile = Recentdata[i].MobileNo.split('-');
                                    RecentData_append += "<select type='text' id='tdtxtCountryCode" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' style='width:28px;' disabled ><option>" + Mobile[0] + "</option></select>-<input id='tdtxtmobileno" + Recentdata[i].VisitorId + "' style='margin-left:0%;width:73px;' maxlength='10' onkeypress='return isNumberKey(event)' onfocusout='return isvalidmobile(" + Recentdata[i].VisitorId + ")' class='Recentvisitortabletextbox' type='text' value='" + Mobile[1] + "' disabled />";
                                    RecentData_append += "</td>";
                                    RecentData_append += "<td class='Recentvisitortabletd' style='width:150px;'>";
                                    RecentData_append += "<input type='text' maxlength='25' id='tdtxtcompany" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].Company + "' disabled />";
                                    RecentData_append += "</td>";
                                    RecentData_append += "<td class='Recentvisitortabletd' style='width:158px;'>";
                                    RecentData_append += "<select type='text' id='tdtxtvisitortype" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' disabled ><option>" + Recentdata[i].VisitorType + "</option></select>";
                                    RecentData_append += "</td>";

                                    RecentData_append += "<td class='Recentvisitortabletd' style='width:120px;'>";
                                    if (Recentdata[i].PermitITEquipments == true) {
                                        RecentData_append += "<a title='Please click here to add equipment details' id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#00b140;cursor:pointer;text-decoration:underline;' onclick='OpenEquipment(" + Recentdata[i].VisitorId + ",0)' name='" + Recentdata[i].VisitorId + "'>Yes</a>";
                                    }
                                    else {
                                        RecentData_append += "<a title='Please click here to add equipment details' id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#596679;cursor:pointer;' name='0'>No</a>";
                                    }
                                    RecentData_append += "</td>";
                                    RecentData_append += "<td style='width:48px;text-align:center;'>";
                                    RecentData_append += "<img id='tdimgsave" + Recentdata[i].VisitorId + "' title='Save this Data' src='images/New%20Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;  background: url(images/New%20Images/VMS-Icons.png) no-repeat -37px -235px;' onclick='SaveTableRow(" + Recentdata[i].VisitorId + ")' />";
                                    RecentData_append += "<img id='tdimgcancel" + Recentdata[i].VisitorId + "' title='Go back' src='images/New%20Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;  background: url(images/New%20Images/VMS-Icons.png) no-repeat -288px -163px;' onclick='CancelTableRow(" + Recentdata[i].VisitorId + ")' />";
                                    RecentData_append += "<img id='tdimgedit" + Recentdata[i].VisitorId + "' title='Edit this data' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;' onclick='EditTableRow(" + Recentdata[i].VisitorId + ")' />";
                                    RecentData_append += "</td>";
                                    RecentData_append += "</tr >";
                                }
                                $("#RecentVisitortablebody").html(RecentData_append);
                                $('.divRecentvisitor').slimScroll({
                                    height: '432px',
                                    width: '100%'
                                });
                            }
                            $.ajax({
                                type: "POST",
                                url: "HomePage.aspx/GetVisitorCart",
                                contentType: "application/json;charset=utf-8",
                                data: '{}',
                                dataType: "json",
                                async: true,
                                success: function (data) {
                                    var Cart = JSON.parse(data.d);
                                    var Cart_append = "";
                                    $("#spncartcount").text("(0)");
                                    if (Cart.length > 0) {
                                        $(".btnPreviewSubmit").css("background-color", "#00b140");
                                        $(".btnPreviewSubmit").removeAttr("disabled");
                                        $("#spncartcount").css("color", "#d9d9d9");
                                        $(".CartImg").css("background", "url('.../../images/New Images/VMS-Icons.png') no-repeat -192px -289px");
                                    }
                                    for (var i = 0; i < Cart.length; i++) {
                                        $("#spncartcount").text("(" + (i + 1) + ")");
                                        $("#spncartcount").css("color", "#00b140");
                                        $(".CartImg").css("background", "url('.../../images/New Images/VMS-Icons.png') no-repeat -192px -228px");
                                        if (parseInt(Cart[i].Ismultilocation) == 0) {
                                            if (i % 2 == 0) {
                                                Cart_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Cart[i].CartID + "'>";
                                            }
                                            else {
                                                Cart_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Cart[i].CartID + "'>";
                                            }
                                            Cart_append += "<td class='Recentvisitortabletd' style='color:#0033a0;font:14px Arial-Bold;padding-left:15px;' title=\"" + Cart[i].VisitorName + "\">";
                                            if (parseInt(Cart[i].isDatacenterAccess) == 0) {
                                                Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "";
                                            }
                                            else {
                                                Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "<img src='images/New%20Images/img_trans.gif' style='background:url(images/New%20Images/VMS-Icons.png) no-repeat -452px -232px;height:21px;margin-left:4px;margin-top:3%;' />";
                                            }
                                            Cart_append += "</td>";
                                            Cart_append += "<td class='Recentvisitortabletd' title=\"" + Cart[i].LocationName + "\">";
                                            Cart_append += "" + Cart[i].LocationName.slice(0, parseInt(15)) + (Cart[i].LocationName.length > parseInt(15) ? "..." : "") + "";
                                            Cart_append += "</td>";
                                            Cart_append += "<td class='Recentvisitortabletd' style='width:18%;' title='" + Cart[i].HostID + "'>";
                                            Cart_append += "" + Cart[i].HostID.slice(0, parseInt(15)) + (Cart[i].HostID.length > parseInt(15) ? "..." : "" + "") + "";
                                            Cart_append += "</td>";
                                            Cart_append += "<td  class='Recentvisitortabletd' style='width:37%;' title=" + Cart[i].Date + ">";
                                            var Splitdate = Cart[i].Date.split(',');
                                            if (Splitdate.length == 1) {
                                                ConcaSpt = Splitdate;
                                            }
                                            else {
                                                var ConcaSpt = "";
                                                for (var w = 0; w < Splitdate.length; w++) {
                                                    var splitsingledata = Splitdate[w].split('/');
                                                    ConcaSpt += splitsingledata[0] + "/" + splitsingledata[1] + ",";
                                                }
                                                ConcaSpt = ConcaSpt.slice(0, -1);
                                            }

                                            // var spltfrom = Splitdate[0];
                                            //var spltto = Splitdate[Splitdate.length - 1];

                                            //if (spltfrom == spltto) {
                                            //  ConcaSpt = Splitdate;
                                            //}
                                            //else {
                                            //  ConcaSpt = spltfrom + " to " + spltto;
                                            // }

                                            Cart_append += "" + ConcaSpt.slice(0, parseInt(20)) + (ConcaSpt.length > parseInt(20) ? "..." : "") + " " + "-" + " " + Cart[i].FromTime + " " + "to" + " " + Cart[i].ToTime + "<br/>";
                                            //}
                                            Cart_append += "</td>";
                                            Cart_append += "<td style='text-align:center;'>";
                                            Cart_append += "<img class='editimage' title='Edit cart details' id='tdimgedit" + Cart[i].CartID + "' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;' onclick='EditCart(" + Cart[i].CartID + ")' />";
                                            Cart_append += "<img class='cancelimage' title='Delete request from cart' id='tdimgcancel" + Cart[i].CartID + "' src='images/New Images/img_trans.gif' style='height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -203px -94px;margin-left:4%;cursor:pointer;' onclick='DeleteCart(" + Cart[i].CartID + ")' />";
                                            Cart_append += "</td>";
                                            Cart_append += "</tr >";
                                        }
                                        else {
                                            if (i % 2 == 0) {
                                                Cart_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Cart[i].CartID + "'>";
                                            }
                                            else {
                                                Cart_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Cart[i].CartID + "'>";
                                            }
                                            Cart_append += "<td class='Recentvisitortabletd' style='color:#0033a0;font:14px Arial-Bold;padding-left:15px;' title=\"" + Cart[i].VisitorName + "\">";
                                            if (parseInt(Cart[i].isDatacenterAccess) == 0) {
                                                Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "";
                                            }
                                            else {
                                                Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "<img src='images/New%20Images/img_trans.gif' style='background:url(images/New%20Images/VMS-Icons.png) no-repeat -452px -232px;height:21px;margin-left:4px;margin-top:3%;' />";
                                            }
                                            Cart_append += "</td>";
                                            Cart_append += "<td class='Recentvisitortabletd' title=\"" + Cart[i].LocationName + "\">";
                                            Cart_append += "" + Cart[i].LocationName.slice(0, parseInt(15)) + (Cart[i].LocationName.length > parseInt(15) ? "..." : "") + "";
                                            Cart_append += "</td>";
                                            Cart_append += "<td class='Recentvisitortabletd' style='width:18%;' title='" + Cart[i].HostID + "'>";
                                            Cart_append += "" + Cart[i].HostID.slice(0, parseInt(15)) + (Cart[i].HostID.length > parseInt(15) ? "..." : "" + "") + "";
                                            Cart_append += "</td>";
                                            Cart_append += "<td  class='Recentvisitortabletd' style='width:37%;' title=" + Cart[i].Date + ">";
                                            var Splitdate = Cart[i].Date.split(',');
                                            if (Splitdate.length == 1) {
                                                ConcaSpt = Splitdate;
                                            }
                                            else {
                                                var ConcaSpt = "";
                                                for (var w = 0; w < Splitdate.length; w++) {
                                                    var splitsingledata = Splitdate[w].split('/');
                                                    ConcaSpt += splitsingledata[0] + "/" + splitsingledata[1] + ",";
                                                }
                                                ConcaSpt = ConcaSpt.slice(0, -1);
                                            }

                                            // var spltfrom = Splitdate[0];
                                            //var spltto = Splitdate[Splitdate.length - 1];

                                            //if (spltfrom == spltto) {
                                            //  ConcaSpt = Splitdate;
                                            //}
                                            //else {
                                            //  ConcaSpt = spltfrom + " to " + spltto;
                                            // }

                                            Cart_append += "" + ConcaSpt.slice(0, parseInt(20)) + (ConcaSpt.length > parseInt(20) ? "..." : "") + " " + "-" + " " + Cart[i].FromTime + " " + "to" + " " + Cart[i].ToTime + "<br/>";
                                            //}}
                                            Cart_append += "</td>";
                                            Cart_append += "<td style='text-align:center;'>";
                                            Cart_append += "<img class='editimage' title='Show multiple locations' id='tdimgmultiple" + Cart[i].CartID + "' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -118px -95px;cursor:pointer;margin-left:-21px;' onclick='OpenMultiple(" + Cart[i].CartID + ")' />";
                                            Cart_append += "<img class='editimage' title='Edit this cart details' id='tdimgedit" + Cart[i].CartID + "' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;margin-left:3%;' onclick='EditCart(" + Cart[i].CartID + ")' />";
                                            Cart_append += "<img class='cancelimage' title='Delete this request from Cart' id='tdimgcancel" + Cart[i].CartID + "' src='images/New Images/img_trans.gif' style='height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -203px -94px;margin-left:4%;cursor:pointer;' onclick='DeleteCart(" + Cart[i].CartID + ")' />";
                                            Cart_append += "</td>";
                                            Cart_append += "</tr >";
                                            for (var m = 0; m < Cart[i].LocationCount; m++) {
                                                Cart_append += "<tr class='Recentvisitortablebodytrodd' style='display:none;' id='" + m + "Multipletr" + Cart[i].CartID + "'>";
                                                Cart_append += "</tr>";
                                            }
                                        }
                                    }
                                    $("#tbodycart").html(Cart_append);
                                },
                                error: function (result) {
                                    $("#fade").hide();
                                    $("#modal").hide();
                                }
                            });
                        }


                    },
                    error: function (result) {
                        $("#fade").hide();
                        $("#modal").hide();

                    }
                });
                var CurrentLocation = document.getElementById("hdnLocationCode").value;
                $('#ddllocationlist').val(CurrentLocation);
                $('#ddllocationlist').trigger('change');
                $("#fade").hide();
                $("#modal").hide();
            }
        },
        error: function (result) {
            $("#fade").hide();
            $("#modal").hide();

        }
    });
    document.getElementById("ddlpurpose").value = "0";
    $('#ddlpurpose').css("border", "1px solid #0033a0");
    $('#ddllocationlist').val("0");
    $('#ddllocationlist').trigger('change');
    $('#sandbox-container input').datepicker('update', '');
    //var fromNow = new Date();
    //var minutes = 5;
    //var hour = 3
    //fromNow.setMinutes(fromNow.getMinutes() + minutes);
    //var fromhour = fromNow.getHours();
    //var fromminute = fromNow.getMinutes();
    //var toNow = new Date();
    //toNow.setHours(toNow.getHours() + hour);
    //toNow.setMinutes(toNow.getMinutes() + minutes);
    //var tohour = toNow.getHours();
    //var tominute = toNow.getMinutes();
    //var frommin = 0;
    //var tomin = 0;

    //if (fromminute >= 0 && fromminute < 15) {
    //    fromNow.setMinutes(fromNow.getMinutes() + (15 - fromminute));
    //    toNow.setMinutes(15);
    //}
    //else if (fromminute >= 15 && fromminute < 30) {
    //    fromNow.setMinutes(fromNow.getMinutes() + (30 - fromminute));
    //    toNow.setMinutes(30);
    //}
    //else if (fromminute >= 30 && fromminute < 45) {
    //    fromNow.setMinutes(fromNow.getMinutes() + (45 - fromminute));
    //    toNow.setMinutes(45);
    //}
    //else {
    //    fromNow.setMinutes(fromNow.getMinutes() + (60 - fromminute));
    //    toNow.setMinutes(45 + 15)//// Need to test this when the user opens the request between 45 - 59 minutes
    //}
    //var ampm = (fromhour >= 12) ? 'PM' : 'AM';
    //fromhour = fromhour % 12;
    //fromhour = fromhour ? fromhour : 12;
    //fromhour = fromhour < 10 ? '0' + fromhour : fromhour;
    //fromminute = fromminute < 10 ? '0' + fromminute : fromminute;
    //var time = appendZero(fromNow.getHours(), 2) + ':' + appendZero(fromNow.getMinutes(), 2);
    //var ampm1 = (tohour >= 12) ? 'PM' : 'AM';
    //tohour = tohour % 12;
    //tohour = tohour ? tohour : 12;
    //tohour = tohour < 10 ? '0' + tohour : tohour;
    //tominute = tominute < 10 ? '0' + tominute : tominute;
    //var time1 = appendZero(toNow.getHours(), 2) + ':' + appendZero(toNow.getMinutes(), 2);

    $("#txtstarttime").val("09:00");
    $("#txtendtime").val("18:00");
    $("#txthostID").val("");
    $("#txthostID").hide();
    $("#divhostID").hide();
    //$('#sandbox-container input').css("border", "1px solid #d6d6d6");
    //$("#txthostID").css("border", "1px solid #d6d6d6");
    $(".Recentvisitortableaftertextbox").css("border", "1px solid #d6d6d6");
    $("#spnerror").hide();
    //document.getElementById("dataccess").checked = false;
    $(".btnAddCart").css("pointer-events", "none");
    $(".btnAddCart").css("background-color", "#d9d9d9");
    //for (var k = 0; k < LocationCount; k++) {
    //    k = parseInt(k) + 1;close
    $(".divLocationdetails").remove();
    //}
    $("#txtothers").hide();
    $("#divtxtothers").hide();
    $("#AddMoreLocation").attr("onclick", "AddExtraLocation(0)");
    $("#AddMoreLocation").css("margin-left", "127px");
    //$("#btnSearch").text("Search");
    $("#txtSerachbox").val("");
    $(".btnPreviewSubmit").css("background-color", "#d9d9d9");
    $(".btnPreviewSubmit").attr("disabled", "disabled");
}

//function SavecartTableRow(ID) {
//    $("#fade").show();
//    $("#modal").show();
//    var MobileNo = $("#tdtxtCountryCode" + ID).val() + '-' + $("#tdtxtmobileno" + ID).val();
//    if (MobileNo == "" || MobileNo == null || MobileNo == undefined) {
//        $("#spnerror").text("*Error : Enter Mobile Number");
//        $("#tdtxtmobileno" + ID).css('border-color', '#f4633a');
//        $("#spnerror").show();
//        $("#fade").hide();
//        $("#modal").hide();
//        return false;
//    }
//    var code = $("#tdtxtCountryCode" + ID).val();
//    var mob = $("#tdtxtmobileno" + ID).val();
//    if (code == "+91") {
//        if (mob.length < 10 || mob.length > 10) {
//            $("#spnerror").text("*Error : Enter Valid Mobile Number");
//            $("#tdtxtmobileno" + ID).css('border-color', '#f4633a');
//            $("#spnerror").show();
//            $("#fade").hide();
//            $("#modal").hide();
//            return false;
//        }
//    }
//    var Name = $("#tdtxtvisitorName" + ID).val();
//    if (Name == "" || Name == null || Name == undefined) {
//        $("#spnerror").text("*Error : Enter Name");
//        $("#tdtxtvisitorName").css('border-color', '#f4633a');
//        $("#spnerror").show();
//        $("#fade").hide();
//        $("#modal").hide();
//        return false;
//    }
//    var Organization = $("#tdtxtcompany" + ID).val();
//    if (Organization == "" || Organization == null || Organization == undefined) {
//        $("#spnerror").text("*Error : Enter organization");
//        $("#tdtxtcompany").css('border-color', '#f4633a');
//        $("#spnerror").show();
//        $("#fade").hide();
//        $("#modal").hide();
//        return false;
//    }
//    var LocationNamedrop = document.getElementById("tdtxtvisitortype" + ID);
//    var LocationName = LocationNamedrop.options[LocationNamedrop.selectedIndex].text;
//    if (LocationName == "Visitor Type") {
//        $("#spnerror").text("*Error : Select Visitor Type");
//        $("#tdtxtvisitortype" + ID).css('border-color', '#f4633a');
//        $("#spnerror").show();
//        return false;
//    }
//    var IsEquipmentcheck = $("#tdaequipment" + ID).text();
//    var IsEquipment = "";
//    if (IsEquipmentcheck == "Yes") {
//        IsEquipment = "1";
//    }
//    else if (IsEquipmentcheck == "No") {
//        IsEquipment = "0";
//    }
//    else {
//        IsEquipment = "0";
//    }
//    $.ajax({
//        type: "POST",
//        url: "HomePage.aspx/UpdateCartProfildetails",
//        contentType: "application/json;charset=utf-8",
//        data: '{"visitorType":"' + LocationName + '","mobileNo":"' + MobileNo + '","name":"' + Name + '","organization":"' + Organization + '","isEquipment":"' + IsEquipment + '","cartID":"' + ID + '"}',
//        dataType: "json",
//        success: function (data) {            
//            var Cart = JSON.parse(data.d);
//            var Cart_append = "";
//            if (Cart.length > 0) {
//                $(".btnAddCart").css("background-color", "#00b140");
//                $(".btnAddCart").css("pointer-events", "visible");
//                $(".btnPreviewSubmit").css("background-color", "#00b140");
//                $(".btnPreviewSubmit").removeAttr("disabled");
//                $("#spncartcount").css("color", "#d9d9d9");
//                $(".CartImg").css("background", "url('../../images/New Images/VMS-Icons.png') no-repeat -192px -289px");
//            }
//            for (var i = 0; i < Cart.length; i++) {
//                $("#spncartcount").text("(" + (i + 1) + ")");
//                $("#spncartcount1").text((i + 1));
//                $("#spncartcount").css("color", "#00b140");
//                $(".CartImg").css("background", "url('../../images/New Images/VMS-Icons.png') no-repeat -192px -228px");
//                if (parseInt(Cart[i].Ismultilocation) == 0) {
//                    if (i % 2 == 0) {
//                        Cart_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Cart[i].CartID + "'>";
//                    }
//                    else {
//                        Cart_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Cart[i].CartID + "'>";
//                    }
//                    Cart_append += "<td class='Recentvisitortabletd' style='color:#0033a0;font:14px Proxima-Nova-Bold;padding-left:15px;' title=\"" + Cart[i].VisitorName + "\">";
//                    if (parseInt(Cart[i].isDatacenterAccess) == 0) {
//                        Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "";
//                    }
//                    else {
//                        Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "<img src='images/New%20Images/img_trans.gif' style='background:url(images/New%20Images/VMS-Icons.png) no-repeat -452px -232px;height:21px;margin-left:4px;margin-top:3%;' />";
//                    }
//                    Cart_append += "</td>";
//                    Cart_append += "<td class='Recentvisitortabletd' title=\"" + Cart[i].LocationName + "\">";
//                    Cart_append += "" + Cart[i].LocationName.slice(0, parseInt(15)) + (Cart[i].LocationName.length > parseInt(15) ? "..." : "") + "";
//                    Cart_append += "</td>";
//                    Cart_append += "<td class='Recentvisitortabletd' style='width:18%;' title='" + Cart[i].HostID + "'>";
//                    if (Cart[i].HostID != "" && Cart[i].HostID != undefined && Cart[i].HostID != null) {
//                        Cart_append += "" + Cart[i].HostID.slice(0, parseInt(15)) + (Cart[i].HostID.length > parseInt(15) ? "..." : "" + "") + "";
//                    }
//                    Cart_append += "</td>";
//                    Cart_append += "<td  class='Recentvisitortabletd' style='width:37%;' title=" + Cart[i].Date + ">";
//                    var Splitdate = Cart[i].Date.split(',');
//                    if (Splitdate.length == 1) {
//                        ConcaSpt = Splitdate;
//                    }
//                    else {
//                        var ConcaSpt = "";
//                        for (var w = 0; w < Splitdate.length; w++) {
//                            var splitsingledata = Splitdate[w].split('/');
//                            ConcaSpt += splitsingledata[0] + "/" + splitsingledata[1] + ",";
//                        }
//                        ConcaSpt = ConcaSpt.slice(0, -1);
//                    }

//                    // var spltfrom = Splitdate[0];
//                    //var spltto = Splitdate[Splitdate.length - 1];

//                    //if (spltfrom == spltto) {
//                    //  ConcaSpt = Splitdate;
//                    //}
//                    //else {
//                    //  ConcaSpt = spltfrom + " to " + spltto;
//                    // }

//                    Cart_append += "" + ConcaSpt.slice(0, parseInt(20)) + (ConcaSpt.length > parseInt(20) ? "..." : "") + " " + "-" + " " + Cart[i].FromTime + " " + "to" + " " + Cart[i].ToTime + "<br/>";
//                    //}
//                    Cart_append += "</td>";
//                    Cart_append += "<td style='text-align:center;'>";
//                    Cart_append += "<img class='editimage' title='Edit cart' id='tdimgedit" + Cart[i].CartID + "' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;' onclick='EditCart(" + Cart[i].CartID + ")' />";
//                    Cart_append += "<img class='cancelimage' title='Delete request from cart' id='tdimgcancel" + Cart[i].CartID + "' src='images/New Images/img_trans.gif' style='height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -203px -94px;cursor:pointer;margin-left:4%;' onclick='DeleteCart(" + Cart[i].CartID + ")' />";
//                    Cart_append += "</td>";
//                    Cart_append += "</tr >";
//                }
//                else {
//                    if (i % 2 == 0) {
//                        Cart_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Cart[i].CartID + "'>";
//                    }
//                    else {
//                        Cart_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Cart[i].CartID + "'>";
//                    }
//                    Cart_append += "<td class='Recentvisitortabletd' style='color:#0033a0;font:14px Proxima-Nova-Bold;padding-left:15px;' title=\"" + Cart[i].VisitorName + "\">";
//                    if (parseInt(Cart[i].isDatacenterAccess) == 0) {
//                        Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "";
//                    }
//                    else {
//                        Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "<img src='images/New%20Images/img_trans.gif' style='background:url(images/New%20Images/VMS-Icons.png) no-repeat -452px -232px;height:21px;margin-left:4px;margin-top:3%;' />";
//                    }
//                    Cart_append += "</td>";
//                    Cart_append += "<td class='Recentvisitortabletd' title=\"" + Cart[i].LocationName + "\">";
//                    Cart_append += "" + Cart[i].LocationName.slice(0, parseInt(15)) + (Cart[i].LocationName.length > parseInt(15) ? "..." : "") + "";
//                    Cart_append += "</td>";
//                    Cart_append += "<td class='Recentvisitortabletd' style='width:18%;' title='" + Cart[i].HostID + "'>";
//                    if (Cart[i].HostID != "" && Cart[i].HostID != undefined && Cart[i].HostID != null) {
//                        Cart_append += "" + Cart[i].HostID.slice(0, parseInt(15)) + (Cart[i].HostID.length > parseInt(15) ? "..." : "" + "") + "";
//                    }
//                    Cart_append += "</td>";
//                    Cart_append += "<td  class='Recentvisitortabletd' style='width:37%;' title=" + Cart[i].Date + ">";
//                    var Splitdate = Cart[i].Date.split(',');
//                    if (Splitdate.length == 1) {
//                        ConcaSpt = Splitdate;
//                    }
//                    else {
//                        var ConcaSpt = "";
//                        for (var w = 0; w < Splitdate.length; w++) {
//                            var splitsingledata = Splitdate[w].split('/');
//                            ConcaSpt += splitsingledata[0] + "/" + splitsingledata[1] + ",";
//                        }
//                        ConcaSpt = ConcaSpt.slice(0, -1);
//                    }

//                    // var spltfrom = Splitdate[0];
//                    //var spltto = Splitdate[Splitdate.length - 1];

//                    //if (spltfrom == spltto) {
//                    //  ConcaSpt = Splitdate;
//                    //}
//                    //else {
//                    //  ConcaSpt = spltfrom + " to " + spltto;
//                    // }

//                    Cart_append += "" + ConcaSpt.slice(0, parseInt(20)) + (ConcaSpt.length > parseInt(20) ? "..." : "") + " " + "-" + " " + Cart[i].FromTime + " " + "to" + " " + Cart[i].ToTime + "<br/>";
//                    //}
//                    Cart_append += "</td>";
//                    Cart_append += "<td style='text-align:center;'>";
//                    Cart_append += "<img class='editimage' id='tdimgmultiple" + Cart[i].CartID + "' title='Expand' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -118px -95px;cursor:pointer;margin-left:-21px;' onclick='OpenMultiple(" + Cart[i].CartID + ")' />";
//                    Cart_append += "<img class='editimage' id='tdimgedit" + Cart[i].CartID + "' title='Edit' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;margin-left:3%;' onclick='EditCart(" + Cart[i].CartID + ")' />";
//                    Cart_append += "<img class='cancelimage' id='tdimgcancel" + Cart[i].CartID + "' title='Cancel' src='images/New Images/img_trans.gif' style='height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -203px -94px;margin-left:4%;cursor:pointer;' onclick='DeleteCart(" + Cart[i].CartID + ")' />";
//                    Cart_append += "</td>";
//                    Cart_append += "</tr >";
//                    for (var m = 0; m < Cart[i].LocationCount; m++) {
//                        Cart_append += "<tr class='Recentvisitortablebodytrodd' style='display:none;' id='" + m + "Multipletr" + Cart[i].CartID + "'>";
//                        Cart_append += "</tr>";
//                    }
//                }
//                $("#tr" + Cart[i].CartID).css("background-color", "rgb(227, 238, 242)");
//            }
//            $("#tbodycart").html(Cart_append);
//            $("#tbodycart1").html(Cart_append);
//            $("#tdtxtCountryCode" + ID).removeClass("Recentvisitortableaftertextbox");
//            $("#tdtxtCountryCode" + ID).addClass("Recentvisitortabletextbox");
//            $("#tdtxtmobileno" + ID).removeClass("Recentvisitortableaftertextbox");
//            $("#tdtxtmobileno" + ID).addClass("Recentvisitortabletextbox");
//            $("#tdtxtvisitorName" + ID).removeClass("Recentvisitortableaftertextbox");
//            $("#tdtxtvisitorName" + ID).addClass("Recentvisitortabletextbox");
//            $("#tdtxtcompany" + ID).removeClass("Recentvisitortableaftertextbox");
//            $("#tdtxtcompany" + ID).addClass("Recentvisitortabletextbox");
//            $("#tdtxtvisitortype" + ID).removeClass("Recentvisitortableaftertextbox");
//            $("#tdtxtvisitortype" + ID).addClass("Recentvisitortabletextbox");
//            $('#tdchkeuipment' + ID).attr('disabled', 'disabled');
//            $("#fade").hide();
//            $("#modal").hide();
//        },
//        error: function (result) {
//            $("#fade").hide();
//            $("#modal").hide();
//        }
//    });
//}

function HostIDfocus(ID) {
    var Visitordrop = document.getElementById("ddlpurpose");
    var VisitorType = Visitordrop.options[Visitordrop.selectedIndex].text;
    if (ID == "" || ID == null || ID == undefined) {
        var LocationNamedrop = document.getElementById("ddllocationlist");
        var LocationName = LocationNamedrop.options[LocationNamedrop.selectedIndex].text;
        var indexlocation = LocationName.indexOf("IND");
        var HostId = $("#txthostID").val();
        if (VisitorType == "Client" && indexlocation >= 0) {
            if (HostId == "" || HostId == null || HostId == undefined) {
                $("#Hostspnerrorspan").text("Enter Host ID");
                $("#Hostspnerror").show();
                $("#txthostID").css('border-color', '#f4633a');
                $(".divLocationdetails1").css("max-height", "339px");
                $("#fade").hide();
                $("#modal").hide();
                return false;
            }
            else {
                $("#txthostID").css('border-color', '#d6d6d6');
                $("#Hostspnerror").hide();
                $(".divLocationdetails1").css("max-height", "321px");
            }
            var hastindex = HostId.indexOf('(');
            if (hastindex < 0) {
                $("#Hostspnerrorspan").text("Enter valid Host ID");
                $("#Hostspnerror").show();
                $("#txthostID").css('border-color', '#f4633a');
                $(".divLocationdetails1").css("max-height", "339px");
                $("#fade").hide();
                $("#modal").hide();
                return false;
            }
            else {
                $("#txthostID").css('border-color', '#d6d6d6');
                $("#Hostspnerror").hide();
                $(".divLocationdetails1").css("max-height", "321px");
            }
        }
    }
    else {
        var LocationNamedrop1 = document.getElementById("ddllocationlist" + ID);
        var LocationName1 = LocationNamedrop1.options[LocationNamedrop1.selectedIndex].text;
        var indexlocation = LocationName1.indexOf("IND");
        var HostId = $("#txthostID" + ID).val();
        if (VisitorType == "Client" && indexlocation >= 0) {
            if (HostId == "" || HostId == null || HostId == undefined) {
                $("#Hostspnerrorspan" + ID).text("Enter Host ID");
                $("#Hostspnerror" + ID).show();
                $("#txthostID" + ID).css('border-color', '#f4633a');
                $(".divLocationdetails").css("max-height", "339px");
                $("#fade").hide();
                $("#modal").hide();
                return false;
            }
            else {
                $("#txthostID" + ID).css('border-color', '#d6d6d6');
                $("#Hostspnerror" + ID).hide();
                $(".divLocationdetails").css("max-height", "321px");
            }
            var hastindex = HostId.indexOf('(');
            if (hastindex < 0) {
                $("#Hostspnerrorspan" + ID).text("Enter valid Host ID");
                $("#Hostspnerror" + ID).show();
                $("#txthostID" + ID).css('border-color', '#f4633a');
                $(".divLocationdetails").css("max-height", "339px");
                $("#fade").hide();
                $("#modal").hide();
                return false;
            }
            else {
                $("#txthostID" + ID).css('border-color', '#d6d6d6');
                $("#Hostspnerror" + ID).hide();
                $(".divLocationdetails").css("max-height", "321px");
            }
        }
    }
}

function otherfocues() {
    var Visitordrop = document.getElementById("ddlpurpose");
    var VisitorType = Visitordrop.options[Visitordrop.selectedIndex].text;
    var Others = "";
    if (VisitorType == "Others") {
        Others = $("#txtothers").val();
        if (Others == null || Others == "" || Others == undefined) {
            $("#txtothers").css('border-color', '#f4633a');
            $("#Otherspnerror").show();
            $("#fade").hide();
            $("#modal").hide();
            return false;
        }
        else {
            $("#txtothers").css('border-color', '#d6d6d6');
            $("#Otherspnerror").hide();
        }
    }
}

function datefocus(ID) {
    if (ID == "" || ID == null || ID == undefined) {
        var Date = $("#txtvisitdate").val();
        if (Date == "" || Date == null || Date == undefined) {
            $("#txtvisitdate").css("border-color", "#f4633a");
            $("#divimgdate").css("border-color", "#f4633a");
            $(".divLocationdetails1").css("max-height", "339px");
            $("#datespnerror").show();
            $("#fade").hide();
            $("#modal").hide();
            return false;
        }
        else {
            $("#txtvisitdate").css("border-color", "#d6d6d6");
            $("#divimgdate").css("border-color", "#d6d6d6");
            $("#datespnerror").hide();
            $(".divLocationdetails1").css("max-height", "321px");
        }
    }
    else {
        var Date = $("#txtvisitdate" + ID).val();
        if (Date == "" || Date == null || Date == undefined) {
            $("#txtvisitdate" + ID).css("border-color", "#f4633a");
            $("#divimgdate" + ID).css("border-color", "#f4633a");
            $(".divLocationdetails").css("max-height", "339px");
            $("#datespnerror" + ID).show();
            $("#fade").hide();
            $("#modal").hide();
            return false;
        }
        else {
            $("#txtvisitdate" + ID).css("border-color", "#d6d6d6");
            $("#divimgdate" + ID).css("border-color", "#d6d6d6");
            $("#datespnerror" + ID).hide();
            $(".divLocationdetails").css("max-height", "321px");
        }
    }
}

function Addtocart() {
    $("#spnerror").hide();
    $(".Recentvisitortableaftertextbox").css("border", "1px solid #d6d6d6");
    var text = $(".btnAddCart").text();
    if (text == "Cancel") {
        $(".dataaccesscheckbox1").removeAttr("disabled");
        $(".btnAddCart").html("<img src='images/New%20Images/img_trans.gif' class='addtocarticon'>&nbsp; Add to Cart");
        $(".btnAddCart").css("background-color", "#d9d9d9");
        $(".btnAddCart").attr("disabled", "disabled");
        $(".btnAddCart").attr("title", "Add to Cart");
        $(".btnPreviewSubmit").css("background-color", "#d9d9d9");
        $(".btnPreviewSubmit").attr("disabled", "disabled");
        $(".btnPreviewSubmit").text("Preview & Submit");
        $(".btnPreviewSubmit").attr("title", "Preview & Submit");
        $(".btnAddCart").css("pointer-events", "none");
        $(".btnAddCart").css("text-align", "inherit");
        document.getElementById("ddlpurpose").value = "0";
        $("#AddMoreLocation").html("<img src='images/New%20Images/img_trans.gif' class='AddmoreDivimg' /> Add More Location");
        $("#AddMoreLocation").attr("onclick", "AddExtraLocation(0)");
        $("#AddMoreLocation").css("margin-left", "127px");
        $("#txtvisitdate").datepicker('update', '');
        $("#txtstarttime").val("09:00");
        $("#txtendtime").val("18:00");
        $("#ddllocationlist").val("0");
        $("#ddllocationlist").trigger("change");
        $("#txtothers").hide();
        $("#divtxtothers").hide();
        $.ajax({
            type: "POST",
            url: "HomePage.aspx/GetRecentVisitors",
            contentType: "application/json;charset=utf-8",
            data: "{'visitorCount':" + parseInt("9") + "}",
            dataType: "json",
            success: function (data) {
                var RecentData_append = "";
                if (data.d == "" || data.d == null || data.d == undefined) {
                    $("#RecentVisitortablebody").html("<tr style='height:395px;'><td></td><td></td><td></td><td style='width:210px;color:#596679;font:14px Arial-Regular;'>No Recent Visitors Found</td><td></td><td></td><td></td></tr>");
                    $("#tblRecentvisitor tbody td").css("border", "none");
                    $("#tblRecentvisitor thead td").css("border", "2px solid #dfe9f4");
                    $("#fade").hide();
                    $("#modal").hide();
                }
                else {
                    var Recentdata = JSON.parse(data.d);
                    if (Recentdata.length > 0) {
                        for (var i = 0; i < Recentdata.length; i++) {
                            if (i % 2 == 0) {
                                RecentData_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Recentdata[i].VisitorId + "'>";
                            }
                            else {
                                RecentData_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Recentdata[i].VisitorId + "'>";
                            }
                            RecentData_append += "<td style='width:44px;text-align:center;'>";
                            RecentData_append += "<input type='checkbox' value='" + Recentdata[i].VisitorId + "' class='dataaccesscheckbox' id='tdchkselect" + Recentdata[i].VisitorId + "' onchange='UserSelectChange(" + Recentdata[i].VisitorId + ")'>";
                            RecentData_append += "</td>";
                            RecentData_append += "<td class='Recentvisitortabletd' style='width:168px;'>";
                            RecentData_append += "<input type='text' maxlength='25' id='tdtxtvisitorName" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].VisitorFullName + "' disabled />";
                            RecentData_append += "</td>";
                            RecentData_append += "<td class='Recentvisitortabletd' style='width:215px;'>";
                            var Mobile = Recentdata[i].MobileNo.split('-');
                            RecentData_append += "<select type='text' id='tdtxtCountryCode" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' style='width:28px;' disabled ><option>" + Mobile[0] + "</option></select>-<input id='tdtxtmobileno" + Recentdata[i].VisitorId + "' maxlength='10' onkeypress='return isNumberKey(event)' onfocusout='return isvalidmobile(" + Recentdata[i].VisitorId + ")' style='margin-left:0%;width:73px;' class='Recentvisitortabletextbox' type='text' value='" + Mobile[1] + "' disabled />";
                            RecentData_append += "</td>";
                            RecentData_append += "<td class='Recentvisitortabletd' style='width:150px;'>";
                            RecentData_append += "<input type='text' maxlength='25' id='tdtxtcompany" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].Company + "' disabled />";
                            RecentData_append += "</td>";
                            RecentData_append += "<td class='Recentvisitortabletd' style='width:158px;'>";
                            RecentData_append += "<select type='text' id='tdtxtvisitortype" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' disabled ><option>" + Recentdata[i].VisitorType + "</option></select>";
                            RecentData_append += "</td>";

                            RecentData_append += "<td class='Recentvisitortabletd' style='width:120px;'>";
                            if (Recentdata[i].PermitITEquipments == true) {
                                RecentData_append += "<a title='Please click here to add equipment details' id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#00b140;cursor:pointer;text-decoration:underline;' onclick='OpenEquipment(" + Recentdata[i].VisitorId + ",0)' name='" + Recentdata[i].VisitorId + "'>Yes</a>";
                            }
                            else {
                                RecentData_append += "<a title='Please click here to add equipment details' id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#596679;cursor:pointer;' name='0'>No</a>";
                            }
                            RecentData_append += "</td>";
                            RecentData_append += "<td style='width:48px;text-align:center;'>";
                            RecentData_append += "<img id='tdimgsave" + Recentdata[i].VisitorId + "' title='Save' src='images/New%20Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;  background: url(images/New%20Images/VMS-Icons.png) no-repeat -37px -235px;' onclick='SaveTableRow(" + Recentdata[i].VisitorId + ")' />";
                            RecentData_append += "<img id='tdimgcancel" + Recentdata[i].VisitorId + "' title='Cancel' src='images/New%20Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;  background: url(images/New%20Images/VMS-Icons.png) no-repeat -288px -163px;' onclick='CancelTableRow(" + Recentdata[i].VisitorId + ")' />";
                            RecentData_append += "<img id='tdimgedit" + Recentdata[i].VisitorId + "' title='Edit' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;' onclick='EditTableRow(" + Recentdata[i].VisitorId + ")' />";
                            RecentData_append += "</td>";
                            RecentData_append += "</tr >";
                        }
                        $("#RecentVisitortablebody").html(RecentData_append);
                        $('.divRecentvisitor').slimScroll({
                            height: '432px',
                            width: '100%'
                        });
                    }
                    else {
                        $("#fade").hide();
                        $("#modal").hide();
                    }
                }

            },
            error: function (result) {
                $("#fade").hide();
                $("#modal").hide();
            }
        });
    }
    else if (text == "Back") {
        location.href = "NewTrack.aspx";
    }
    else {
        var chkArray = [];
        $(".dataaccesscheckbox:checked").each(function () {
            chkArray.push($(this).val());
        });
        var selected;
        selected = chkArray.join(',');
        var selectedspilt = "";
        if (selected != "" && selected != null && selected != undefined) {
            selectedspilt = selected.split(',');
        }
        if (selectedspilt.length > 0) {
            if (selectedspilt.length <= 20) {
                $("#fade").show();
                $("#modal").show();
                for (var i = 0; i < selectedspilt.length; i++) {
                    var Visitordrop = document.getElementById("ddlpurpose");
                    var VisitorType = Visitordrop.options[Visitordrop.selectedIndex].text;
                    if (VisitorType == "Select Visitor Type") {
                        $("#ddlpurpose").css('border-color', '#f4633a');
                        $("#visitorspnerror").show();
                        $("#fade").hide();
                        $("#modal").hide();
                        return false;
                    }
                    var Others = "";
                    if (VisitorType == "Others") {
                        Others = $("#txtothers").val();
                        if (Others == null || Others == "" || Others == undefined) {
                            $("#txtothers").css('border-color', '#f4633a');
                            $("#Otherspnerror").show();
                            $("#fade").hide();
                            $("#modal").hide();
                            return false;
                        }
                    }

                    var MobileNo = $("#tdtxtCountryCode" + selectedspilt[i] + " option:selected").text() + '-' + $("#tdtxtmobileno" + selectedspilt[i]).val();
                    if (MobileNo == "" || MobileNo == null || MobileNo == undefined) {
                        $("#spnerrorspan").text("Enter Mobile Number");
                        $("#tdtxtmobileno" + selectedspilt[i]).css('border-color', '#f4633a');
                        $("#spnerror").show();
                        $("#fade").hide();
                        $("#modal").hide();
                        return false;
                    } else {
                        var Color = $("#tdtxtmobileno" + selectedspilt[i]).css('border-color');
                        if (Color == "rgb(214, 214, 214)") {
                            $("#tdtxtmobileno" + selectedspilt[i]).css('border-color', '#d6d6d6');
                        }
                    }
                    var code = $("#tdtxtCountryCode" + selectedspilt[i] + " option:selected").text();
                    var mob = $("#tdtxtmobileno" + selectedspilt[i]).val();
                    if (code == "+91") {
                        if (mob.length < 10 || mob.length > 10) {
                            $("#spnerrorspan").text("Enter Valid Mobile Number");
                            $("#tdtxtmobileno" + selectedspilt[i]).css('border-color', '#f4633a');
                            $("#spnerror").show();
                            $("#fade").hide();
                            $("#modal").hide();
                            return false;
                        }
                        else {
                            var Color = $("#tdtxtmobileno" + selectedspilt[i]).css('border-color');
                            if (Color == "rgb(214, 214, 214)") {
                                $("#tdtxtmobileno" + selectedspilt[i]).css('border-color', '#d6d6d6');
                            }
                        }
                    }

                    if (isNaN(mob)) {
                        $("#spnerrorspan").text("Enter Valid Mobile Number");
                        $("#tdtxtmobileno" + selectedspilt[i]).css('border-color', '#f4633a');
                        $("#spnerror").show();
                        $("#fade").hide();
                        $("#modal").hide();
                        return false;
                    } else {
                        var Color = $("#tdtxtmobileno" + selectedspilt[i]).css('border-color');
                        if (Color == "rgb(214, 214, 214)") {
                            $("#tdtxtmobileno" + selectedspilt[i]).css('border-color', '#d6d6d6');
                        }
                    }

                    var iszero = /^0*$/.test(mob);
                    if (iszero == true) {
                        $("#spnerrorspan").text("Enter Valid Mobile Number");
                        $("#tdtxtmobileno" + selectedspilt[i]).css('border-color', '#f4633a');
                        $("#spnerror").show();
                        $("#fade").hide();
                        $("#modal").hide();
                        return false;
                    } else {
                        var Color = $("#tdtxtmobileno" + selectedspilt[i]).css('border-color');
                        if (Color == "rgb(214, 214, 214)") {
                            $("#tdtxtmobileno" + selectedspilt[i]).css('border-color', '#d6d6d6');
                        }
                    }

                    var Name = $("#tdtxtvisitorName" + selectedspilt[i]).val();
                    if (Name == "" || Name == null || Name == undefined) {
                        $("#spnerrorspan").text("Enter Visitor Name");
                        $("#tdtxtvisitorName" + selectedspilt[i]).css('border-color', '#f4633a');
                        $("#spnerror").show();
                        $("#fade").hide();
                        $("#modal").hide();
                        return false;
                    } else {
                        var Color = $("#tdtxtvisitorName" + selectedspilt[i]).css('border-color');
                        if (Color == "rgb(214, 214, 214)") {
                            $("#tdtxtvisitorName" + selectedspilt[i]).css('border-color', '#d6d6d6');
                        }
                    }

                    var Organization = $("#tdtxtcompany" + selectedspilt[i]).val();
                    if (VisitorType != "Family Members" && VisitorType != "Others") {
                        if (Organization == "" || Organization == null || Organization == undefined) {
                            $("#spnerrorspan").text("Enter Visitor Organization");
                            $("#tdtxtcompany" + selectedspilt[i]).css('border-color', '#f4633a');
                            $("#spnerror").show();
                            $("#fade").hide();
                            $("#modal").hide();
                            return false;
                        } else {
                            var Color = $("#tdtxtcompany" + selectedspilt[i]).css('border-color');
                            if (Color == "rgb(214, 214, 214)") {
                                $("#tdtxtcompany" + selectedspilt[i]).css('border-color', '#d6d6d6');
                            }
                        }
                    }
                    else {
                        if (VisitorType == "Others") {
                            Organization = Others;
                        }
                        else {
                            if (Organization == "Optional") {
                                Organization = "";
                            }
                        }
                    }

                    var LocationNamedrop = document.getElementById("ddllocationlist");
                    // var LocationName = LocationNamedrop.options[LocationNamedrop.selectedIndex].text;                   
                    LocationName = LocationNamedrop.selectedIndex >= 0 ? LocationNamedrop.options[LocationNamedrop.selectedIndex].text : "Select Visiting Location";
                    // var locationID = LocationNamedrop.options[LocationNamedrop.selectedIndex].value;
                    var locationID = LocationNamedrop.selectedIndex >= 0 ? LocationNamedrop.options[LocationNamedrop.selectedIndex].value : 0;

                    if (LocationName == "Select Visiting Location" || LocationName == "" || LocationName == undefined || LocationName == null) {
                        $(".select2-container--default .select2-selection--single").css('border-color', '#f4633a');
                        $("#Locationspnerror").show();
                        $("#fade").hide();
                        $("#modal").hide();
                        return false;
                    }
                    else {
                        $(".select2-container--default .select2-selection--single").css('border-color', '#d6d6d6');
                    }
                    var indexlocation = LocationName.indexOf("IND");
                    var HostId = $("#txthostID").val();
                    if (VisitorType == "Client" && indexlocation >= 0) {
                        if (HostId == "" || HostId == null || HostId == undefined) {
                            $("#Hostspnerrorspan").text("Enter Host ID");
                            $("#Hostspnerror").show();
                            $("#txthostID").css('border-color', '#f4633a');
                            $(".divLocationdetails1").css("max-height", "339px");
                            $("#fade").hide();
                            $("#modal").hide();
                            return false;
                        }
                        var hastindex = HostId.indexOf('(');
                        if (hastindex < 0) {
                            $("#Hostspnerrorspan").text("Enter valid Host ID");
                            $("#Hostspnerror").show();
                            $("#txthostID").css('border-color', '#f4633a');
                            $(".divLocationdetails1").css("max-height", "339px");
                            $("#fade").hide();
                            $("#modal").hide();
                            return false;
                        }
                    }

                    var Date = $("#txtvisitdate").val();
                    if (Date == "" || Date == null || Date == undefined) {
                        $("#txtvisitdate").css("border-color", "#f4633a");
                        $("#divimgdate").css("border-color", "#f4633a");
                        $(".divLocationdetails1").css("max-height", "339px");
                        $("#datespnerror").show();
                        $("#fade").hide();
                        $("#modal").hide();
                        return false;
                    }

                    var array = Date.split(',');
                    array.sort(function (a, b) {
                        return new window.Date(a) - new window.Date(b);
                    });

                    var dataadd = "";
                    for (var z = 0; z < array.length; z++) {
                        dataadd += array[z] + ",";
                    }
                    var date = dataadd.substring(0, dataadd.length - 1);
                    Date = date;
                    var StartTime = $("#txtstarttime").val();
                    if (StartTime == "" || StartTime == null || StartTime == undefined || StartTime == "Start Time") {
                        $("#Timespnerrorspan").text("Enter Start Time");
                        $("#Timespnerror").show();
                        $("#txtstarttime").css('border-color', '#f4633a');
                        $("#fade").hide();
                        $("#modal").hide();
                        return false;
                    }
                    var ToTime = $("#txtendtime").val();
                    if (ToTime == "" || ToTime == null || ToTime == undefined || ToTime == "End Time") {
                        $("#Timespnerrorspan").text("Enter End Time");
                        $("#txtendtime").css('border-color', '#f4633a');
                        $("#Timespnerror").show();
                        $("#fade").hide();
                        $("#modal").hide();
                        return false;
                    }
                    var start = StartTime;
                    var end = ToTime;
                    var dtStart = new window.Date("1/1/2011 " + start);
                    var dtEnd = new window.Date("1/1/2011 " + end);
                    var difference_in_milliseconds = dtEnd - dtStart;
                    if (difference_in_milliseconds <= 0) {
                        $("#Timespnerrorspan").text("To Time should be greater than From Time");
                        $("#txtstarttime").css('border-color', '#f4633a');
                        $("#Timespnerror").show();
                        $("#txtendtime").css('border-color', '#f4633a');
                        $("#fade").hide();
                        $("#modal").hide();
                        return false;
                    }

                    var currenttoday = new window.Date();
                    var currentdate = ('0' + (currenttoday.getMonth() + 1)).slice(-2) + '/' + ('0' + currenttoday.getDate()).slice(-2) + '/' + currenttoday.getFullYear();
                    var s = Date.split(',');
                    for (var x = 0; x < s.length; x++) {
                        //var indexcurrentdate = Date.indexOf(currentdate);
                        if (currentdate == s[x]) {
                            var now = new window.Date();
                            var hh = now.getHours();
                            var min = now.getMinutes();
                            var ampm = (hh >= 12) ? 'PM' : 'AM';
                            hh = hh % 12;
                            hh = hh ? hh : 12;
                            hh = hh < 10 ? '0' + hh : hh;
                            min = min < 10 ? '0' + min : min;
                            var time = hh + ":" + min + " " + ampm;
                            var dtStart = new window.Date("1/1/2011 " + time);
                            var dtEnd = new window.Date("1/1/2011 " + start);
                            var difference_in_milliseconds = dtEnd - dtStart;
                            if (difference_in_milliseconds <= 0) {
                                $("#Timespnerrorspan").text("Start time should not be past time.");
                                $("#txtstarttime").css('border-color', '#f4633a');
                                $("#Timespnerror").show();
                                $("#txtendtime").css('border-color', '#f4633a');
                                $("#fade").hide();
                                $("#modal").hide();
                                return false;
                            }
                        }
                    }

                    var IsEquipmentcheck = $("#tdaequipment" + selectedspilt[i]).text();
                    var IsEquipment = "";
                    var euipmqntUniqID = "";
                    if (IsEquipmentcheck == "Yes") {
                        IsEquipment = "1";
                        euipmqntUniqID = $("#tdaequipment" + selectedspilt[i]).attr("name");
                        if (parseInt(euipmqntUniqID) == 0) {
                            IsEquipment = "0";
                            euipmqntUniqID = "0";
                        }
                    }
                    else if (IsEquipmentcheck == "No") {
                        IsEquipment = "0";
                        euipmqntUniqID = "0";
                    }
                    else {
                        IsEquipment = "0";
                    }

                    var isDatacenterAccesscheck = $("#dataccess").text();
                    var isDatacenterAccess = "";
                    if (isDatacenterAccesscheck == "Update Datacenter Access Details") {
                        isDatacenterAccess = "1";
                    }
                    else {
                        isDatacenterAccess = "0";
                    }
                    if (LocationCount == undefined || LocationCount == "" || LocationCount == null) {
                        LocationCount = 0;
                    }
                    if (parseInt(LocationCount) > 0) {
                        for (var q = 0; q < parseInt(LocationCount); q++) {
                            var q1 = (parseInt(q) + 1);
                            if (q1 <= 9) {
                                var LocationNamedrop1 = document.getElementById("ddllocationlist" + q1);
                                //  var LocationName1 = LocationNamedrop1.options[LocationNamedrop1.selectedIndex].text;
                                var LocationName1 = LocationNamedrop1.selectedIndex >= 0 ? LocationNamedrop1.options[LocationNamedrop1.selectedIndex].text : "Select Visiting Location";
                                //  var locationID1 = LocationNamedrop1.options[LocationNamedrop1.selectedIndex].value;
                                var locationID1 = LocationNamedrop1.selectedIndex >= 0 ? LocationNamedrop1.options[LocationNamedrop1.selectedIndex].value : 0;
                                var HostId1 = $("#txthostID" + q1).val();
                                var Date1 = $("#txtvisitdate" + q1).val();
                                var start = $("#txtstarttime" + q1).val();
                                var end = $("#txtendtime" + q1).val();
                                var StartTime1 = $("#txtstarttime" + q1).val();
                                var ToTime1 = $("#txtendtime" + q1).val();
                                var locationin = LocationName.indexOf(LocationName1);
                                var splitdate1 = "";
                                if (Date1 == "" || Date1 == null || Date1 == undefined) {
                                    $("#txtvisitdate" + q1).css('border-color', '#f4633a');
                                    $("#divimgdate" + q1).css("border-color", "#f4633a");
                                    $("#fade").hide();
                                    $("#datespnerror" + q1).show();
                                    $("#modal").hide();
                                    return false;
                                }


                                if (LocationName1 == "Select Visiting Location") {
                                    $("#ddllocationlist" + q1).css('border-color', '#f4633a');
                                    $("#Locationspnerror" + q1).show();
                                    $("#fade").hide();
                                    $("#modal").hide();
                                    return false;
                                }


                                if (locationin >= 0) {
                                    splitdate1 = Date1.split(',');
                                    if (splitdate1.length > 0) {
                                        for (var w = 0; w < splitdate1.length; w++) {
                                            var n = Date.indexOf(splitdate1[w]);
                                            if (n >= 0) {
                                                $("#spnerrorspan").text("* Error : Duplicate Entry. Please select a different date or location.");
                                                $("#txtvisitdate" + q1).css('border-color', '#f4633a');
                                                $("#fade").hide();
                                                $("#spnerror").show();
                                                $("#modal").hide();
                                                return false;
                                            }
                                        }
                                    }
                                } else {
                                    splitdate1 = Date.split('~');
                                    if (splitdate1.length > 0) {
                                        for (var w = 0; w < splitdate1.length; w++) {
                                            var s = Date1.split(',');
                                            for (var x = 0; x < s.length; x++) {
                                                //var indexcurrentdate = Date.indexOf(currentdate);
                                                if (splitdate1[w] == s[x]) {
                                                    var splistart = StartTime1.split(',');
                                                    if (splistart.length > 0) {
                                                        for (var u = 0; u < splistart.length; u++) {
                                                            var startin = StartTime.indexOf(splistart[u]);
                                                            if (startin >= 0) {
                                                                $("#spnerrorspan").text("* Error : Same Start time is avaliable in another same location");
                                                                $("#txtstarttime" + q1).css('border-color', '#f4633a');
                                                                $("#fade").hide();
                                                                $("#spnerror").show();
                                                                $("#modal").hide();
                                                                return false;
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }

                                }


                                ////var startTime = '09:00 AM';
                                ////var endTime = '06:00 PM';

                                ////var curr_time = '08:00 AM';

                                ////if (get24Hr(curr_time) > get24Hr(startTime) && get24Hr(curr_time) < get24Hr(endTime)) {
                                ////    alert("Yes")
                                ////} else {
                                ////    alert('No');
                                ////}

                                if (Date1 == "" || Date1 == null || Date1 == undefined) {
                                    $("#txtvisitdate" + q1).css('border-color', '#f4633a');
                                    $("#divimgdate" + q1).css("border-color", "#f4633a");
                                    $("#fade").hide();
                                    $("#datespnerror" + q1).show();
                                    $("#modal").hide();
                                    return false;
                                }
                                else {
                                    var array = Date1.split(',');
                                    array.sort(function (a, b) {
                                        return new window.Date(a) - new window.Date(b);
                                    });

                                    var dataadd = "";
                                    for (var z = 0; z < array.length; z++) {
                                        dataadd += array[z] + ",";
                                    }
                                    var date = dataadd.substring(0, dataadd.length - 1);
                                    Date1 = date;
                                    Date = Date + "~" + Date1;

                                }

                                if (LocationName1 == "Select Visiting Location") {
                                    $(".select2-container--default .select2-selection--single").css('border-color', '#f4633a');
                                    $("#Locationspnerror" + q1).show();
                                    $("#fade").hide();
                                    $("#modal").hide();
                                    return false;
                                }
                                else {
                                    LocationName = LocationName + "~" + LocationName1;
                                    locationID = locationID + "~" + locationID1;
                                }
                                var indexlocation = LocationName1.indexOf("IND");
                                if (VisitorType == "Client" && indexlocation >= 0) {
                                    if (HostId1 == "" || HostId1 == null || HostId1 == undefined) {
                                        $("#Hostspnerrorspan" + q1).text("Enter Host ID");
                                        $("#txthostID" + q1).css('border-color', '#f4633a');
                                        $(".divLocationdetails").css("max-height", "345px");
                                        $("#Hostspnerror" + q1).show();
                                        $("#fade").hide();
                                        $("#modal").hide();
                                        return false;
                                    }
                                    else {
                                        var hastindex = HostId1.indexOf('(');
                                        if (hastindex < 0) {
                                            $("#Hostspnerrorspan" + q1).text("Enter valid Host ID");
                                            $("#Hostspnerror" + q1).show();
                                            $("#txthostID" + q1).css('border-color', '#f4633a');
                                            $(".divLocationdetails").css("max-height", "345px");
                                            $("#fade").hide();
                                            $("#modal").hide();
                                            return false;
                                        }
                                        else {
                                            HostId = HostId + "~" + HostId1;
                                        }
                                    }
                                }
                                else {
                                    HostId = HostId + "~" + "";
                                }

                                var dtStart = new window.Date("1/1/2011 " + start);
                                var dtEnd = new window.Date("1/1/2011 " + end);
                                var difference_in_milliseconds = dtEnd - dtStart;
                                if (difference_in_milliseconds <= 0) {
                                    $("#Timespnerrorspan" + q1).text("To Time should be greater than From Time");
                                    $("#txtstarttime" + q1).css('border-color', '#f4633a');
                                    $("#txtendtime" + q1).css('border-color', '#f4633a');
                                    $("#Timespnerror" + q1).show();
                                    $("#fade").hide();
                                    $("#modal").hide();
                                    return false;
                                }

                                var currenttoday = new window.Date();
                                var currentdate = ('0' + (currenttoday.getMonth() + 1)).slice(-2) + '/' + ('0' + currenttoday.getDate()).slice(-2) + '/' + currenttoday.getFullYear();
                                var indexcurrentdate = Date1.indexOf(currentdate);
                                if (indexcurrentdate >= 0) {
                                    var now = new window.Date();
                                    var hh = now.getHours();
                                    var min = now.getMinutes();
                                    var ampm = (hh >= 12) ? 'PM' : 'AM';
                                    hh = hh % 12;
                                    hh = hh ? hh : 12;
                                    hh = hh < 10 ? '0' + hh : hh;
                                    min = min < 10 ? '0' + min : min;
                                    var time = hh + ":" + min + " " + ampm;
                                    var dtStart = new window.Date("1/1/2011 " + time);
                                    var dtEnd = new window.Date("1/1/2011 " + start);
                                    var difference_in_milliseconds = dtEnd - dtStart;
                                    if (difference_in_milliseconds <= 0) {
                                        $("#Timespnerrorspan" + q1).text("Start time should not be past time.");
                                        $("#txtstarttime" + q1).css('border-color', '#f4633a');
                                        $("#Timespnerror" + q1).show();
                                        $("#txtendtime" + q1).css('border-color', '#f4633a');
                                        $("#fade").hide();
                                        $("#modal").hide();
                                        return false;
                                    }
                                }

                                if (StartTime1 == "" || StartTime1 == null || StartTime1 == undefined || StartTime1 == "Start Time") {
                                    $("#Timespnerrorspan" + q1).text("Enter Start Time");
                                    $("#txtstarttime" + q1).css('border-color', '#f4633a');
                                    $("#Timespnerror" + q1).show();
                                    $("#fade").hide();
                                    $("#modal").hide();
                                    return false;
                                }
                                else {
                                    StartTime = StartTime + "~" + StartTime1;
                                }

                                if (ToTime1 == "" || ToTime1 == null || ToTime1 == undefined || ToTime1 == "End Time") {
                                    $("#Timespnerrorspan" + q1).text("Enter End Time");
                                    $("#txtendtime" + q1).css('border-color', '#f4633a');
                                    $("#fade").hide();
                                    $("#Timespnerror" + q1).show();
                                    $("#modal").hide();
                                    return false;
                                }
                                else {
                                    ToTime = ToTime + "~" + ToTime1;
                                }
                            }
                        }
                    }
                    var CartID = document.getElementById("hdnCartID").value;
                    if (CartID == null || CartID == "" || CartID == undefined) {
                        $.ajax({
                            type: "POST",
                            url: "HomePage.aspx/InsertVisitorCart",
                            contentType: "application/json;charset=utf-8",
                            data: '{"visitorType":"' + VisitorType + '","mobileNo":"' + MobileNo + '","name":"' + Name + '","organization":"' + Organization + '","locationName":"' + LocationName + '","hostId":"' + HostId + '","date":"' + Date + '","startTime":"' + StartTime + '","totime":"' + ToTime + '","isEquipment":"' + IsEquipment + '","isDatacenterAccess":"' + isDatacenterAccess + '","addedLocations":"' + LocationCount + '","others":"' + Others + '","locationID":"' + locationID + '","euipmqntUniqID":"' + euipmqntUniqID + '"}',
                            dataType: "json",
                            success: function (data) {
                                debugger;
                                if (data.d.indexOf("Validation failed") > -1) {
                                    var message = data.d.split('|')[1];
                                    $("#Timespnerrorspan").text(message);
                                    $("#Timespnerror").show();
                                    $("#txtstarttime").css('border-color', '#f4633a');
                                    $("#fade").hide();
                                    $("#modal").hide();
                                    return false;
                                }
                                else {
                                    var Cart = JSON.parse(data.d);
                                    if (parseInt(Cart["0"].CartID) == 0) {
                                        document.getElementById('Sucessmessage').style.display = 'block';
                                        $("#Sucessmessageheader").text("Warning!");
                                        Duplicatecount = true;
                                        $("#Sucessmessagebody").html("Duplicate Entry. Please select a different date and location.");
                                    }
                                    else {
                                        var Cart_append = "";
                                        if (Cart.length > 0) {
                                            $(".btnPreviewSubmit").css("background-color", "#00b140");
                                            $(".btnPreviewSubmit").removeAttr("disabled");
                                            $("#spncartcount").css("color", "#d9d9d9");
                                            $(".CartImg").css("background", "url('.../../images/New Images/VMS-Icons.png') no-repeat -192px -289px");
                                        }
                                        for (var i = 0; i < Cart.length; i++) {
                                            $("#spncartcount").text("(" + (i + 1) + ")");
                                            $("#spncartcount1").text((i + 1));
                                            $("#spncartcount").css("color", "#00b140");
                                            $(".CartImg").css("background", "url('.../../images/New Images/VMS-Icons.png') no-repeat -192px -228px");
                                            if (parseInt(Cart[i].Ismultilocation) == 0) {
                                                if (i % 2 == 0) {
                                                    Cart_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Cart[i].CartID + "'>";
                                                }
                                                else {
                                                    Cart_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Cart[i].CartID + "'>";
                                                }
                                                Cart_append += "<td class='Recentvisitortabletd' style='color:#0033a0;font:14px Arial-Bold;padding-left:15px;' title=\"" + Cart[i].VisitorName + "\">";
                                                if (parseInt(Cart[i].isDatacenterAccess) == 0) {
                                                    Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "";
                                                }
                                                else {
                                                    Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "<img src='images/New%20Images/img_trans.gif' style='background:url(images/New%20Images/VMS-Icons.png) no-repeat -452px -232px;height:21px;margin-left:4px;margin-top:3%;' />";
                                                }
                                                Cart_append += "</td>";
                                                Cart_append += "<td class='Recentvisitortabletd' title=\"" + Cart[i].LocationName + "\">";
                                                Cart_append += "" + Cart[i].LocationName.slice(0, parseInt(15)) + (Cart[i].LocationName.length > parseInt(15) ? "..." : "") + "";
                                                Cart_append += "</td>";
                                                Cart_append += "<td class='Recentvisitortabletd' style='width:18%;' title='" + Cart[i].HostID + "'>";
                                                Cart_append += "" + Cart[i].HostID.slice(0, parseInt(15)) + (Cart[i].HostID.length > parseInt(15) ? "..." : "" + "") + "";
                                                Cart_append += "</td>";
                                                Cart_append += "<td  class='Recentvisitortabletd' style='width:37%;' title=" + Cart[i].Date + ">";
                                                var Splitdate = Cart[i].Date.split(',');
                                                if (Splitdate.length == 1) {
                                                    ConcaSpt = Splitdate;
                                                }
                                                else {
                                                    var ConcaSpt = "";
                                                    for (var w = 0; w < Splitdate.length; w++) {
                                                        var splitsingledata = Splitdate[w].split('/');
                                                        ConcaSpt += splitsingledata[0] + "/" + splitsingledata[1] + ",";
                                                    }
                                                    ConcaSpt = ConcaSpt.slice(0, -1);
                                                }

                                                // var spltfrom = Splitdate[0];
                                                //var spltto = Splitdate[Splitdate.length - 1];

                                                //if (spltfrom == spltto) {
                                                //  ConcaSpt = Splitdate;
                                                //}
                                                //else {
                                                //  ConcaSpt = spltfrom + " to " + spltto;
                                                // }

                                                Cart_append += "" + ConcaSpt.slice(0, parseInt(20)) + (ConcaSpt.length > parseInt(20) ? "..." : "") + " " + "-" + " " + Cart[i].FromTime + " " + "to" + " " + Cart[i].ToTime + "<br/>";
                                                //}
                                                Cart_append += "</td>";
                                                Cart_append += "<td style='text-align:center;'>";
                                                Cart_append += "<img class='editimage' id='tdimgedit" + Cart[i].CartID + "' title='Edit' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;' onclick='EditCart(" + Cart[i].CartID + ")' />";
                                                Cart_append += "<img class='cancelimage' id='tdimgcancel" + Cart[i].CartID + "' title='Delete' src='images/New Images/img_trans.gif' style='height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -203px -94px;margin-left:4%;cursor:pointer;' onclick='DeleteCart(" + Cart[i].CartID + ")' />";
                                                Cart_append += "</td>";
                                                Cart_append += "</tr >";
                                            }
                                            else {
                                                if (i % 2 == 0) {
                                                    Cart_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Cart[i].CartID + "'>";
                                                }
                                                else {
                                                    Cart_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Cart[i].CartID + "'>";
                                                }
                                                Cart_append += "<td class='Recentvisitortabletd' style='color:#0033a0;font:14px Arial-Bold;padding-left:15px;' title=\"" + Cart[i].VisitorName + "\">";
                                                if (parseInt(Cart[i].isDatacenterAccess) == 0) {
                                                    Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "";
                                                }
                                                else {
                                                    Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "<img src='images/New%20Images/img_trans.gif' style='background:url(images/New%20Images/VMS-Icons.png) no-repeat -452px -232px;height:21px;margin-left:4px;margin-top:3%;' />";
                                                }
                                                Cart_append += "</td>";
                                                Cart_append += "<td class='Recentvisitortabletd' title=\"" + Cart[i].LocationName + "\">";
                                                Cart_append += "" + Cart[i].LocationName.slice(0, parseInt(15)) + (Cart[i].LocationName.length > parseInt(15) ? "..." : "") + "";
                                                Cart_append += "</td>";
                                                Cart_append += "<td class='Recentvisitortabletd' style='width:18%;' title='" + Cart[i].HostID + "'>";
                                                Cart_append += "" + Cart[i].HostID.slice(0, parseInt(15)) + (Cart[i].HostID.length > parseInt(15) ? "..." : "" + "") + "";
                                                Cart_append += "</td>";
                                                Cart_append += "<td  class='Recentvisitortabletd' style='width:37%;' title=" + Cart[i].Date + ">";
                                                var Splitdate = Cart[i].Date.split(',');
                                                if (Splitdate.length == 1) {
                                                    ConcaSpt = Splitdate;
                                                }
                                                else {
                                                    var ConcaSpt = "";
                                                    for (var w = 0; w < Splitdate.length; w++) {
                                                        var splitsingledata = Splitdate[w].split('/');
                                                        ConcaSpt += splitsingledata[0] + "/" + splitsingledata[1] + ",";
                                                    }
                                                    ConcaSpt = ConcaSpt.slice(0, -1);
                                                }

                                                // var spltfrom = Splitdate[0];
                                                //var spltto = Splitdate[Splitdate.length - 1];

                                                //if (spltfrom == spltto) {
                                                //  ConcaSpt = Splitdate;
                                                //}
                                                //else {
                                                //  ConcaSpt = spltfrom + " to " + spltto;
                                                // }

                                                Cart_append += "" + ConcaSpt.slice(0, parseInt(20)) + (ConcaSpt.length > parseInt(20) ? "..." : "") + " " + "-" + " " + Cart[i].FromTime + " " + "to" + " " + Cart[i].ToTime + "<br/>";
                                                //}
                                                Cart_append += "</td>";
                                                Cart_append += "<td style='text-align:center;'>";
                                                Cart_append += "<img class='editimage' id='tdimgmultiple" + Cart[i].CartID + "' title='Expand' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -118px -95px;cursor:pointer;margin-left:-21px;' onclick='OpenMultiple(" + Cart[i].CartID + ")' />";
                                                Cart_append += "<img class='editimage' id='tdimgedit" + Cart[i].CartID + "' title='Edit' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;margin-left:3%;' onclick='EditCart(" + Cart[i].CartID + ")' />";
                                                Cart_append += "<img class='cancelimage' id='tdimgcancel" + Cart[i].CartID + "' title='Delete' src='images/New Images/img_trans.gif' style='height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -203px -94px;margin-left:4%;cursor:pointer;' onclick='DeleteCart(" + Cart[i].CartID + ")' />";
                                                Cart_append += "</td>";
                                                Cart_append += "</tr >";
                                                for (var m = 0; m < Cart[i].LocationCount; m++) {
                                                    Cart_append += "<tr class='Recentvisitortablebodytrodd' style='display:none;' id='" + m + "Multipletr" + Cart[i].CartID + "'>";
                                                    Cart_append += "</tr>";
                                                }
                                            }
                                        }
                                        $("#tbodycart").html(Cart_append);
                                        $("#tbodycart1").html(Cart_append);
                                        document.getElementById('Sucessmessage').style.display = 'block';
                                        if (Duplicatecount == true) {
                                            $("#Sucessmessagebody").html("Duplicate entries found and removed. Remaining unique visitor(s) is/are added to cart successfully. Please click Submit to place the request.");
                                        } else {
                                            $("#Sucessmessagebody").html("Visitor(s) added to cart successfully. Please click Submit to place the request.");
                                        }
                                    }
                                }


                            },
                            error: function (result) {
                                $("#fade").hide();
                                $("#modal").hide();
                            }
                        });
                        $(".btnAddCart").html("<img src='images/New%20Images/img_trans.gif' class='addtocarticon'>&nbsp; Add to Cart");
                    }
                    else {
                        var NativeCountry = "India";
                        debugger;
                        $.ajax({
                            type: "POST",
                            url: "HomePage.aspx/UpdateVisitorCart",
                            contentType: "application/json;charset=utf-8",
                            data: '{"visitorType":"' + VisitorType + '","mobileNo":"' + MobileNo + '","name":"' + Name + '","organization":"' + Organization + '","locationName":"' + LocationName + '","hostId":"' + HostId + '","date":"' + Date + '","startTime":"' + StartTime + '","totime":"' + ToTime + '","isEquipment":"' + IsEquipment + '","isDatacenterAccess":"' + isDatacenterAccess + '","cartID":"' + CartID + '","addedLocations":"' + LocationCount + '","others":"' + Others + '","locationID":"' + locationID + '","euipmqntUniqID":"' + euipmqntUniqID + '"}',
                            dataType: "json",
                            success: function (data) {
                                debugger;
                                if (data.d.indexOf("Validation failed") > -1) {
                                    var message = data.d.split('|')[1];
                                    $("#Timespnerrorspan").text(message);
                                    $("#Timespnerror").show();
                                    $("#txtstarttime").css('border-color', '#f4633a');
                                    $("#fade").hide();
                                    $("#modal").hide();
                                    return false;
                                }
                                else {
                                    var Cart = JSON.parse(data.d);
                                    var Cart_append = "";
                                    if (Cart.length > 0) {
                                        document.getElementById('Sucessmessage').style.display = 'block';
                                        $("#Sucessmessagebody").html("Visitor entry has been updated successfully. Please click Submit to place the request.");
                                        $(".btnAddCart").html("<img src='images/New%20Images/img_trans.gif' class='addtocarticon'>&nbsp; Add to Cart");
                                        $(".btnPreviewSubmit").css("background-color", "#00b140");
                                        $(".btnPreviewSubmit").removeAttr("disabled");
                                        $(".btnPreviewSubmit").css("pointer-events", "visible");
                                        $("#txtSerachbox").removeAttr("disabled");
                                        $("#btnSearch").removeAttr("disabled");
                                        $("#spncartcount").css("color", "#d9d9d9");
                                        $(".CartImg").css("background", "url('.../../images/New Images/VMS-Icons.png') no-repeat -192px -289px");
                                    }
                                    for (var i = 0; i < Cart.length; i++) {
                                        $("#spncartcount").text("(" + (i + 1) + ")");
                                        $("#spncartcount1").text((i + 1));
                                        $("#spncartcount").css("color", "#00b140");
                                        $(".CartImg").css("background", "url('.../../images/New Images/VMS-Icons.png') no-repeat -192px -228px");
                                        if (parseInt(Cart[i].Ismultilocation) == 0) {
                                            if (i % 2 == 0) {
                                                Cart_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Cart[i].CartID + "'>";
                                            }
                                            else {
                                                Cart_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Cart[i].CartID + "'>";
                                            }
                                            Cart_append += "<td class='Recentvisitortabletd' style='color:#0033a0;font:14px Arial-Bold;padding-left:15px;' title=\"" + Cart[i].VisitorName + "\">";
                                            if (parseInt(Cart[i].isDatacenterAccess) == 0) {
                                                Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "";
                                            }
                                            else {
                                                Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "<img src='images/New%20Images/img_trans.gif' style='background:url(images/New%20Images/VMS-Icons.png) no-repeat -452px -232px;height:21px;margin-left:4px;margin-top:3%;' />";
                                            }
                                            Cart_append += "</td>";
                                            Cart_append += "<td class='Recentvisitortabletd' title=\"" + Cart[i].LocationName + "\">";
                                            Cart_append += "" + Cart[i].LocationName.slice(0, parseInt(15)) + (Cart[i].LocationName.length > parseInt(15) ? "..." : "") + "";
                                            Cart_append += "</td>";
                                            Cart_append += "<td class='Recentvisitortabletd' style='width:18%;' title='" + Cart[i].HostID + "'>";
                                            Cart_append += "" + Cart[i].HostID.slice(0, parseInt(15)) + (Cart[i].HostID.length > parseInt(15) ? "..." : "" + "") + "";
                                            Cart_append += "</td>";
                                            Cart_append += "<td  class='Recentvisitortabletd' style='width:37%;' title=" + Cart[i].Date + ">";
                                            var Splitdate = Cart[i].Date.split(',');
                                            if (Splitdate.length == 1) {
                                                ConcaSpt = Splitdate;
                                            }
                                            else {
                                                var ConcaSpt = "";
                                                for (var w = 0; w < Splitdate.length; w++) {
                                                    var splitsingledata = Splitdate[w].split('/');
                                                    ConcaSpt += splitsingledata[0] + "/" + splitsingledata[1] + ",";
                                                }
                                                ConcaSpt = ConcaSpt.slice(0, -1);
                                            }

                                            // var spltfrom = Splitdate[0];
                                            //var spltto = Splitdate[Splitdate.length - 1];

                                            //if (spltfrom == spltto) {
                                            //  ConcaSpt = Splitdate;
                                            //}
                                            //else {
                                            //  ConcaSpt = spltfrom + " to " + spltto;
                                            // }

                                            Cart_append += "" + ConcaSpt.slice(0, parseInt(20)) + (ConcaSpt.length > parseInt(20) ? "..." : "") + " " + "-" + " " + Cart[i].FromTime + " " + "to" + " " + Cart[i].ToTime + "<br/>";
                                            //}
                                            Cart_append += "</td>";
                                            Cart_append += "<td style='text-align:center;'>";
                                            Cart_append += "<img class='editimage' id='tdimgedit" + Cart[i].CartID + "' title='Edit' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;' onclick='EditCart(" + Cart[i].CartID + ")' />";
                                            Cart_append += "<img class='cancelimage' id='tdimgcancel" + Cart[i].CartID + "' title='Cancel' src='images/New Images/img_trans.gif' style='height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -203px -94px;margin-left:4%;cursor:pointer;' onclick='DeleteCart(" + Cart[i].CartID + ")' />";
                                            Cart_append += "</td>";
                                            Cart_append += "</tr >";
                                        }
                                        else {
                                            if (i % 2 == 0) {
                                                Cart_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Cart[i].CartID + "'>";
                                            }
                                            else {
                                                Cart_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Cart[i].CartID + "'>";
                                            }
                                            Cart_append += "<td class='Recentvisitortabletd' style='color:#0033a0;font:14px Arial-Bold;padding-left:15px;' title=\"" + Cart[i].VisitorName + "\">";
                                            if (parseInt(Cart[i].isDatacenterAccess) == 0) {
                                                Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "";
                                            }
                                            else {
                                                Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "<img src='images/New%20Images/img_trans.gif' style='background:url(images/New%20Images/VMS-Icons.png) no-repeat -452px -232px;height:21px;margin-left:4px;margin-top:3%;' />";
                                            }
                                            Cart_append += "</td>";
                                            Cart_append += "<td class='Recentvisitortabletd' title=\"" + Cart[i].LocationName + "\">";
                                            Cart_append += "" + Cart[i].LocationName.slice(0, parseInt(15)) + (Cart[i].LocationName.length > parseInt(15) ? "..." : "") + "";
                                            Cart_append += "</td>";
                                            Cart_append += "<td class='Recentvisitortabletd' style='width:18%;' title='" + Cart[i].HostID + "'>";
                                            Cart_append += "" + Cart[i].HostID.slice(0, parseInt(15)) + (Cart[i].HostID.length > parseInt(15) ? "..." : "" + "") + "";
                                            Cart_append += "</td>";
                                            Cart_append += "<td  class='Recentvisitortabletd' style='width:37%;' title=" + Cart[i].Date + ">";
                                            var Splitdate = Cart[i].Date.split(',');
                                            if (Splitdate.length == 1) {
                                                ConcaSpt = Splitdate;
                                            }
                                            else {
                                                var ConcaSpt = "";
                                                for (var w = 0; w < Splitdate.length; w++) {
                                                    var splitsingledata = Splitdate[w].split('/');
                                                    ConcaSpt += splitsingledata[0] + "/" + splitsingledata[1] + ",";
                                                }
                                                ConcaSpt = ConcaSpt.slice(0, -1);
                                            }

                                            // var spltfrom = Splitdate[0];
                                            //var spltto = Splitdate[Splitdate.length - 1];

                                            //if (spltfrom == spltto) {
                                            //  ConcaSpt = Splitdate;
                                            //}
                                            //else {
                                            //  ConcaSpt = spltfrom + " to " + spltto;
                                            // }

                                            Cart_append += "" + ConcaSpt.slice(0, parseInt(20)) + (ConcaSpt.length > parseInt(20) ? "..." : "") + " " + "-" + " " + Cart[i].FromTime + " " + "to" + " " + Cart[i].ToTime + "<br/>";
                                            //}
                                            Cart_append += "</td>";
                                            Cart_append += "<td style='text-align:center;'>";
                                            Cart_append += "<img class='editimage' id='tdimgmultiple" + Cart[i].CartID + "' title='Expand' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -118px -95px;cursor:pointer;margin-left:-21px;' onclick='OpenMultiple(" + Cart[i].CartID + ")' />";
                                            Cart_append += "<img class='editimage' id='tdimgedit" + Cart[i].CartID + "' title='Edit' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;margin-left:3%;' onclick='EditCart(" + Cart[i].CartID + ")' />";
                                            Cart_append += "<img class='cancelimage' id='tdimgcancel" + Cart[i].CartID + "' title='Delete' src='images/New Images/img_trans.gif' style='height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -203px -94px;margin-left:4%;cursor:pointer;' onclick='DeleteCart(" + Cart[i].CartID + ")' />";
                                            Cart_append += "</td>";
                                            Cart_append += "</tr >";
                                            for (var m = 0; m < Cart[i].LocationCount; m++) {
                                                Cart_append += "<tr class='Recentvisitortablebodytrodd' style='display:none;' id='" + m + "Multipletr" + Cart[i].CartID + "'>";
                                                Cart_append += "</tr>";
                                            }
                                        }
                                    }
                                    $("#tbodycart").html(Cart_append);
                                    $("#tbodycart1").html(Cart_append);
                                    document.getElementById("ddlpurpose").value = "0";
                                    $('#ddlpurpose').css("border", "1px solid #0033a0");
                                    $('#ddllocationlist').val("0");
                                    $('#ddllocationlist').trigger('change');
                                    $('#sandbox-container input').datepicker('update', '');
                                    //var fromNow = new window.Date();
                                    //var minutes = 5;
                                    //var hour = 3
                                    //fromNow.setMinutes(fromNow.getMinutes() + minutes);
                                    //var fromhour = fromNow.getHours();
                                    //var fromminute = fromNow.getMinutes();
                                    //var toNow = new window.Date();
                                    //toNow.setHours(toNow.getHours() + hour);
                                    //toNow.setMinutes(toNow.getMinutes() + minutes);
                                    //var tohour = toNow.getHours();
                                    //var tominute = toNow.getMinutes();
                                    //var frommin = 0;
                                    //var tomin = 0;

                                    //if (fromminute >= 0 && fromminute < 15) {
                                    //    fromNow.setMinutes(fromNow.getMinutes() + (15 - fromminute));
                                    //    toNow.setMinutes(15);
                                    //}
                                    //else if (fromminute >= 15 && fromminute < 30) {
                                    //    fromNow.setMinutes(fromNow.getMinutes() + (30 - fromminute));
                                    //    toNow.setMinutes(30);
                                    //}
                                    //else if (fromminute >= 30 && fromminute < 45) {
                                    //    fromNow.setMinutes(fromNow.getMinutes() + (45 - fromminute));
                                    //    toNow.setMinutes(45);
                                    //}
                                    //else {
                                    //    fromNow.setMinutes(fromNow.getMinutes() + (60 - fromminute));
                                    //    toNow.setMinutes(45 + 15)//// Need to test this when the user opens the request between 45 - 59 minutes
                                    //}
                                    //var ampm = (fromhour >= 12) ? 'PM' : 'AM';
                                    //fromhour = fromhour % 12;
                                    //fromhour = fromhour ? fromhour : 12;
                                    //fromhour = fromhour < 10 ? '0' + fromhour : fromhour;
                                    //fromminute = fromminute < 10 ? '0' + fromminute : fromminute;
                                    //var time = appendZero(fromNow.getHours(), 2) + ':' + appendZero(fromNow.getMinutes(), 2);
                                    //var ampm1 = (tohour >= 12) ? 'PM' : 'AM';
                                    //tohour = tohour % 12;
                                    //tohour = tohour ? tohour : 12;
                                    //tohour = tohour < 10 ? '0' + tohour : tohour;
                                    //tominute = tominute < 10 ? '0' + tominute : tominute;
                                    //var time1 = appendZero(toNow.getHours(), 2) + ':' + appendZero(toNow.getMinutes(), 2);

                                    $("#txtstarttime").val("09:00");
                                    $("#txtendtime").val("18:00");
                                    $("#txthostID").val("");
                                    $("#txthostID").hide();
                                    $("#divhostID").hide();
                                    $(".Recentvisitortableaftertextbox").css("border", "1px solid #d6d6d6");
                                    $("#spnerror").hide();
                                    $(".btnAddCart").css("pointer-events", "none");
                                    $(".btnAddCart").css("background-color", "#d9d9d9");
                                    $(".divLocationdetails").remove();
                                    $("#txtothers").hide();
                                    $("#divtxtothers").hide();
                                    $("#AddMoreLocation").attr("onclick", "AddExtraLocation(0)");
                                    $("#AddMoreLocation").css("margin-left", "127px");
                                    //$("#btnSearch").text("Search");
                                    $("#txtSerachbox").val("");
                                    $("#ddlpurpose").removeAttr("disabled");
                                    $("#btnNewVisitor").css("background-color", "#d9d9d9");
                                    $("#btnNewVisitor").removeAttr("onclick");
                                    $("#btnNewVisitor").attr("title", "Please select the visitor type to add a new visitor");
                                }
                            },
                            error: function (result) {
                                $("#fade").hide();
                                $("#modal").hide();
                            }
                        });
                        document.getElementById("hdnCartID").value = "";
                    }

                    $("#tr" + selectedspilt[i]).css("background-color", "#ffffff");
                    $("#tdtxtvisitorName" + selectedspilt[i]).css("color", "#596679");
                    $("#tdtxtvisitorName" + selectedspilt[i]).css("font", "14px Arial-Regular");
                    $("#tdtxtcompany" + selectedspilt[i]).css("color", "#596679");
                    $("#tdtxtcompany" + selectedspilt[i]).css("font", "14px Arial-Regular");
                    $("#tdtxtvisitortype" + selectedspilt[i]).css("color", "#596679");
                    $("#tdtxtvisitortype" + selectedspilt[i]).css("font", "14px Arial-Regular");
                    $("#tdtxtCountryCode" + selectedspilt[i]).css("color", "#596679");
                    $("#tdtxtCountryCode" + selectedspilt[i]).css("font", "14px Arial-Regular");
                    $("#tdtxtmobileno" + selectedspilt[i]).css("color", "#596679");
                    $("#tdtxtmobileno" + selectedspilt[i]).css("font", "14px Arial-Regular");
                    $("#tdaequipment" + selectedspilt[i]).css("color", "#596679");
                    $("#tdaequipment" + selectedspilt[i]).css("font", "14px Arial-Regular");
                    $("#txtSerachbox").val("");
                    //$("#btnSearch").text("Search");
                    $(".Recentvisitortableaftertextbox").css("border", "1px solid #d6d6d6");
                    $("#spnerror").hide();
                    $(".dataaccesscheckbox1").prop("checked", false);
                    $("#ddlpurpose").css("border", "1px solid #0033a0");
                    $("#txthostID").css("border-bottom", "1px solid #d6d6d6");
                    $(".textBox").css("border-bottom", "1px solid #d6d6d6");
                    document.getElementById("hdnnewvisitor").value = "";
                    $("#txtvisitdate").css("border-color", "#d6d6d6");
                    $("#divimgdate").css("border-color", "#d6d6d6");
                    $(".select2-container--default .select2-selection--single").css("border-color", "#d6d6d6");
                }
                Duplicatecount = false;
                $.ajax({
                    type: "POST",
                    url: "HomePage.aspx/GetRecentVisitors",
                    contentType: "application/json;charset=utf-8",
                    data: "{'visitorCount':" + parseInt("9") + "}",
                    dataType: "json",
                    success: function (data) {
                        var RecentData_append = "";
                        if (data.d == "" || data.d == null || data.d == undefined) {
                            $("#RecentVisitortablebody").html("<tr style='height:395px;'><td></td><td></td><td></td><td style='width:210px;color:#596679;font:14px Arial-Regular;'>No Recent Visitors Found</td><td></td><td></td><td></td></tr>");
                            $("#tblRecentvisitor tbody td").css("border", "none");
                            $("#tblRecentvisitor thead td").css("border", "2px solid #dfe9f4");
                            $("#fade").hide();
                            $("#modal").hide();
                        }
                        else {
                            var Recentdata = JSON.parse(data.d);
                            if (Recentdata.length > 0) {
                                for (var i = 0; i < Recentdata.length; i++) {
                                    if (i % 2 == 0) {
                                        RecentData_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Recentdata[i].VisitorId + "'>";
                                    }
                                    else {
                                        RecentData_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Recentdata[i].VisitorId + "'>";
                                    }
                                    RecentData_append += "<td style='width:44px;text-align:center;'>";
                                    RecentData_append += "<input type='checkbox' value='" + Recentdata[i].VisitorId + "' class='dataaccesscheckbox' id='tdchkselect" + Recentdata[i].VisitorId + "' onchange='UserSelectChange(" + Recentdata[i].VisitorId + ")'>";
                                    RecentData_append += "</td>";

                                    RecentData_append += "<td class='Recentvisitortabletd' style='width:168px;'>";
                                    RecentData_append += "<input type='text' maxlength='25' id='tdtxtvisitorName" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].VisitorFullName + "' disabled />";
                                    RecentData_append += "</td>";
                                    RecentData_append += "<td class='Recentvisitortabletd' style='width:215px;'>";
                                    var Mobile = Recentdata[i].MobileNo.split('-');
                                    RecentData_append += "<select type='text' id='tdtxtCountryCode" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' style='width:28px;' disabled ><option>" + Mobile[0] + "</option></select>-<input id='tdtxtmobileno" + Recentdata[i].VisitorId + "' maxlength='10' onkeypress='return isNumberKey(event)' onfocusout='return isvalidmobile(" + Recentdata[i].VisitorId + ")' style='margin-left:0%;width:73px;' class='Recentvisitortabletextbox' type='text' value='" + Mobile[1] + "' disabled />";
                                    RecentData_append += "</td>";
                                    RecentData_append += "<td class='Recentvisitortabletd' style='width:150px;'>";
                                    RecentData_append += "<input type='text' maxlength='25' id='tdtxtcompany" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].Company + "' disabled />";
                                    RecentData_append += "</td>";
                                    RecentData_append += "<td class='Recentvisitortabletd' style='width:158px;'>";
                                    RecentData_append += "<select type='text' id='tdtxtvisitortype" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' disabled ><option>" + Recentdata[i].VisitorType + "</option></select>";
                                    RecentData_append += "</td>";

                                    RecentData_append += "<td class='Recentvisitortabletd' style='width:120px;'>";
                                    if (Recentdata[i].PermitITEquipments == true) {
                                        RecentData_append += "<a title='Please click here to add equipment details' id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#00b140;cursor:pointer;text-decoration:underline;' onclick='OpenEquipment(" + Recentdata[i].VisitorId + ",0)' name='" + Recentdata[i].VisitorId + "'>Yes</a>";
                                    }
                                    else {
                                        RecentData_append += "<a title='Please click here to add equipment details' id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#596679;cursor:pointer;' name='0'>No</a>";
                                    }
                                    RecentData_append += "</td>";
                                    RecentData_append += "<td style='width:48px;text-align:center;'>";
                                    RecentData_append += "<img id='tdimgsave" + Recentdata[i].VisitorId + "' title='Save' src='images/New%20Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;  background: url(images/New%20Images/VMS-Icons.png) no-repeat -37px -235px;' onclick='SaveTableRow(" + Recentdata[i].VisitorId + ")' />";
                                    RecentData_append += "<img id='tdimgcancel" + Recentdata[i].VisitorId + "' title='Cancel' src='images/New%20Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;  background: url(images/New%20Images/VMS-Icons.png) no-repeat -288px -163px;' onclick='CancelTableRow(" + Recentdata[i].VisitorId + ")' />";
                                    RecentData_append += "<img id='tdimgedit" + Recentdata[i].VisitorId + "' title='Edit' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;' onclick='EditTableRow(" + Recentdata[i].VisitorId + ")' />";
                                    RecentData_append += "</td>";
                                    RecentData_append += "</tr >";
                                }
                                $("#RecentVisitortablebody").html(RecentData_append);
                                $('.divRecentvisitor').slimScroll({
                                    height: '432px',
                                    width: '100%'
                                });
                            }
                            else {
                                $("#fade").hide();
                                $("#modal").hide();
                            }
                        }

                    },
                    error: function (result) {
                        $("#fade").hide();
                        $("#modal").hide();
                    }
                });
                $(".btnAddCart").attr("disabled", "disabled");
                $(".btnAddCart").css("background-color", "#d9d9d9");
                $("#visitorspnerror").hide();
                $("#Otherspnerror").hide();
                $("#datespnerror").hide();
                $("#Timespnerror").hide();
                $("#Locationspnerror").hide();
                $("#Hostspnerror").hide();
                $("#fade").hide();
                $("#modal").hide();
            }
            else {
                $("#spnerror").show();
                $("#spnerrorspan").text("You have reached the maximum number of visitors (20 visitors/request).");
            }
        }
        else {
            $("#spnerror").show();
            $("#spnerrorspan").text("Select visitor(s)");
        }
    }
}

function SaveTableRow(ID) {
    $("#fade").show();
    $("#modal").show();
    var Name, Company, MobileNo, mob, VisitorType, Others;
    var Visitordrop = document.getElementById("ddlpurpose");
    VisitorType = Visitordrop.options[Visitordrop.selectedIndex].text;
    if (ID == null || ID == "" || ID == undefined) {
        Name = $("#tdtxtvisitorName").val();
        if (Name == "" || Name == null || Name == undefined) {
            $("#spnerror").show();
            $("#spnerrorspan").text("Enter Visitor Name");
            $("#tdtxtvisitorName").css('border-color', '#f4633a');
            $("#fade").hide();
            $("#modal").hide();
            return false;
        }
        else {
            var Color = $("#tdtxtvisitorName").css('border-color');
            if (Color == "rgb(214, 214, 214)") {
                $("#tdtxtvisitorName").css('border-color', '#d6d6d6');
            }
        }
        //Company = $("#tdtxtcompany").val();
        //if (Company == "" || Company == null || Company == undefined) {
        //    $("#spnerror").text("*Error : Enter organization");
        //    $("#spnerror").show();
        //    $("#tdtxtcompany").css('border-color', '#f4633a');
        //    $("#fade").hide();
        //    $("#modal").hide();
        //    return false;
        //}
        Company = $("#tdtxtcompany").val();
        if (VisitorType != "Family Members") {
            if (Company == "" || Company == null || Company == undefined) {
                $("#spnerrorspan").text("Enter Visitor Organization");
                $("#tdtxtcompany").css('border-color', '#f4633a');
                $("#spnerror").show();
                $("#fade").hide();
                $("#modal").hide();
                return false;
            }
            else {
                var Color = $("#tdtxtcompany").css('border-color');
                if (Color == "rgb(214, 214, 214)") {
                    $("#tdtxtcompany").css('border-color', '#d6d6d6');
                }
            }
        }
        else {
            if (Company == "" || Company == null || Company == undefined) {
                Company = "Family Members";
            }
        }
        MobileNo = $("#tdtxtCountryCode option:selected").text() + '-' + $("#tdtxtmobileno").val();
        if (MobileNo == "" || MobileNo == null || MobileNo == undefined) {
            $("#spnerrorspan").text("Enter Mobile Number");
            $("#spnerror").show();
            $("#tdtxtmobileno").css('border-color', '#f4633a');
            $("#fade").hide();
            $("#modal").hide();
            return false;
        }
        else {
            var Color = $("#tdtxtmobileno").css('border-color');
            if (Color == "rgb(214, 214, 214)") {
                $("#tdtxtmobileno").css('border-color', '#d6d6d6');
            }
        }
        var code = $("#tdtxtCountryCode option:selected").text();
        mob = $("#tdtxtmobileno").val();
        if (code == "+91") {
            if (mob.length < 10 || mob.length > 10) {
                $("#spnerrorspan").text("Enter Valid Mobile Number");
                $("#tdtxtmobileno").css('border-color', '#f4633a');
                $("#spnerror").show();
                $("#fade").hide();
                $("#modal").hide();
                return false;
            } else {
                var Color = $("#tdtxtmobileno").css('border-color');
                if (Color == "rgb(214, 214, 214)") {
                    $("#tdtxtmobileno").css('border-color', '#d6d6d6');
                }
            }
        }
        //mob = $("#tdtxtmobileno").val();
        //if (mob.length < 9 || mob.length > 11) {
        //    $("#spnerror").text("*Error : Enter Valid Mobile Number");
        //    $("#tdtxtmobileno").css('border-color', '#f4633a');
        //    $("#spnerror").show();
        //    $("#fade").hide();
        //    $("#modal").hide();
        //    return false;
        //}
        if (isNaN(mob)) {
            $("#spnerrorspan").text("Enter only Numbers");
            $("#tdtxtmobileno").css('border-color', '#f4633a');
            $("#spnerror").show();
            $("#fade").hide();
            $("#modal").hide();
            return false;
        } else {
            var Color = $("#tdtxtmobileno").css('border-color');
            if (Color == "rgb(214, 214, 214)") {
                $("#tdtxtmobileno").css('border-color', '#d6d6d6');
            }
        }
        var iszero = /^0*$/.test(mob);
        if (iszero == true) {
            $("#spnerrorspan").text("Enter Valid Mobile Number");
            $("#tdtxtmobileno").css('border-color', '#f4633a');
            $("#spnerror").show();
            $("#fade").hide();
            $("#modal").hide();
            return false;
        } else {
            var Color = $("#tdtxtmobileno").css('border-color');
            if (Color == "rgb(214, 214, 214)") {
                $("#tdtxtmobileno").css('border-color', '#d6d6d6');
            }
        }
        if (VisitorType == "Select Visitor Type") {
            $("#ddlpurpose").css('border-color', '#f4633a');
            $("#visitorspnerror").show();
            $("#fade").hide();
            $("#modal").hide();
            return false;
        }
        if (VisitorType == "Others") {
            Others = $("#txtothers").val();
            if (Others == "" || Others == null || Others == undefined) {
                $("#tdtxtvisitortype").css('border-color', '#f4633a');
                $("#Otherspnerror").show();
                $("#fade").hide();
                $("#modal").hide();
                return false;
            }
        }
        ID = 0;
    }
    else {
        Name = $("#tdtxtvisitorName" + ID).val();
        if (Name == "" || Name == null || Name == undefined) {
            $("#spnerrorspan").text("Enter Visitor Name");
            $("#tdtxtvisitorName" + ID).css('border-color', '#f4633a');
            $("#spnerror").show();
            $("#fade").hide();
            $("#modal").hide();
            return false;
        }
        else {
            var Color = $("#tdtxtvisitorName" + ID).css('border-color');
            if (Color == "rgb(214, 214, 214)") {
                $("#tdtxtvisitorName" + ID).css('border-color', '#d6d6d6');
            }
        }
        //Company = $("#tdtxtcompany" + ID).val();
        //if (Company == "" || Company == null || Company == undefined) {
        //    $("#spnerror").text("*Error : Enter organization");
        //    $("#tdtxtcompany" + ID).css('border-color', '#f4633a');
        //    $("#spnerror").show();
        //    $("#fade").hide();
        //    $("#modal").hide();
        //    return false;
        //}
        Company = $("#tdtxtcompany" + ID).val();
        if (VisitorType != "Family Members") {
            if (Company == "" || Company == null || Company == undefined) {
                $("#spnerrorspan").text("Enter Visitor Organization");
                $("#tdtxtcompany" + ID).css('border-color', '#f4633a');
                $("#spnerror").show();
                $("#fade").hide();
                $("#modal").hide();
                return false;
            }
            else {
                var Color = $("#tdtxtcompany" + ID).css('border-color');
                if (Color == "rgb(214, 214, 214)") {
                    $("#tdtxtcompany" + ID).css('border-color', '#d6d6d6');
                }
            }
        }
        else {
            if (Company == "" || Company == null || Company == undefined) {
                Company = "Family Members";
            }
        }
        MobileNo = $("#tdtxtCountryCode" + ID + " option:selected").text() + '-' + $("#tdtxtmobileno" + ID).val();
        if (MobileNo == "" || MobileNo == null || MobileNo == undefined) {
            $("#spnerrorspan").text("Enter Mobile Number");
            $("#tdtxtmobileno" + ID).css('border-color', '#f4633a');
            $("#spnerror").show();
            $("#fade").hide();
            $("#modal").hide();
            return false;
        } else {
            var Color = $("#tdtxtmobileno" + ID).css('border-color');
            if (Color == "rgb(214, 214, 214)") {
                $("#tdtxtmobileno" + ID).css('border-color', '#d6d6d6');
            }
        }
        var code = $("#tdtxtCountryCode" + ID + " option:selected").text();
        mob = $("#tdtxtmobileno" + ID).val();
        if (code == "+91") {
            if (mob.length < 10 || mob.length > 10) {
                $("#spnerrorspan").text("Enter Valid Mobile Number");
                $("#tdtxtmobileno" + ID).css('border-color', '#f4633a');
                $("#spnerror").show();
                $("#fade").hide();
                $("#modal").hide();
                return false;
            } else {
                var Color = $("#tdtxtmobileno" + ID).css('border-color');
                if (Color == "rgb(214, 214, 214)") {
                    $("#tdtxtmobileno" + ID).css('border-color', '#d6d6d6');
                }
            }
        }
        if (isNaN(mob)) {
            $("#spnerrorspan").text("Enter only Numbers");
            $("#tdtxtmobileno" + ID).css('border-color', '#f4633a');
            $("#spnerror").show();
            $("#fade").hide();
            $("#modal").hide();
            return false;
        } else {
            var Color = $("#tdtxtmobileno" + ID).css('border-color');
            if (Color == "rgb(214, 214, 214)") {
                $("#tdtxtmobileno" + ID).css('border-color', '#d6d6d6');
            }
        }
        var iszero = /^0*$/.test(mob);
        if (iszero == true) {
            $("#spnerrorspan").text("Enter Valid Mobile Number");
            $("#tdtxtmobileno" + ID).css('border-color', '#f4633a');
            $("#spnerror").show();
            $("#fade").hide();
            $("#modal").hide();
            return false
        } else {
            var Color = $("#tdtxtmobileno" + ID).css('border-color');
            if (Color == "rgb(214, 214, 214)") {
                $("#tdtxtmobileno" + ID).css('border-color', '#d6d6d6');
            }
        }
        var Visitordrop = document.getElementById("ddlpurpose");
        VisitorType = Visitordrop.options[Visitordrop.selectedIndex].text;
        if (VisitorType == "Select Visitor Type") {
            $("#ddlpurpose").css('border-color', '#f4633a');
            $("#visitorspnerror").show();
            $("#fade").hide();
            $("#modal").hide();
            return false;
        }
        if (VisitorType == "Others") {
            Others = $("#txtothers").val();
            if (Others == "" || Others == null || Others == undefined) {
                $("#tdtxtvisitortype").css('border-color', '#f4633a');
                $("#Otherspnerror").show();
                $("#fade").hide();
                $("#modal").hide();
                return false;
            }
        }

        var IsEquipmentcheck = $("#tdaequipment" + ID).text();
        var IsEquipment = "";
        var euipmqntUniqID = "";
        if (IsEquipmentcheck == "Yes") {
            IsEquipment = "1";
            euipmqntUniqID = $("#tdaequipment" + ID).attr("name");
            if (parseInt(euipmqntUniqID) == 0) {
                IsEquipment = "0";
                euipmqntUniqID = "0";
            }
        }
        else if (IsEquipmentcheck == "No") {
            IsEquipment = "0";
            euipmqntUniqID = "0";
        }
        else {
            IsEquipment = "0";
        }
    }
    $.ajax({
        type: "POST",
        url: "HomePage.aspx/UpdateVisitorDetails",
        contentType: "application/json;charset=utf-8",
        data: '{"visitorID":"' + ID + '","name":"' + Name + '","company":"' + Company + '","mobileNo":"' + MobileNo + '","visitorType":"' + VisitorType + '","others":"' + Others + '","isequipment":"' + IsEquipment + '","euipmqntUniqID":"' + euipmqntUniqID + '"}',
        dataType: "json",
        success: function (data) {
            //var Recentdata = JSON.parse(data.d);
            //var RecentData_append = "";
            //for (var i = 0; i < Recentdata.length; i++) {
            //    if (i % 2 == 0) {
            //        RecentData_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Recentdata[i].VisitorId + "'>";
            //    }
            //    else {
            //        RecentData_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Recentdata[i].VisitorId + "'>";
            //    }
            //    RecentData_append += "<td style='width:44px;text-align:center;'>";
            //    RecentData_append += "<input type='checkbox' value='" + Recentdata[i].VisitorId + "' class='dataaccesscheckbox' id='tdchkselect" + Recentdata[i].VisitorId + "' onchange='UserSelectChange(" + Recentdata[i].VisitorId + ")'>";
            //    RecentData_append += "</td>";
            //    RecentData_append += "<td class='Recentvisitortabletd' style='width:168px;'>";
            //    RecentData_append += "<input type='text' id='tdtxtvisitorName" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].VisitorFullName + "' disabled />";
            //    RecentData_append += "</td>";
            //    RecentData_append += "<td class='Recentvisitortabletd' style='width:150px;'>";
            //    RecentData_append += "<input type='text' id='tdtxtcompany" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].Company + "' disabled />";
            //    RecentData_append += "</td>";
            //    RecentData_append += "<td class='Recentvisitortabletd' style='width:158px;'>";
            //    RecentData_append += "<select type='text' id='tdtxtvisitortype" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' disabled ><option>" + Recentdata[i].VisitorType + "</option></select>";
            //    RecentData_append += "</td>";
            //    RecentData_append += "<td class='Recentvisitortabletd' style='width:212px;'>";
            //    var Mobile = Recentdata[i].MobileNo.split('-');
            //    RecentData_append += "<select type='text' id='tdtxtCountryCode" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' style='width:40px;' disabled ><option>" + Mobile[0] + "</option></select>-<input id='tdtxtmobileno" + Recentdata[i].VisitorId + "' style='margin-left:2%;' class='Recentvisitortabletextbox' type='text' value='" + Mobile[1] + "' disabled />";
            //    RecentData_append += "</td>";
            //    RecentData_append += "<td class='Recentvisitortabletd' style='width:120px;'>";
            //    if (Recentdata[i].PermitITEquipments == true) {
            //        RecentData_append += "<a id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#006583;cursor:pointer;' onclick='OpenEquipment(" + Recentdata[i].VisitorId + ",0)' name='0'>Yes</a>";
            //    }
            //    else {
            //        RecentData_append += "<a id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#596679;cursor:pointer;' onclick='OpenEquipment(" + Recentdata[i].VisitorId + ",0)'>No</a>";
            //    }
            //    RecentData_append += "</td>";
            //    RecentData_append += "<td style='width:48px;'>";
            //    RecentData_append += "<img id='tdimgsave" + Recentdata[i].VisitorId + "' src='images/New Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -37px -235px;' onclick='SaveTableRow(" + Recentdata[i].VisitorId + ")' />";
            //    RecentData_append += "<img id='tdimgcancel" + Recentdata[i].VisitorId + "' src='images/New Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -203px -94px;' onclick='CancelTableRow(" + Recentdata[i].VisitorId + ")' />";
            //    RecentData_append += "<img id='tdimgedit" + Recentdata[i].VisitorId + "' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;' onclick='EditTableRow(" + Recentdata[i].VisitorId + ")' />";
            //    RecentData_append += "</td>";
            //    RecentData_append += "</tr >";
            //}
            //$("#RecentVisitortablebody").html(RecentData_append);
            $("#fade").hide();
            $("#modal").hide();
            //$("#txtSerachbox").val("");
            //$("#btnSearch").text("Search");

        },
        error: function (result) {
            $("#fade").hide();
            $("#modal").hide();
        }
    });

    $("#tdtxtmobileno" + ID).removeClass("Recentvisitortableaftertextbox");
    $("#tdtxtmobileno" + ID).addClass("Recentvisitortabletextbox");
    $("#tdtxtmobileno" + ID).attr("disabled", "disabled");
    $("#tdtxtvisitorName" + ID).removeClass("Recentvisitortableaftertextbox");
    $("#tdtxtvisitorName" + ID).addClass("Recentvisitortabletextbox");
    $("#tdtxtvisitorName" + ID).attr("disabled", "disabled");
    $("#tdtxtcompany" + ID).removeClass("Recentvisitortableaftertextbox");
    $("#tdtxtcompany" + ID).addClass("Recentvisitortabletextbox");
    $("#tdtxtcompany" + ID).attr("disabled", "disabled");
    $("#tdtxtvisitortype" + ID).removeClass("Recentvisitortableaftertextbox");
    $("#tdtxtvisitortype" + ID).addClass("Recentvisitortabletextbox");
    $("#tdtxtvisitortype" + ID).attr("disabled", "disabled");
    $("#tdtxtCountryCode" + ID).removeAttr("Class");
    $("#tdtxtCountryCode" + ID).select2('destroy');
    $("#tdtxtCountryCode" + ID).addClass("Recentvisitortabletextbox");
    $("#tdtxtCountryCode" + ID).attr("disabled", "disabled");
    $("#tdtxtCountryCode" + ID).css("-webkit-appearance", "none");
    $("#tdtxtvisitortype" + ID).css("-webkit-appearance", "none");
    $("#tdtxtCountryCode" + ID).css("-moz-appearance", "none");
    $("#tdtxtvisitortype" + ID).css("-moz-appearance", "none");
    $("#tdtxtCountryCode" + ID).css("width", "36px");



    $("#spnerror").hide();
    $("#tdtxtmobileno" + ID).css("border-color", "transparent");
    $("#tdtxtcompany" + ID).css("border-color", "transparent");
    $("#tdtxtvisitorName" + ID).css("border-color", "transparent");
    $("#ddlpurpose").css("border", "1px solid #0033a0");
    $("#tdimgcancel" + ID).hide();
    $("#tdimgsave" + ID).hide();
    $("#tdimgedit" + ID).show();
    document.getElementById("hdnnewvisitor").value = "";
}

function EditCart(ID) {
    $("#fade").show();
    $("#modal").show();
    $.ajax({
        type: "POST",
        url: "HomePage.aspx/GetVistorType",
        contentType: "application/json;charset=utf-8",
        data: "{}",
        async: false,
        dataType: "json",
        success: function (data) {
            $(".btnAddCart").html("<img src='images/New%20Images/img_trans.gif' class='addtocarticon'>&nbsp; Update Cart");
            $(".btnPreviewSubmit").css("background-color", "#d9d9d9");
            $(".btnPreviewSubmit").attr("disabled", "disabled");
            $(".btnPreviewSubmit").css("pointer-events", "none");
            $("#ddlpurpose").attr("disabled", "disabled");
            $(".divLocationdetails").remove();
            var PurposeData = JSON.parse(data.d);
            var RecentData_append = "";
            RecentData_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + ID + "'>";
            RecentData_append += "<td style='width:44px;text-align:center;'>";
            RecentData_append += "<input type='checkbox' value='" + ID + "' class='dataaccesscheckbox' id='tdchkselect" + ID + "'>";
            RecentData_append += "</td>";
            RecentData_append += "<td class='Recentvisitortabletd' style='width:168px;'>";
            RecentData_append += "<input type='text' maxlength='25' id='tdtxtvisitorName" + ID + "' class='Recentvisitortableaftertextbox' placeholder='Visitor Name' />";
            RecentData_append += "</td>";
            RecentData_append += "<td class='Recentvisitortabletd' style='width:223px;'>";
            RecentData_append += "<select type='text' id='tdtxtCountryCode" + ID + "' class='Recentvisitortableaftertextbox' style='width:55px;' ></select>-<input id='tdtxtmobileno" + ID + "' style='margin-left:0%;width:84px;' class='Recentvisitortableaftertextbox' maxlength='10' onkeypress='return isNumberKey(event)' onfocusout='return isvalidmobile(" + ID + ")' type='text' placeholder='Mobile No' />";
            RecentData_append += "</td>";
            RecentData_append += "<td class='Recentvisitortabletd' style='width:150px;'>";
            RecentData_append += "<input type='text' maxlength='25' id='tdtxtcompany" + ID + "' class='Recentvisitortableaftertextbox'  placeholder='Organization' />";
            RecentData_append += "</td>";
            RecentData_append += "<td class='Recentvisitortabletd' style='width:158px;'>";
            RecentData_append += "<select type='text' id='tdtxtvisitortype" + ID + "' class='Recentvisitortableaftertextbox' disabled>";
            RecentData_append += "<option>Visitor Type</option>";
            for (var i = 0; i < PurposeData.length; i++) {
                if (PurposeData[i] != "Guests" && PurposeData[i] != "Former Employee" && PurposeData[i] != "Associate Driver" && PurposeData[i] != "Auditors" && PurposeData[i] != "New Joinee" && PurposeData[i] != "Business Partner" && PurposeData[i] != "Select Purpose") {
                    RecentData_append += "<option>" + PurposeData[i] + "</option>";
                }
            }
            RecentData_append += "</select>";
            RecentData_append += "</td>";

            RecentData_append += "<td class='Recentvisitortabletd' style='width:120px;'>";
            RecentData_append += "<a id='tdaequipment" + ID + "' href='#' style='color:#00b140;cursor:pointer;text-decoration:underline;' name='0'>Yes</a>";
            RecentData_append += "</td>";
            RecentData_append += "<td style='width:48px;text-align:center;'>";
            //RecentData_append += "<img id='tdimgsave' src='images/New Images/img_trans.gif' style='height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -37px -235px;' onclick='SavecartTableRow(" + ID + ")' />";
            RecentData_append += "<img id='tdimgcancel' title='Go Back' src='images/New Images/img_trans.gif' style='height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -288px -163px' onclick='CancelTableRow(" + ID + ")' />";
            RecentData_append += "</td>";
            RecentData_append += "</tr >";
            $("#RecentVisitortablebody").html(RecentData_append);
            $(".dataaccesscheckbox").attr("checked", true);
            $(".btnAddCart").val("Update");
            $(".btnAddCart").css('background-color', '#00b140');
            $(".btnAddCart").css('pointer-events', 'visible');
            $(".btnAddCart").removeAttr("disabled");
            document.getElementById("hdnCartID").value = ID;
            $("#tdchkselect" + ID).prop('checked', true);
            $.ajax({
                type: "POST",
                url: "HomePage.aspx/GetCountryCode",
                contentType: "application/json;charset=utf-8",
                data: "{}",
                async: false,
                dataType: "json",
                success: function (data) {
                    var Locationdata = JSON.parse(data.d);
                    var RecentData_append = "";
                    for (var i = 0; i < Locationdata.length; i++) {
                        RecentData_append += "<option value=" + Locationdata[i].Country + ">+" + Locationdata[i].Code + "</option>";
                    }
                    $("#tdtxtCountryCode" + ID).html(RecentData_append);
                    $.ajax({
                        type: "POST",
                        url: "HomePage.aspx/GetCartuserDetails",
                        contentType: "application/json;charset=utf-8",
                        data: '{"cartID":"' + ID + '"}',
                        dataType: "json",
                        success: function (data) {

                            ///debugger;
                            var userData = JSON.parse(data.d);
                            document.getElementById('ddlpurpose').value = userData["0"].VisitorType;
                            if (userData["0"].VisitorType == "Others") {
                                $("#txtothers").show();
                                $("#txtothers").val(userData["0"].Others);
                                $("#divtxtothers").show();
                            }
                            else {
                                $("#txtothers").hide();
                                $("#divtxtothers").hide();
                            }
                            var mob = userData["0"].MobileNo.split('-');


                            $('#tdtxtCountryCode' + ID).select2({
                                matcher: function (params, data) {
                                    if ($.trim(params.term) === '') { return data; }
                                    if (typeof data.text === 'undefined') { return null; }
                                    var q = params.term.toLowerCase();
                                    if (data.text.toLowerCase().indexOf(q) > -1 || data.id.toLowerCase().indexOf(q) > -1) {
                                        return $.extend({}, data, true);
                                    }
                                    return null;
                                }
                            });

                            ////$("#tdtxtCountryCode" + ID).val(mob[0]);
                            //$("#tdtxtCountryCode" + ID).val("India");
                            $('#tdtxtCountryCode option').map(function () {
                                if ($(this).text() == mob[0]) return this;
                            }).attr('selected', 'selected');
                            $('#tdtxtCountryCode' + ID).trigger('change');
                            $("#tdtxtmobileno" + ID).val(mob[1]);
                            $("#tdtxtcompany" + ID).val(userData["0"].Organization);
                            $("#tdtxtvisitorName" + ID).val(userData["0"].VisitorName);
                            //if (userData["0"].isEquipment == 0) {
                            //    $('#tdchkeuipment' + ID).text('No');
                            //}
                            //else {
                            //    $('#tdchkeuipment' + ID).text('Yes');
                            //}
                            $('#ddllocationlist').val(userData["0"].LocationID);
                            $('#ddllocationlist').trigger('change');
                            var indexhostid = userData["0"].LocationID.indexOf("IND");
                            if (indexhostid >= 0) {
                                document.getElementById("hdnMHostID").value = userData["0"].HostID;
                                $("#txthostID").val(document.getElementById("hdnMHostID").value);
                                //$("#txthostID").val(userData["0"].HostID);
                                if (userData["0"].VisitorType == "Client") {
                                    $("#txthostID").show();
                                    $("#divhostID").show();
                                }
                            }
                            else {
                                $("#txthostID").hide();
                                $("#txthostID").val("");
                                $("#divhostID").hide();
                            }

                            //$('#txtvisitdate').datepicker({
                            //    clearBtn: true,
                            //    multidate: true,
                            //    todayHighlight: true,
                            //    todayBtn: "linked",
                            //    startDate: "new Date()",
                            //    showButtonPanel: true,
                            //    showClose: true,
                            //    sideBySide: true
                            //});
                            var splitcammadate = userData["0"].Date.split(',');
                            ////var sp = "";
                            //for (var p = 0; p < splitcammadate.length; p++) {
                            $('#txtvisitdate').datepicker('setDate', splitcammadate);
                            //}
                            ////var itemId = sp.substring(1, sp.length);
                            ////var itemId1 = itemId.substring(1, itemId.length - 1);
                            ////var itemId2 = itemId.substring(0, itemId1.length - 1);

                            //$("#txtvisitdate").val(userData["0"].Date);
                            $("#txtstarttime").val(userData["0"].FromTime);
                            $("#txtendtime").val(userData["0"].ToTime);
                            if (parseInt(userData["0"].isDatacenterAccess) == 1) {
                                $("#divdataaccess0").hide();
                            }

                            if (parseInt(userData["0"].isEquipment) == 1) {
                                $("#tdaequipment" + ID).text("Yes");
                                $("#tdaequipment" + ID).css('color', '#00b140');
                                $("#tdaequipment" + ID).attr("name", userData["0"].EuipmqntUniqID);
                            }
                            else {
                                $("#tdaequipment" + ID).text("No");
                                $("#tdaequipment" + ID).css('color', 'rgb(0, 114, 143)');
                                $("#tdaequipment" + ID).attr("name", "0");
                                $("#tdaequipment" + ID).attr("text-decoration", "underline");
                            }
                            $("#tdaequipment" + ID).attr("onclick", "OpenEquipment(" + userData["0"].CartID + ",0)");
                            var Cartmodal = document.getElementById('CardModel');
                            Cartmodal.style.display = "none";
                            $("#tdtxtvisitortype" + ID).val(userData["0"].VisitorType);
                            LocationCount = userData["0"].LocationCount;
                            if (parseInt(userData["0"].LocationCount) > 0) {
                                $(".divLocationdetails").remove();
                                $("#AddMoreLocation").attr("onclick", "AddExtraLocation(0)");
                                $("#AddMoreLocation").css("margin-left", "127px");
                                $.ajax({
                                    type: "POST",
                                    url: "HomePage.aspx/GetCartLocation",
                                    contentType: "application/json;charset=utf-8",
                                    data: '{"cartID":"' + ID + '"}',
                                    dataType: "json",
                                    async: false,
                                    success: function (data) {
                                        var object = JSON.parse(data.d);
                                        var Cart_append = "";
                                        for (var i = 0; i < LocationCount; i++) {
                                            var i1 = parseInt(i) + 1;
                                            var Location_Append = "";
                                            Location_Append += "<div class='divLocationdetails' id='Locationdetails" + i1 + "' style='margin-top:10px;'>";
                                            Location_Append += "<div class=='span5 col-md- 5' style='margin-top:16px;'> <span style='margin-left:16px;font:12px Arial-Regular;color:#4d4d4d;'>Visiting Date</span><span style='color:red;'>*</span><br /><div class='tooltip' style='float:left;font:14px Arial-Regular;'><img style='margin-top:-15px;margin-left:224px;' src='images/New%20Images/img_trans.gif' class='ImgHostID2'/><span style='font:12px Arial-Regular;margin-left:10px;width:199px;' class='tooltiptext'>Multiple dates can be selected.</span></div><input value=" + object[i].CartLocationDate + " readonly onfocusout='datefocus(" + i1 + ")'  title='You will be able to select multiple continuous/non-continuous date(s)' id= 'txtvisitdate" + i1 + "' style='width:187px;height:36px;padding-left:10px;margin-top:5px;border-right:0px;' type= 'text' class='textBox visitdatetex' placeholder= 'MM/DD/YYYY' />";
                                            Location_Append += "<div id='divimgdate" + i1 + "' style='float:left;border:1px solid #d6d6d6;width:30px;height:36px;margin-top:5px;border-left:0px;'><img style='margin-top:10px;' onclick='OpenDatePicker(" + i1 + ")' title='You will be able to select multiple continuous/non-continuous date(s)' id='imgdate" + i1 + "' class='imgdate' src='images/New%20Images/img_trans.gif' /></div><br/> <div id='datespnerror" + i1 + "' style='float:left;font:13px Arial-Regular;line-height:64px;margin-left:19px;display:none;height:30px;line-height:10px;'>";
                                            Location_Append += "<img src ='images/New Images/img_trans.gif' style ='height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -37px -293px;' /> <span style='color:#f4633a;'>Select Visiting Date</span></div ></div>";
                                            Location_Append += "<div style='margin-top:-4%;'> <div style='line-height:32px;width:50%;'><br /><span style='margin-left:19px;font:12px Arial-Regular;color:#4d4d4d;'>Start Time</span><span style='color:red;'>*</span><br /><input type='text' value=" + object[i].CartLocationStartTime + "  id='txtstarttime" + i1 + "' class='textBox Starttime' onkeypress='return AllowAlphanumeric(event)' placeholder='Start Time' />";
                                            Location_Append += "</div>";
                                            Location_Append += "<div style='margin-top:-55px;float:right;margin-right:4%;width:50%;'><span style='margin-left:20px;font:12px Arial-Regular;color:#4d4d4d;'>End Time</span><span style='color: red;'>*</span><br /><div style='margin-top:5%;'><input value=" + object[i].CartLocationEndTime + " type='text' id='txtendtime" + i1 + "' class='textBox Endtime' onkeypress='return AllowAlphanumeric(event)' placeholder='End Time' />";
                                            Location_Append += "</div></div><br/> <div id='Timespnerror" + i1 + "' style='float:left;font:13px Arial-Regular;margin-left:20px;display:none;height:30px;line-height:13px;text-align:center;'>";
                                            Location_Append += "<img src ='images/New Images/img_trans.gif' style = 'height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -37px -293px;' /> <span style='color:#f4633a;' id='Timespnerrorspan" + i1 + "'>Select Visiting Date</span></div ></div> ";
                                            Location_Append += "<div style='margin-top:32px;'><span style ='margin-left:20px;font:12px Arial-Regular;color:#4d4d4d;'> Visiting Location</span ><span style='color:red;'>*</span> <br /><select id='ddllocationlist" + i1 + "' onchange='LocationChange(" + i1 + ")'>";
                                            Location_Append += "<option>Select Visiting Location</option>";
                                            Location_Append += "</select><br/><div id='Locationspnerror" + i1 + "' style='width:60%;float:left;font:13px Arial-Regular;line-height:64px;margin-left:19px;display:none;height:30px;line-height:10px;'>";
                                            Location_Append += "<img src = 'images/New Images/img_trans.gif' style = 'height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -37px -293px;' /> <span style='color:#f4633a;'>Select Visiting Location</span></div ></div>";
                                            var Visitordrop = document.getElementById("ddlpurpose");
                                            VisitorType = Visitordrop.options[Visitordrop.selectedIndex].text;
                                            if (VisitorType == "Client") {
                                                //var indexhostid1 = object[i].CartLocationNameID.indexOf("IND");
                                                //if (indexhostid1 >= 0) {
                                                Location_Append += "<div style='margin-top:7px;display:none;' id='divhostID" + i1 + "'> <span style ='margin-left:20px;font:12px Arial-Regular;color:#4d4d4d;'> Host ID / Name</span> <span style='color:red;'>*</span> <br /><input value='" + object[i].CartLocationHostID + "' type='text' onfocusout='HostIDfocus(" + i1 + ")' style='margin-left:18px;width:218px;height:36px;padding-left:12px;margin-top:5px;' id='txthostID" + i1 + "' onkeyup='GetAssociateDeails(" + i1 + ")' class='textBox' placeholder='Host name /ID (M+ only)' />";
                                                Location_Append += "<div class='tooltip' style='margin-top:4%;margin-left:-8%;float:left;font:12px Arial-Regular'><img src='images/New%20Images/img_trans.gif' class='ImgHostID1' style='display:block;'/><span style='width:405px;margin-left:-206px;font:12px Arial-Regular' class='tooltiptext'>Host (M+ level) is accountable for client credentials provided in the request.</span></div><br/>  <div id='Hostspnerror" + i1 + "' style='width:60%;float:left; ont:13px Arial-Regular;line-height:64px;margin-left:19px;display:none;height:30px;line-height:10px;'>";
                                                Location_Append += "<img src = 'images/New Images/img_trans.gif' style = 'height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -37px -293px;' /> <span style='color:#f4633a;' id='Hostspnerrorspan" + i1 + "'>Enter Host ID</span></div>";
                                                Location_Append += "</div>";
                                                $("#txthostID" + i1).show();
                                                document.getElementById("hdnMHostID").value = object[i].CartLocationHostID;
                                                $("#txthostID" + i1).val(document.getElementById("hdnMHostID").value);
                                                //}
                                            }
                                            else {
                                                Location_Append += "<div style='margin-top:7px;display:none;' id='divhostID" + i1 + "'> <span style ='margin-left:20px;font:12px Arial-Regular;color:#4d4d4d;'> Host ID / Name</span> <span style='color:red;'>*</span> <br /><input  type='text' style='margin-left:18px;width:218px;height:36px;display:none;padding-left:12px;margin-top:5px;' id='txthostID" + i1 + "' onkeyup='GetAssociateDeails(" + i1 + ")' class='textBox' placeholder='Host name /ID (M+ only)' disabled/>";
                                                Location_Append += "<div class='tooltip' style='margin-top:4%;margin-left:-8%;float:left;'><img id='imghostid" + i1 + "' src='images/New%20Images/img_trans.gif' style='display:none;' class='ImgHostID'/><span class='tooltiptext'>Host (M+ level) is responsible for entire Client Visit. Host must also collect/return the Smart Badges of Clients from/to Security Desk.</span></div></div>";
                                                $("#txthostID" + i1).hide();
                                            }

                                            Location_Append += "<div class='Dataccessdiv' id='divdataaccess" + i1 + "' style='display:none;'>";
                                            Location_Append += "<a href='#' style='color:#0033a0; font:13px Arial-Regular;' onclick='OpenDatacenterform()'>Fill Datacenter Access Details</a>";
                                            Location_Append += "</div>";
                                            Location_Append += "<div class='AddmoreDiv1' onclick='RemoveExtraLocation(" + i1 + ")' style='color:#f4633a;'>";
                                            Location_Append += "<img src='images/New%20Images/img_trans.gif' class='Removeicon' /> Remove Location";
                                            Location_Append += "</div>";
                                            Location_Append += "</div>";
                                            $("#Locationdetails").append(Location_Append);
                                            $("#ddllocationlist" + i1).css("width", "240px");
                                            $("#ddllocationlist" + i1).css("height", "36px");
                                            $("#ddllocationlist" + i1).css("padding-left", "2px");
                                            $("#AddMoreLocation").attr("onclick", "AddExtraLocation(" + i1 + ")");
                                            $("#AddMoreLocation").css("margin-left", "127px");
                                            var Location = object[i].CartLocationNameID;
                                            $.ajax({
                                                type: "POST",
                                                url: "HomePage.aspx/GetLocation",
                                                contentType: "application/json;charset=utf-8",
                                                data: "{}",
                                                async: false,
                                                dataType: "json",
                                                success: function (data) {
                                                    var locationData = JSON.parse(data.d);
                                                    var Location_Append1 = "";
                                                    Location_Append1 += "<option>Select Visiting Location</option>";
                                                    for (var i = 0; i < locationData.length; i++) {
                                                        Location_Append1 += "<option value=" + locationData[i].Countrydesc + ">" + locationData[i].Country + "</option>";
                                                    }
                                                    $("#ddllocationlist" + i1).html(Location_Append1);
                                                    $("#ddllocationlist" + i1).select2({
                                                        matcher: function (params, data) {
                                                            if ($.trim(params.term) === '') { return data; }
                                                            if (typeof data.text === 'undefined') { return null; }
                                                            var q = params.term.toLowerCase();
                                                            if (data.text.toLowerCase().indexOf(q) > -1 || data.id.toLowerCase().indexOf(q) > -1) {
                                                                return $.extend({}, data, true);
                                                            }
                                                            return null;
                                                        }
                                                    });
                                                    $(function () {
                                                        $("#ddllocationlist" + i1).val(Location);
                                                        $("#ddllocationlist" + i1).trigger('change');
                                                    });
                                                },
                                                error: function (result) {
                                                    $("#fade").hide();
                                                    $("#modal").hide();

                                                }
                                            });
                                            //$("#Locationdetails" + LocationCount).focus();
                                            $("#txtstarttime" + i1).kendoTimePicker({
                                                dateInput: true,
                                                value: object[i].CartLocationStartTime,
                                                interval: 15,
                                                format: "HH:mm"
                                            });
                                            $("#txtendtime" + i1).kendoTimePicker({
                                                dateInput: true,
                                                value: object[i].CartLocationEndTime,
                                                interval: 15,
                                                format: "HH:mm"
                                            });
                                            $('#txtvisitdate' + i1).datepicker({
                                                clearBtn: true,
                                                multidate: true,
                                                todayHighlight: true,
                                                startDate: "new Date()"
                                            });
                                            var splitcammadate = object[i].CartLocationDate.split(',');
                                            ////var sp = "";
                                            //for (var p = 0; p < splitcammadate.length; p++) {
                                            $('#txtvisitdate' + i1).datepicker('setDate', splitcammadate);
                                            $("#imgdate" + i1).on("click", function (e) {
                                                ;
                                                $('#txtvisitdate' + i1).datepicker('show');
                                            });
                                            $('.MainLocationdetails').slimScroll({
                                                height: '486px',
                                                width: '100%'
                                            });
                                        }

                                    },
                                    error: function (result) {
                                        $("#fade").hide();
                                        $("#modal").hide();

                                    }
                                });
                            }
                        },
                        error: function (result) {
                            $("#fade").hide();
                            $("#modal").hide();
                        }
                    });
                },
                error: function (result) {
                    $("#fade").hide();
                    $("#modal").hide();
                }
            });
            $("#fade").hide();
            $("#modal").hide();
        },
        error: function (result) {
            $("#fade").hide();
            $("#modal").hide();
        }
    });
    document.getElementById("hdnCartID").value = ID;
    $("#txtSerachbox").attr("disabled", "disabled");
    $("#btnSearch").attr("disabled", "disabled");
}

function DeleteCart(ID) {
    document.getElementById("Confirmmessage").style.display = "block";
    $("#btnYesdelete").attr("onclick", "YesDelete(" + ID + ",'0','Cartdelete')");
    $("#Confirmmessagebody").html("Are you sure you want to delete this entry from cart ?");
}

function UserSelectChange(ID) {
    if ($("#tdchkselect" + ID).prop('checked') == true) {
        $("#tr" + ID).css("background-color", "#E3EEF2");
        $(".btnAddCart").css("pointer-events", "visible");
        $(".btnAddCart").css("background-color", "#00b140");
        $(".btnAddCart").removeAttr("disabled");
        //$("#tdtxtvisitorName" + ID).css("color", "#334151");
        //$("#tdtxtvisitorName" + ID).css("font", "14px Arial-Regular");
        //$("#tdtxtcompany" + ID).css("color", "#334151");
        //$("#tdtxtcompany" + ID).css("font", "14px Arial-Regular");
        //$("#tdtxtvisitortype" + ID).css("color", "#334151");
        //$("#tdtxtvisitortype" + ID).css("font", "14px Arial-Regular");
        //$("#tdtxtCountryCode" + ID).css("color", "#334151");
        //$("#tdtxtCountryCode" + ID).css("font", "14px Arial-Regular");
        //$("#tdtxtmobileno" + ID).css("color", "#334151");
        //$("#tdtxtmobileno" + ID).css("font", "14px Arial-Regular");
        //$("#tdaequipment" + ID).css("color", "#334151");
        //$("#tdaequipment" + ID).css("font", "14px Arial-Regular");


    }
    else {
        $("#tr" + ID).css("background-color", "#ffffff");
        //$("#tdtxtvisitorName" + ID).css("color", "#596679");
        //$("#tdtxtvisitorName" + ID).css("font", "14px Arial-Regular");
        //$("#tdtxtcompany" + ID).css("color", "#596679");
        //$("#tdtxtcompany" + ID).css("font", "14px Arial-Regular");
        //$("#tdtxtvisitortype" + ID).css("color", "#596679");
        //$("#tdtxtvisitortype" + ID).css("font", "14px Arial-Regular");
        //$("#tdtxtCountryCode" + ID).css("color", "#596679");
        //$("#tdtxtCountryCode" + ID).css("font", "14px Arial-Regular");
        //$("#tdtxtmobileno" + ID).css("color", "#596679");
        //$("#tdtxtmobileno" + ID).css("font", "14px Arial-Regular");
        //$("#tdaequipment" + ID).css("color", "#596679");
        //$("#tdaequipment" + ID).css("font", "14px Arial-Regular");
        var chkArray = [];
        $(".dataaccesscheckbox:checked").each(function () {
            chkArray.push($(this).val());
        });
        var selected;
        selected = chkArray.join(',');
        var selectedspilt = "";
        if (selected != "" && selected != null && selected != undefined) {
            selectedspilt = selected.split(',');
        }
        if (selectedspilt.length == 0) {
            $(".btnAddCart").css("pointer-events", "none");
            $(".btnAddCart").css("background-color", "#d9d9d9");
        }
    }
}

function OpenEquipment(ID, ID1) {
    var euipmqntUniqID = $("#tdaequipment" + ID).attr("name");
    var euipmqntUniqIDtest = $("#tdaequipment" + ID).text();
    var euipmqntUniqIDtest1 = $("#tdaequipment").text();
    var euipmqntUniqID1 = $("#tdaequipment").attr("name");
    if (euipmqntUniqID == "" || euipmqntUniqID == "0" || parseInt(euipmqntUniqID) == 0 || euipmqntUniqID == undefined) {
        ID = ID;
        $("#btnequipsubmit").attr("onclick", "SubmitEquipmentDetails(" + ID + ")");
    }
    else {
        $("#btnequipsubmit").attr("onclick", "SubmitEquipmentDetails(" + ID + ")");
        ID = euipmqntUniqID;
    }

    $("#txtlaptopMake").val("");
    $("#txtlaptopModel").val("");
    $("#txtlaptopserial").val("");
    $("#txtdatastoragedeviceMake").val("");
    $("#txtdatastoragedeviceModel").val("");
    $("#txtdatastoragedeviceSerial").val("");
    $("#txtUSBharddiskMake").val("");
    $("#txtUSBharddiskModel").val("");
    $("#txtUSBharddiskSerial").val("");
    $("#txtcameraMake").val("");
    $("#txtcameraModel").val("");
    $("#txtcameraSerial").val("");
    $("#txtIPodMake").val("");
    $("#txtIPodModel").val("");
    $("#txtIPodSerial").val("");
    $("#txtotherMake").val("");
    $("#txtotherModel").val("");
    $("#txtotherSerial").val("");

    if (euipmqntUniqID != "-1" && euipmqntUniqID != undefined && euipmqntUniqIDtest != "No" || euipmqntUniqID1 != "-1" && euipmqntUniqID1 != undefined && euipmqntUniqIDtest1 != "No") {
        $.ajax({
            type: "POST",
            url: "HomePage.aspx/GetDummyEquipmentDetails",
            contentType: "application/json;charset=utf-8",
            data: '{"cartID":"' + ID + '"}',
            dataType: "json",
            success: function (data) {
                var jsondata = JSON.parse(data.d);
                for (var i = 0; i < jsondata.length; i++) {
                    if (jsondata[i].EquipmentType == "Laptop") {
                        $("#txtlaptopMake").val(jsondata[i].EquipmentMake);
                        $("#txtlaptopModel").val(jsondata[i].EquipmentModel);
                        $("#txtlaptopserial").val(jsondata[i].EquipmentSerial);
                    }
                    if (jsondata[i].EquipmentType == "Data Storage Device") {
                        $("#txtdatastoragedeviceMake").val(jsondata[i].EquipmentMake);
                        $("#txtdatastoragedeviceModel").val(jsondata[i].EquipmentModel);
                        $("#txtdatastoragedeviceSerial").val(jsondata[i].EquipmentSerial);
                    }
                    if (jsondata[i].EquipmentType == "USB Hard Disk") {
                        $("#txtUSBharddiskMake").val(jsondata[i].EquipmentMake);
                        $("#txtUSBharddiskModel").val(jsondata[i].EquipmentModel);
                        $("#txtUSBharddiskSerial").val(jsondata[i].EquipmentSerial);
                    }
                    if (jsondata[i].EquipmentType == "Camera") {
                        $("#txtcameraMake").val(jsondata[i].EquipmentMake);
                        $("#txtcameraModel").val(jsondata[i].EquipmentModel);
                        $("#txtcameraSerial").val(jsondata[i].EquipmentSerial);
                    }
                    if (jsondata[i].EquipmentType == "I Pod") {
                        $("#txtIPodMake").val(jsondata[i].EquipmentMake);
                        $("#txtIPodModel").val(jsondata[i].EquipmentModel);
                        $("#txtIPodSerial").val(jsondata[i].EquipmentSerial);
                    }
                    if (jsondata[i].EquipmentType == "Others") {
                        $("#txtotherMake").val(jsondata[i].EquipmentMake);
                        $("#txtotherModel").val(jsondata[i].EquipmentModel);
                        $("#txtotherSerial").val(jsondata[i].EquipmentSerial);
                    }
                }
                var span = document.getElementsByClassName("close")[0];
                var modal = document.getElementById('myModal');
                modal.style.display = "block";
            },
        });
        ////$("#btnequipsubmit").attr("onclick", "SubmitEquipmentDetails(" + ID + ")");
    }
    else {
        var span = document.getElementsByClassName("close")[0];
        var modal = document.getElementById('myModal');
        modal.style.display = "block";
    }
}

function OpenEquipmentModel() {
    var span = document.getElementsByClassName("close")[0];
    var modal = document.getElementById('myModal');
    if (!$("#tdchkeuipment0").is(':checked')) {
        modal.style.display = "none";
    }
    else {
        modal.style.display = "block";
    }
}

//function SaveNewVisitorTableRow(id) {
//    $("#fade").show();
//    $("#modal").show();
//    var Visitordrop = document.getElementById("ddlpurpose");
//    var VisitorType = Visitordrop.options[Visitordrop.selectedIndex].text;
//    if (VisitorType == "Select Visitor Type") {
//        $("#spnerror").text("* Error : Select Visitor Type");
//        $("#ddlpurpose").css('border-color', '#f4633a');
//        $("#spnerror").show();
//        $("#fade").hide();
//        $("#modal").hide();
//        return false;
//    }
//    var Others = "";
//    if (VisitorType == "Others") {
//        Others = $("#txtothers").val();
//        if (Others == null || Others == "" || Others == undefined) {
//            $("#spnerror").text("* Error : Enter Other text");
//            $("#txtothers").css('border-color', '#f4633a');
//            $("#spnerror").show();
//            $("#fade").hide();
//            $("#modal").hide();
//            return false;
//        }
//    }
//    var MobileNo = $("#tdtxtCountryCode" + id).val() + '-' + $("#tdtxtmobileno" + id).val();
//    if (MobileNo == "" || MobileNo == null || MobileNo == undefined) {
//        $("#spnerror").text("* Error : Enter Mobile Number");
//        $("#tdtxtmobileno" + id).css('border-color', '#f4633a');
//        $("#spnerror").show();
//        $("#fade").hide();
//        $("#modal").hide();
//        return false;
//    }
//    var code = $("#tdtxtCountryCode" + id).val();
//    var mob = $("#tdtxtmobileno" + id).val();
//    if (code == "+91") {
//        if (mob.length < 10 || mob.length > 10) {
//            $("#spnerror").text("*Error : Enter Valid Mobile Number");
//            $("#tdtxtmobileno" + id).css('border-color', '#f4633a');
//            $("#spnerror").show();
//            $("#fade").hide();
//            $("#modal").hide();
//            return false;
//        }
//    }
//    if (isNaN(mob)) {
//        $("#spnerror").text("* Error : Enter Only number");
//        $("#tdtxtmobileno" + id).css('border-color', '#f4633a');
//        $("#spnerror").show();
//        $("#fade").hide();
//        $("#modal").hide();
//        return false;
//    }
//    var iszero = /^0*$/.test(mob);
//    if (iszero == true) {
//        $("#spnerror").text("*Error : Enter Valid Mobile Number");
//        $("#tdtxtmobileno" + id).css('border-color', '#f4633a');
//        $("#spnerror").show();
//        $("#fade").hide();
//        $("#modal").hide();
//        return false
//    }
//    var Name = $("#tdtxtvisitorName" + id).val();
//    if (Name == "" || Name == null || Name == undefined) {
//        $("#spnerror").text("* Error : Enter Name");
//        $("#tdtxtvisitorName" + id).css('border-color', '#f4633a');
//        $("#spnerror").show();
//        $("#fade").hide();
//        $("#modal").hide();
//        return false;
//    }
//    var Organization = $("#tdtxtcompany" + id).val();
//    if (VisitorType != "Family Members") {
//        if (Organization == "" || Organization == null || Organization == undefined) {
//            $("#spnerror").text("*Error : Enter Organization");
//            $("#tdtxtcompany" + id).css('border-color', '#f4633a');
//            $("#spnerror").show();
//            $("#fade").hide();
//            $("#modal").hide();
//            return false;
//        }
//    }
//    else {
//        if (Organization == "Optional") {
//            Organization = "";
//        }
//    }
//    var IsEquipmentcheck = $("#tdaequipment" + id).text();
//    var IsEquipment = "";
//    if (IsEquipmentcheck == "Yes") {
//        IsEquipment = "1";
//    }
//    else if (IsEquipmentcheck == "No") {
//        IsEquipment = "0";
//    }
//    else {
//        IsEquipment = "0";
//    }
//    $.ajax({
//        type: "POST",
//        url: "HomePage.aspx/InsertMasterData",
//        contentType: "application/json;charset=utf-8",
//        data: '{"name":"' + Name + '","company":"' + Organization + '","purpose":"' + VisitorType + '","mobilenumber":"' + MobileNo + '","isequipment":"' + IsEquipment + '","others":"' + Others + '"}',
//        dataType: "json",
//        success: function (data) {
//            var jsondata = JSON.parse(data.d);         
//            $("#tdtxtvisitorName" + id).removeClass("Recentvisitortableaftertextbox");
//            $("#tdtxtvisitorName" + id).addClass("Recentvisitortabletextbox");
//            $("#tdtxtvisitorName" + id).attr("disabled", "disabled");
//            $("#tdtxtCountryCode" + id).removeClass("Recentvisitortableaftertextbox");
//            $("#tdtxtCountryCode" + id).addClass("Recentvisitortabletextbox");
//            $("#tdtxtCountryCode" + id).attr("disabled", "disabled");
//            $("#tdtxtmobileno" + id).removeClass("Recentvisitortableaftertextbox");
//            $("#tdtxtmobileno" + id).addClass("Recentvisitortabletextbox");
//            $("#tdtxtmobileno" + id).attr("disabled", "disabled");
//            $("#tdtxtvisitorName" + id).removeClass("Recentvisitortableaftertextbox");
//            $("#tdtxtvisitorName" + id).addClass("Recentvisitortabletextbox");
//            $("#tdtxtvisitorName" + id).attr("disabled", "disabled");
//            $("#tdtxtcompany" + id).removeClass("Recentvisitortableaftertextbox");
//            $("#tdtxtcompany" + id).addClass("Recentvisitortabletextbox");
//            $("#tdtxtcompany" + id).attr("disabled", "disabled");
//            $("#tdtxtvisitortype" + id).removeClass("Recentvisitortableaftertextbox");
//            $("#tdtxtvisitortype" + id).addClass("Recentvisitortabletextbox");
//            $("#tdtxtvisitortype" + id).attr("disabled", "disabled");
//            //if (parseInt(jsondata) == 1) {
//            //    $("#tdchkeuipment" + id).prop("checked", true);
//            //}
//            //else {
//            //    $("#tdchkeuipment" + id).prop("checked", false);
//            //}
//            $("#tdchkselect" + id).prop("checked", true);
//            $(".Recentvisitortablebodytrodd").css("background-color", "#E3EEF2");
//            $(".btnAddCart").css("pointer-events", "visible");
//            $(".btnAddCart").css("background-color", "#00b140");
//            $("#tdtxtvisitorName" + id).css("color", "#334151");
//            $("#tdtxtvisitorName" + id).css("font", "14px Proxima-Nova-Sbold");
//            $("#tdtxtcompany" + id).css("color", "#334151");
//            $("#tdtxtcompany" + id).css("font", "14px Proxima-Nova-Sbold");
//            $("#tdtxtvisitortype" + id).css("color", "#334151");
//            $("#tdtxtvisitortype" + id).css("font", "14px Proxima-Nova-Sbold");
//            $("#tdtxtCountryCode" + id).css("color", "#334151");
//            $("#tdtxtCountryCode" + id).css("font", "14px Proxima-Nova-Sbold");
//            $("#tdtxtmobileno" + id).css("color", "#334151");
//            $("#tdtxtmobileno" + id).css("font", "14px Proxima-Nova-Sbold");
//            $("#tdaequipment" + id).css("color", "#334151");
//            $("#tdaequipment" + id).css("font", "14px Proxima-Nova-Sbold");
//            $("#fade").hide();
//            $("#modal").hide();
//            $("#spnerror").hide();
//            $("#tdtxtmobileno0").css("border-color", "transparent");
//            $("#tdtxtcompany0").css("border-color", "transparent");
//            $("#tdtxtvisitorName0").css("border-color", "transparent");
//            $("#ddlpurpose").css("border", "1px solid #d6d6d6");
//            document.getElementById("hdnnewvisitor").value = "";
//            $("#tdimgsave0").hide();
//            $("#tdimgedit0").hide();
//        },
//        error: function (result) {
//            $("#fade").hide();
//            $("#modal").hide();
//        }
//    });
//}

function countrycodechange(ID) {
    var id = $("#tdtxtCountryCode" + ID + " option:selected").text();
    if (id == "+91") {
        $("#tdtxtmobileno" + ID).attr('maxlength', '10');
        var Countrycode = document.getElementById("tdtxtCountryCode" + ID + "");
        var Countrycodetext = Countrycode.options[Countrycode.selectedIndex].text;
        var mobile = $("#tdtxtmobileno" + ID).val();
        if (Countrycodetext == "+91") {
            if (mobile.length > 10 || mobile.length < 10) {
                $("#spnerrorspan").text("Enter Valid Mobile Number.");
                $("#tdtxtmobileno" + ID).css('border-color', '#f4633a');
                $("#spnerror").show();
                $("#fade").hide();
                $("#modal").hide();
                return false;
            }
            else {
                $("#tdtxtmobileno" + ID).css('border', '1px solid #d6d6d6');
                $("#spnerror").hide();
            }
        }
        else {
            if (mobile.length > 1) {
                $("#tdtxtmobileno" + ID).css('border', '1px solid #d6d6d6');
                $("#spnerror").hide();
            }
        }
    }
    else {
        $("#tdtxtmobileno" + ID).attr('maxlength', '14');
        var Countrycode = document.getElementById("tdtxtCountryCode" + ID + "");
        var Countrycodetext = Countrycode.options[Countrycode.selectedIndex].text;
        var mobile = $("#tdtxtmobileno" + ID).val();
        if (Countrycodetext == "+91") {
            if (mobile.length > 10 || mobile.length < 10) {
                $("#spnerrorspan").text("Enter Valid Mobile Number.");
                $("#tdtxtmobileno" + ID).css('border-color', '#f4633a');
                $("#spnerror").show();
                $("#fade").hide();
                $("#modal").hide();
                return false;
            }
            else {
                $("#tdtxtmobileno" + ID).css('border', '1px solid #d6d6d6');
                $("#spnerror").hide();
            }
        }
        else {
            if (mobile.length > 1) {
                $("#tdtxtmobileno" + ID).css('border', '1px solid #d6d6d6');
                $("#spnerror").hide();
            }
        }
    }
}

function EditnewTableRow() {
    $("#tdimgsave0").hide();
    $("#tdimgedit0").hide();
    //$("#tdtxtvisitorName0").addClass("Recentvisitortableaftertextbox");
    //        $("#tdtxtvisitorName0").removeClass("Recentvisitortabletextbox");

    //        $("#tdtxtCountryCode0").removeClass("Recentvisitortableaftertextbox");
    //        $("#tdtxtCountryCode0").addClass("Recentvisitortabletextbox");

    //        $("#tdtxtmobileno0").removeClass("Recentvisitortableaftertextbox");
    //        $("#tdtxtmobileno0").addClass("Recentvisitortabletextbox");                               


    //        $("#tdtxtcompany0").removeClass("Recentvisitortableaftertextbox");
    //        $("#tdtxtcompany0").addClass("Recentvisitortabletextbox");
    //        $("#tdtxtcompany0").attr("disabled", "disabled");
    //        $("#tdtxtvisitortype0").removeClass("Recentvisitortableaftertextbox");
    //        $("#tdtxtvisitortype0").addClass("Recentvisitortabletextbox");
    //        $("#tdtxtvisitortype0").attr("disabled", "disabled");
    //        //if (parseInt(jsondata) == 1) {
    //        //    $("#tdchkeuipment" + id).prop("checked", true);
    //        //}
    //        //else {
    //        //    $("#tdchkeuipment" + id).prop("checked", false);
    //        //}
    //        $("#tdchkselect0").prop("checked", true);
    //        $(".Recentvisitortablebodytrodd").css("background-color", "#E3EEF2")
}

function DeleteAll() {
    document.getElementById("Confirmmessage").style.display = "block";
    $("#btnYesdelete").attr("onclick", "YesDelete('0','0','DeleteAllnew')");
    $("#Confirmmessagebody").html("You are about to delete all the visitor entry. Would you like to continue ?");
}

function AddNewvistor() {
    var isnewvisitor = document.getElementById("hdnnewvisitor").value;
    if (isnewvisitor == null || isnewvisitor == "" || isnewvisitor == undefined) {
        $("#RecentVisitortablebody").html("");
        isnewvisitor = "0";
    }
    else {
    }
    isnewvisitor = parseInt(isnewvisitor) + 1;
    document.getElementById("hdnnewvisitor").value = isnewvisitor;
    $("#fade").show();
    $("#modal").show();
    document.getElementById("hdnCartID").value = "";
    $(".btnAddCart").removeAttr("disabled");
    //$.ajax({
    //    type: "POST",
    //    url: "HomePage.aspx/GetVistorType",
    //    contentType: "application/json;charset=utf-8",
    //    data: "{}",
    //    dataType: "json",
    //    success: function (data) {
    //        var PurposeData = JSON.parse(data.d);
    if (parseInt(isnewvisitor) <= 20) {
        var RecentData_append = "";
        RecentData_append += "<tr id='newvisitor" + isnewvisitor + "' class='Recentvisitortablebodytrodd'>";
        RecentData_append += "<td style='width:44px;text-align:center;'>";
        RecentData_append += "<input type='checkbox' value='" + isnewvisitor + "' class='dataaccesscheckbox' id='tdchkselect" + isnewvisitor + "' checked>";
        RecentData_append += "</td>";
        RecentData_append += "<td class='Recentvisitortabletd' style='width:168px;'>";
        RecentData_append += "<input type='text' maxlength='25' id='tdtxtvisitorName" + isnewvisitor + "' class='Recentvisitortableaftertextbox' placeholder='Visitor Name' />";
        RecentData_append += "</td>";
        RecentData_append += "<td class='Recentvisitortabletd' style='width:223px;'>";
        RecentData_append += "<select type='text' id='tdtxtCountryCode" + isnewvisitor + "' onchange='countrycodechange(" + isnewvisitor + ")' class='Recentvisitortableaftertextbox' style='width:60px;margin-left:0px !important;'></select>-<input id='tdtxtmobileno" + isnewvisitor + "' style='margin-left:0%;width:84px;' maxlength='10'  class='Recentvisitortableaftertextbox' type='text' onkeypress='return isNumberKey(event)' onfocusout='return isvalidmobile(" + isnewvisitor + ")' placeholder='Mobile No' />";
        RecentData_append += "</td>";
        var Visitordrop = document.getElementById("ddlpurpose");
        var VisitorType = Visitordrop.options[Visitordrop.selectedIndex].text;
        RecentData_append += "<td class='Recentvisitortabletd' style='width:158px;'>";
        if (VisitorType == "Family Members") {
            RecentData_append += "<input type='text' maxlength='25' id='tdtxtcompany" + isnewvisitor + "' class='changecomany Recentvisitortableaftertextbox' value='Optional'  placeholder='Organization' />";
        }
        else if (VisitorType == "Interview Candidate") {
            RecentData_append += "<input type='text' maxlength='25' id='tdtxtcompany" + isnewvisitor + "' class='changecomany Recentvisitortableaftertextbox' value='Interview'  placeholder='Organization' />";
        }
        else if (VisitorType == "Others") {
            RecentData_append += "<input type='text' maxlength='25' id='tdtxtcompany" + isnewvisitor + "' class='changecomany Recentvisitortableaftertextbox' value='" + $("#txtothers").val() + "'  placeholder='Organization' />";
        }
        else {
            RecentData_append += "<input type='text' maxlength='25' id='tdtxtcompany" + isnewvisitor + "' class='changecomany Recentvisitortableaftertextbox'  placeholder='Organization' />";
        }
        RecentData_append += "</td>";
        RecentData_append += "<td class='Recentvisitortabletd' style='width:150px;'>";;
        RecentData_append += "<select id='tdtxtvisitortype" + isnewvisitor + "' class='changename Recentvisitortableaftertextbox' disabled style='border-color:transparent;-webkit-appearance:none;'>";
        RecentData_append += "<option>" + VisitorType + "</option>";
        //for (var i = 0; i < PurposeData.length; i++) {
        //    if (PurposeData[i] != "Guests" && PurposeData[i] != "Former Employee" && PurposeData[i] != "Associate Driver" && PurposeData[i] != "Auditors" && PurposeData[i] != "New Joinee" && PurposeData[i] != "Business Partner" && PurposeData[i] != "Select Purpose") {
        //        RecentData_append += "<option>" + PurposeData[i] + "</option>";
        //    }
        //}
        RecentData_append += "</select>";
        RecentData_append += "</td>";

        RecentData_append += "<td class='Recentvisitortabletd' style='width:120px;'>";
        RecentData_append += "<a id='tdaequipment" + isnewvisitor + "' title='Please click here to add equipment details' href='#' style='color:rgb(0, 114, 143);cursor:pointer;text-decoration:underline;' onclick='OpenEquipment(" + isnewvisitor + ")' name='0'>No</a>";
        RecentData_append += "</td>";
        RecentData_append += "<td style='width:48px;text-align:center;'>";
        //RecentData_append += "<img id='tdimgedit0' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;display:none;' onclick='EditnewTableRow()' />";
        if (parseInt(isnewvisitor) == 1) {
            //$("#tdDeleteall").html("<img title='Add More' src='images/New%20Images/img_trans.gif' style='height:20px;width:20px;cursor:pointer; background: url(images/New%20Images/VMS-Icons.png) no-repeat -117px -95px;margin-left:4%;margin-right:6%;' onclick='AddNewvistor()' />");
            RecentData_append += "<img id='tdimgcancel" + isnewvisitor + "' title='Delete' src='images/New%20Images/img_trans.gif' style='height:20px;width:20px;cursor:pointer; background: url(images/New%20Images/VMS-Icons.png) no-repeat -288px -163px;' onclick='CancelNewTableRow(" + isnewvisitor + ")' />";
        }
        else {
            $("#tdDeleteall").html("<img src='images/New%20Images/img_trans.gif' title='Delete All' style='height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -203px -94px;margin-left:15px;' onclick='DeleteAll()' />");
            RecentData_append += "<img id='tdimgcancel" + isnewvisitor + "' title='Delete' src='images/New%20Images/img_trans.gif' style='height:20px;width:20px;cursor:pointer; background: url(images/New%20Images/VMS-Icons.png) no-repeat -288px -163px;margin-left:4px;' onclick='CancelNewTableRow(" + isnewvisitor + ")' />";
        }
        RecentData_append += "</td>";
        RecentData_append += "</tr >";
        $("#RecentVisitortablebody").append(RecentData_append);
        $('.divRecentvisitor').slimScroll({
            height: '432px',
            width: '100%'
        });
        $.ajax({
            type: "POST",
            url: "HomePage.aspx/GetCountryCode",
            contentType: "application/json;charset=utf-8",
            data: "{}",
            dataType: "json",
            success: function (data) {
                ////debugger;
                var Locationdata = JSON.parse(data.d);
                var RecentData_append = "";
                for (var i = 0; i < Locationdata.length; i++) {
                    RecentData_append += "<option value=" + Locationdata[i].Country + ">+" + Locationdata[i].Code + "</option>";
                }
                $("#tdtxtCountryCode" + isnewvisitor + "").html(RecentData_append);
                $('#tdtxtCountryCode' + isnewvisitor).select2({
                    matcher: function (params, data) {
                        if ($.trim(params.term) === '') { return data; }
                        if (typeof data.text === 'undefined') { return null; }
                        var q = params.term.toLowerCase();
                        if (data.text.toLowerCase().indexOf(q) > -1 || data.id.toLowerCase().indexOf(q) > -1) {
                            return $.extend({}, data, true);
                        }
                        return null;
                    }
                });

                $('#tdtxtCountryCode' + isnewvisitor).val("India");
                $('#tdtxtCountryCode' + isnewvisitor).trigger('change');
            },
            error: function (result) {
                $("#fade").hide();
                $("#modal").hide();
            }
        });
        $(".btnAddCart").html("<img src='images/New%20Images/img_trans.gif' class='addtocarticon'>&nbsp; Add to Cart");
        $(".btnAddCart").css("background-color", "#00b140");
        $(".btnAddCart").css("pointer-events", "visible");
        //$("#btnSearch").text("Search");
        $("#txtSerachbox").val("");
        $("#txtSerachbox").removeAttr("disabled");
        $("#btnSearch").removeAttr("disabled");
    }
    else {
        document.getElementById('Sucessmessage').style.display = 'block';
        $("#Sucessmessageheader").text("Error!");
        $("#Sucessmessagebody").html("You have reached the maximum number of visitors (20 visitors/request) .");
        $('.divRecentvisitor').slimScroll({
            height: '432px',
            width: '100%'
        });
    }
    $("#fade").hide();
    $("#modal").hide();
    //var Visitordrop = document.getElementById("ddlpurpose");
    //var VisitorType = Visitordrop.options[Visitordrop.selectedIndex].text;
    //$("#tdtxtvisitortype0").val(VisitorType);

    //    },
    //    error: function (result) {
    //        $("#fade").hide();
    //        $("#modal").hide();
    //    }
    //})
    // }
    //else {

    //  var r = confirm("You are about to add a new visitor. Already entered visitor details will get reset. Would you like to continue ?");
    //if (r == true) {
    //  $("#fade").show();
    //$("#modal").show();
    //document.getElementById("hdnCartID").value = "";
    //$.ajax({
    //    type: "POST",
    //    url: "HomePage.aspx/GetVistorType",
    //    contentType: "application/json;charset=utf-8",
    //    data: "{}",
    //    dataType: "json",
    //    success: function (data) {
    //        var PurposeData = JSON.parse(data.d);
    //var RecentData_append = "";
    // RecentData_append += "<tr class='Recentvisitortablebodytrodd'>";
    //RecentData_append += "<td style='width:44px;text-align:center;'>";
    // RecentData_append += "<input type='checkbox' value='0' class='dataaccesscheckbox' id='tdchkselect0' checked>";
    // RecentData_append += "</td>";
    // RecentData_append += "<td class='Recentvisitortabletd' style='width:168px;'>";
    //RecentData_append += "<input type='text' id='tdtxtvisitorName0' class='Recentvisitortableaftertextbox' placeholder='Visitor Name' />";
    //RecentData_append += "</td>";
    //RecentData_append += "<td class='Recentvisitortabletd' style='width:158px;'>";
    // RecentData_append += "<input type='text' id='tdtxtcompany0' class='Recentvisitortableaftertextbox'  placeholder='Organization' />";
    //RecentData_append += "</td>";
    /// RecentData_append += "<td class='Recentvisitortabletd' style='width:150px;'>";
    // var Visitordrop = document.getElementById("ddlpurpose");
    // var VisitorType = Visitordrop.options[Visitordrop.selectedIndex].text;
    // RecentData_append += "<select id='tdtxtvisitortype0' class='Recentvisitortableaftertextbox' disabled>";
    // RecentData_append += "<option>" + VisitorType + "</option>";
    //for (var i = 0; i < PurposeData.length; i++) {
    //    if (PurposeData[i] != "Guests" && PurposeData[i] != "Former Employee" && PurposeData[i] != "Associate Driver" && PurposeData[i] != "Auditors" && PurposeData[i] != "New Joinee" && PurposeData[i] != "Business Partner" && PurposeData[i] != "Select Purpose") {
    //        RecentData_append += "<option>" + PurposeData[i] + "</option>";
    //    }
    //}
    //RecentData_append += "</select>";
    // RecentData_append += "</td>";
    // RecentData_append += "<td class='Recentvisitortabletd' style='width:223px;'>";
    // RecentData_append += "<select type='text' id='tdtxtCountryCode0' class='Recentvisitortableaftertextbox' style='width:51px'><option>+91</option></select>-<input id='tdtxtmobileno0' style='margin-left:2%;' maxlength='10'  class='Recentvisitortableaftertextbox' onkeypress='return isNumberKey(event)' onkeyup='return isvalidmobile(0)' type='text' placeholder='Mobile No' />";
    // RecentData_append += "</td>";
    //RecentData_append += "<td class='Recentvisitortabletd' style='width:120px;'>";
    // RecentData_append += "<a id='tdaequipment0' title='Please click here to add equipment details' href='#' style='color:rgb(0, 114, 143);cursor:pointer;text-decoration:underline;' onclick='OpenEquipment(0)' name='0'>No</a>";
    ///RecentData_append += "</td>";
    // RecentData_append += "<td style='width:48px;'>";
    //RecentData_append += "<img id='tdimgsave' src='images/New%20Images/img_trans.gif' style='height:20px;width:20px;cursor:pointer; background: url(images/New%20Images/VMS-Icons.png) no-repeat -37px -235px;' onclick='SaveNewVisitorTableRow(0)' />";
    /// RecentData_append += "<img id='tdimgcancel' src='images/New%20Images/img_trans.gif' style='height:20px;width:20px;cursor:pointer; background: url(images/New%20Images/VMS-Icons.png) no-repeat -288px -163px;' onclick='CancelNewTableRow()' />";
    // RecentData_append += "</td>";
    // RecentData_append += "</tr >";
    // $("#RecentVisitortablebody").html(RecentData_append);
    // $.ajax({
    //   type: "POST",
    //  url: "HomePage.aspx/GetCountryCode",
    //  contentType: "application/json;charset=utf-8",
    //  data: "{}",
    //  dataType: "json",
    //  success: function (data) {
    //     var Locationdata = JSON.parse(data.d);
    //       var RecentData_append = "";
    //     for (var i = 0; i < Locationdata.length; i++) {
    //     RecentData_append += "<option>+" + Locationdata[i] + "</option>";
    //  }
    //  $("#tdtxtCountryCode0").html(RecentData_append);
    //   $("#tdtxtCountryCode0").val("+91");
    //   },
    //   error: function (result) {
    //      $("#fade").hide();
    //    $("#modal").hide();
    //   }
    //   });
    //   $(".btnAddCart").html("<img src='images/New%20Images/img_trans.gif' class='addtocarticon'>&nbsp; Add to Cart");
    //   $(".btnAddCart").css("background-color", "#00b140");
    //   $(".btnAddCart").css("pointer-events", "visible");
    //   $("#btnSearch").text("Search");
    //   $("#txtSerachbox").val("");
    //   $("#txtSerachbox").removeAttr("disabled");
    //   $("#btnSearch").removeAttr("disabled");
    //   $("#fade").hide();
    //  $("#modal").hide();
    //var Visitordrop = document.getElementById("ddlpurpose");
    //var VisitorType = Visitordrop.options[Visitordrop.selectedIndex].text;
    //$("#tdtxtvisitortype0").val(VisitorType);

    //    },
    //    error: function (result) {
    //        $("#fade").hide();
    //        $("#modal").hide();
    //    }
    //});
    // }
    // }
}


function CancelNewTableRow(ID) {
    document.getElementById("Confirmmessage").style.display = "block";
    $("#btnYesdelete").attr("onclick", "YesDelete(" + ID + ",'0','CancelNewTableRow')");
    $("#Confirmmessagebody").html("Are you sure you want to delete the selected visitor(s).");
}

function GetSerachDetails(e) {
    // debugger;
    var searchtext = $("#txtSerachbox").val();
    //var btntext = $("#btnSearch").text();
    if (searchtext != null && searchtext != "" && searchtext != undefined) {
        //if (btntext == "Search") {
        $("#fade").show();
        $("#modal").show();
        $.ajax({
            type: "POST",
            url: "HomePage.aspx/GetSearchDetails",
            contentType: "application/json;charset=utf-8",
            data: "{'strSearchtext':'" + searchtext + "',pagenumber:" + parseInt(1) + ",sortcolumn:'Name',sortorder:'nameSort',pagesize:'" + 5 + "'}",
            dataType: "json",
            success: function (data) {
                var Recentdata = JSON.parse(data.d);
                var RecentData_append = "";
                if (Recentdata.length > 0) {
                    for (var i = 0; i < Recentdata.length; i++) {
                        //   debugger;
                        if (i % 2 == 0) {
                            RecentData_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Recentdata[i].VisitorId + "'>";
                        }
                        else {
                            RecentData_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Recentdata[i].VisitorId + "'>";
                        }
                        RecentData_append += "<td style='width:44px;text-align:center;'>";
                        RecentData_append += "<input type='checkbox'  value='" + Recentdata[i].VisitorId + "' class='dataaccesscheckbox' id='tdchkselect" + Recentdata[i].VisitorId + "' onchange='UserSelectChange(" + Recentdata[i].VisitorId + ")'>";
                        RecentData_append += "</td>";
                        RecentData_append += "<td class='Recentvisitortabletd' style='width:168px;'>";
                        RecentData_append += "<input type='text' maxlength='25' id='tdtxtvisitorName" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].Name + "' disabled />";
                        RecentData_append += "</td>";
                        RecentData_append += "<td class='Recentvisitortabletd' style='width:280px;'>";
                        if (Recentdata[i].MobileNo != null) {
                            var Mobile = Recentdata[i].MobileNo.split('-');
                            RecentData_append += "<select type='text' id='tdtxtCountryCode" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' style='width:28px;' disabled><option>" + Mobile[0] + "</option></select>-<input id='tdtxtmobileno" + Recentdata[i].VisitorId + "' style='margin-left:2%;width:80px;' maxlength='10' onkeypress='return isNumberKey(event)' onfocusout='return isvalidmobile(" + Recentdata[i].VisitorId + ")' class='Recentvisitortabletextbox' type='text' value='" + Mobile[1] + "' disabled />";
                        }
                        RecentData_append += "</td>";
                        RecentData_append += "<td class='Recentvisitortabletd' style='width:158px;'>";
                        RecentData_append += "<input type='text' maxlength='25' id='tdtxtcompany" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].Company + "' disabled />";
                        RecentData_append += "</td>";
                        RecentData_append += "<td class='Recentvisitortabletd' style='width:150px;'>";
                        RecentData_append += "<select type='text' id='tdtxtvisitortype" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' disabled ><option>" + Recentdata[i].VisitorType + "</option></select>";
                        RecentData_append += "</td>";

                        RecentData_append += "<td class='Recentvisitortabletd' style='width:120px;'>";
                        if (Recentdata[i].PermitITEquipments == true) {
                            RecentData_append += "<a title='Please click here to add equipment details' id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#00b140;cursor:pointer;text-decoration:underline;' onclick='OpenEquipment(" + Recentdata[i].VisitorId + ",0)' name='" + Recentdata[i].VisitorId + "'>Yes</a>";
                        }
                        else {
                            RecentData_append += "<a title='Please click here to add equipment details' id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#596679;cursor:pointer;' name='0'>No</a>";
                        }
                        RecentData_append += "</td>";
                        RecentData_append += "<td style='width:55px;text-align:center;'>";
                        RecentData_append += "<img id='tdimgsave" + Recentdata[i].VisitorId + "' title='Save' src='images/New%20Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;background: url(images/New%20Images/VMS-Icons.png) no-repeat -37px -235px;' onclick='SaveTableRow(" + Recentdata[i].VisitorId + ")' />";
                        RecentData_append += "<img id='tdimgcancel" + Recentdata[i].VisitorId + "' title='Cancel' src='images/New%20Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;  background: url(images/New%20Images/VMS-Icons.png) no-repeat -288px -163px;' onclick='CancelTableRow(" + Recentdata[i].VisitorId + ")' />";
                        RecentData_append += "<img id='tdimgedit" + Recentdata[i].VisitorId + "' title='Edit' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;' onclick='EditTableRow(" + Recentdata[i].VisitorId + ")' />";
                        RecentData_append += "</td>";
                        RecentData_append += "</tr >";
                    }
                }
                else {
                    RecentData_append += "<tr style='height:55px;'><td></td><td></td><td></td><td style='font:14px Arial-Regular;color:#596679;'>No record found.</td><td></td><td></td></tr>";
                }
                $("#RecentVisitortablebody").html(RecentData_append);
                $('.divRecentvisitor').slimScroll({
                    height: '432px',
                    width: '100%'
                });
                $("#fade").hide();
                $("#modal").hide();
            },
            error: function (result) {
                $("#fade").hide();
                $("#modal").hide();

            }
        });
        $(".dataaccesscheckbox1").prop("checked", false);
        //$("#btnSearch").text("Clear");
        //}
        //else {
        //    $.ajax({
        //        type: "POST",
        //        url: "HomePage.aspx/GetRecentVisitors",
        //        contentType: "application/json;charset=utf-8",
        //        data: "{'visitorCount':" + parseInt("10") + "}",
        //        dataType: "json",
        //        success: function (data) {
        //            var RecentData_append = "";
        //            if (data.d == "" || data.d == null || data.d == undefined) {
        //                $("#RecentVisitortablebody").html("<tr style='height:395px;'><td></td><td></td><td></td><td style='width:184px;color:#596679;font:14px Proxima-Nova-Sbold;'>No Recent Visitors Found</td><td></td><td></td><td></td></tr>");
        //                $("#fade").hide();
        //                $("#modal").hide();
        //            }
        //            else {
        //                var Recentdata = JSON.parse(data.d);
        //                if (Recentdata.length > 0) {
        //                    for (var i = 0; i < Recentdata.length; i++) {
        //                        if (i % 2 == 0) {
        //                            RecentData_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Recentdata[i].VisitorId + "'>";
        //                        }
        //                        else {
        //                            RecentData_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Recentdata[i].VisitorId + "'>";
        //                        }
        //                        RecentData_append += "<td style='width:44px;text-align:center;'>";
        //                        RecentData_append += "<input type='checkbox' value='" + Recentdata[i].VisitorId + "' class='dataaccesscheckbox' id='tdchkselect" + Recentdata[i].VisitorId + "' onchange='UserSelectChange(" + Recentdata[i].VisitorId + ")'>";
        //                        RecentData_append += "</td>";
        //                        RecentData_append += "<td class='Recentvisitortabletd' style='width:168px;'>";
        //                        RecentData_append += "<input type='text' id='tdtxtvisitorName" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].VisitorFullName + "' disabled />";
        //                        RecentData_append += "</td>";
        //                        RecentData_append += "<td class='Recentvisitortabletd' style='width:150px;'>";
        //                        RecentData_append += "<input type='text' id='tdtxtcompany" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].Company + "' disabled />";
        //                        RecentData_append += "</td>";
        //                        RecentData_append += "<td class='Recentvisitortabletd' style='width:158px;'>";
        //                        RecentData_append += "<select type='text' id='tdtxtvisitortype" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' disabled ><option>" + Recentdata[i].VisitorType + "</option></select>";
        //                        RecentData_append += "</td>";
        //                        RecentData_append += "<td class='Recentvisitortabletd' style='width:215px;'>";
        //                        var Mobile = Recentdata[i].MobileNo.split('-');
        //                        RecentData_append += "<select type='text' id='tdtxtCountryCode" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' style='width:40px;' disabled ><option>" + Mobile[0] + "</option></select>-<input id='tdtxtmobileno" + Recentdata[i].VisitorId + "' style='margin-left:2%;' maxlength='10' onkeypress='return isNumberKey(event)' onfocusout='return isvalidmobile(" + Recentdata[i].VisitorId + ")' class='Recentvisitortabletextbox' type='text' value='" + Mobile[1] + "' disabled />";
        //                        RecentData_append += "</td>";
        //                        RecentData_append += "<td class='Recentvisitortabletd' style='width:120px;'>";
        //                        if (Recentdata[i].PermitITEquipments == true) {
        //                            RecentData_append += "<a title='Please click here to add equipment details' id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#00b140;cursor:pointer;' onclick='OpenEquipment(" + Recentdata[i].VisitorId + ",0)' name='" + Recentdata[i].VisitorId + "'>Yes</a>";
        //                        }
        //                        else {
        //                            RecentData_append += "<a title='Please click here to add equipment details' id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#596679;cursor:pointer;' onclick='OpenEquipment(" + Recentdata[i].VisitorId + ",0)' name='0'>No</a>";
        //                        }
        //                        RecentData_append += "</td>";
        //                        RecentData_append += "<td style='width:48px;'>";
        //                        RecentData_append += "<img id='tdimgsave" + Recentdata[i].VisitorId + "' title='Save' src='images/New%20Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;  background: url(images/New%20Images/VMS-Icons.png) no-repeat -37px -235px;' onclick='SaveTableRow(" + Recentdata[i].VisitorId + ")' />";
        //                        RecentData_append += "<img id='tdimgcancel" + Recentdata[i].VisitorId + "' title='Cancel' src='images/New%20Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;  background: url(images/New%20Images/VMS-Icons.png) no-repeat -288px -163px;' onclick='CancelTableRow(" + Recentdata[i].VisitorId + ")' />";
        //                        RecentData_append += "<img id='tdimgedit" + Recentdata[i].VisitorId + "' title='Edit' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;' onclick='EditTableRow(" + Recentdata[i].VisitorId + ")' />";
        //                        RecentData_append += "</td>";
        //                        RecentData_append += "</tr >";
        //                    }
        //                    $("#RecentVisitortablebody").html(RecentData_append);
        //                    $('.divRecentvisitor').slimScroll({
        //                        height: '432px',
        //                        width: '100%'
        //                    });
        //                }
        //                else {
        //                    $("#fade").hide();
        //                    $("#modal").hide();
        //                }
        //            }

        //        },
        //        error: function (result) {
        //            $("#fade").hide();
        //            $("#modal").hide();
        //        }
        //    });
        //    $("#btnSearch").text("Search");
        //    $("#txtSerachbox").val("");
        //}
    }
}

function CancelTableRow(ID) {
    $("#tdtxtvisitorName" + ID).attr("disabled");
    $("#tdtxtvisitorName" + ID).removeClass("Recentvisitortableaftertextbox");
    $("#tdtxtvisitorName" + ID).addClass("Recentvisitortabletextbox");
    $("#tdtxtcompany" + ID).attr("disabled");
    $("#tdtxtcompany" + ID).removeClass("Recentvisitortableaftertextbox");
    $("#tdtxtcompany" + ID).addClass("Recentvisitortabletextbox");
    $("#tdtxtvisitortype" + ID).attr("disabled");
    $("#tdtxtvisitortype" + ID).removeClass("Recentvisitortableaftertextbox");
    var Purpose = document.getElementById('tdtxtvisitortype' + ID).value;
    $("#tdtxtvisitortype" + ID).val(Purpose);
    $("#tdtxtvisitortype" + ID).addClass("Recentvisitortabletextbox");
    $("#tdtxtmobileno" + ID).attr("disabled");
    $("#tdtxtmobileno" + ID).removeClass("Recentvisitortableaftertextbox");
    $("#tdtxtmobileno" + ID).addClass("Recentvisitortabletextbox");
    $("#tdtxtCountryCode" + ID).attr("disabled");
    $("#tdtxtCountryCode" + ID).removeClass("Recentvisitortableaftertextbox");
    $("#tdtxtCountryCode" + ID).addClass("Recentvisitortabletextbox");
    $("#tdtxtvisitortype" + ID).css("-webkit-appearance", "none");
    $("#tdtxtCountryCode" + ID).css("-webkit-appearance", "none");
    $("#tdtxtvisitortype" + ID).css("-moz-appearance", "none");
    $("#tdtxtCountryCode" + ID).css("-moz-appearance", "none");
    $("#tdtxtCountryCode" + ID).css("width", "36px");
    $("#tdimgcancel" + ID).hide();
    $("#tdimgsave" + ID).hide();
    $("#tdimgedit" + ID).show();
    $(".btnAddCart").css("pointer-events", "none");
    $(".btnAddCart").css("background-color", "#d9d9d9");
    if ($("#tdchkselect" + ID).prop('checked') == false) {
        $("#tr" + ID).css("background-color", "#ffffff");
    }
    $("#txtSerachbox").val("");
    //$("#btnSearch").text("Search");
    document.getElementById("hdnCartID").value = "";
    $("#spnerror").hide();
    $("#ddlpurpose").css("border", "1px solid #0033a0");
    document.getElementById("hdnnewvisitor").value = "";
    $("#btnNewVisitor").css("background-color", "#d9d9d9");
    $("#btnNewVisitor").removeAttr("onclick");
    $("#ddlpurpose").removeAttr("disabled");
    $(".btnPreviewSubmit").css("pointer-events", "visible");
    document.getElementById("ddlpurpose").value = "0";
    $('#ddlpurpose').css("border", "1px solid #0033a0");
    $('#ddllocationlist').val("0");
    $('#ddllocationlist').trigger('change');
    $('#sandbox-container input').datepicker('update', '');
    $("#txtstarttime").val("09:00");
    $("#txtendtime").val("18:00");
    $(".divLocationdetails").remove();
    $(".btnAddCart").html("<img src='images/New%20Images/img_trans.gif' class='addtocarticon'>&nbsp; Add to Cart");
    $(".btnAddCart").css("background-color", "#d9d9d9");
    $(".btnAddCart").attr("disabled", "disabled");
    $(".btnAddCart").attr("title", "Add to Cart");
    $(".txtserachbox").removeAttr("disabled");
    $(".btnserach").removeAttr("disabled");
    $.ajax({
        type: "POST",
        url: "HomePage.aspx/GetRecentVisitors",
        contentType: "application/json;charset=utf-8",
        data: "{'visitorCount':" + parseInt("9") + "}",
        dataType: "json",
        success: function (data) {
            if (data.d == "" || data.d == null || data.d == undefined) {
                $("#RecentVisitortablebody").html("<tr style='height:395px;'><td></td><td></td><td></td><td style='width:210px;color:#596679;font:14px Arial-Regular;'>No Recent Visitors Found</td><td></td><td></td><td></td></tr>");
                $("#tblRecentvisitor tbody td").css("border", "none");
                $("#tblRecentvisitor thead td").css("border", "2px solid #dfe9f4");
                $("#fade").hide();
                $("#modal").hide();
            }
            else {
                var Recentdata = JSON.parse(data.d);
                var RecentData_append = "";
                if (Recentdata.length > 0) {
                    for (var i = 0; i < Recentdata.length; i++) {
                        if (i % 2 == 0) {
                            RecentData_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Recentdata[i].VisitorId + "'>";
                        }
                        else {
                            RecentData_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Recentdata[i].VisitorId + "'>";
                        }
                        RecentData_append += "<td style='width:44px;text-align:center;'>";
                        RecentData_append += "<input type='checkbox' value='" + Recentdata[i].VisitorId + "' class='dataaccesscheckbox' id='tdchkselect" + Recentdata[i].VisitorId + "' onchange='UserSelectChange(" + Recentdata[i].VisitorId + ")'>";
                        RecentData_append += "</td>";
                        RecentData_append += "<td class='Recentvisitortabletd' style='width:168px;'>";
                        RecentData_append += "<input type='text' maxlength='25' id='tdtxtvisitorName" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].VisitorFullName + "' disabled />";
                        RecentData_append += "</td>";
                        RecentData_append += "<td class='Recentvisitortabletd' style='width:215px;'>";
                        var Mobile = Recentdata[i].MobileNo.split('-');
                        RecentData_append += "<select type='text' id='tdtxtCountryCode" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' style='width:28px;' disabled ><option>" + Mobile[0] + "</option></select>-<input id='tdtxtmobileno" + Recentdata[i].VisitorId + "' maxlength='10' onkeypress='return isNumberKey(event)' onfocusout='return isvalidmobile(" + Recentdata[i].VisitorId + ")' style='margin-left:0%;width:76px;' class='Recentvisitortabletextbox' type='text' value='" + Mobile[1] + "' disabled />";
                        RecentData_append += "</td>";
                        RecentData_append += "<td class='Recentvisitortabletd' style='width:150px;'>";
                        RecentData_append += "<input type='text' maxlength='25' id='tdtxtcompany" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' value='" + Recentdata[i].Company + "' disabled />";
                        RecentData_append += "</td>";
                        RecentData_append += "<td class='Recentvisitortabletd' style='width:158px;'>";
                        RecentData_append += "<select type='text' id='tdtxtvisitortype" + Recentdata[i].VisitorId + "' class='Recentvisitortabletextbox' disabled ><option>" + Recentdata[i].VisitorType + "</option></select>";
                        RecentData_append += "</td>";

                        RecentData_append += "<td class='Recentvisitortabletd' style='width:120px;'>";
                        if (Recentdata[i].PermitITEquipments == true) {
                            RecentData_append += "<a title='Please click here to add equipment details' id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#00b140;cursor:pointer;text-decoration:underline;' onclick='OpenEquipment(" + Recentdata[i].VisitorId + ",0)' name='" + Recentdata[i].VisitorId + "'>Yes</a>";
                        }
                        else {
                            RecentData_append += "<a title='Please click here to add equipment details' id='tdaequipment" + Recentdata[i].VisitorId + "' href='#' style='color:#596679;cursor:pointer;' name='0'>No</a>";
                        }
                        RecentData_append += "</td>";
                        RecentData_append += "<td style='width:48px;text-align:center;'>";
                        RecentData_append += "<img id='tdimgsave" + Recentdata[i].VisitorId + "' title='Save' src='images/New%20Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;  background: url(images/New%20Images/VMS-Icons.png) no-repeat -37px -235px;' onclick='SaveTableRow(" + Recentdata[i].VisitorId + ")' />";
                        RecentData_append += "<img id='tdimgcancel" + Recentdata[i].VisitorId + "' title='Cancel' src='images/New%20Images/img_trans.gif' style='display:none;height:20px;width:20px;cursor:pointer;  background: url(images/New%20Images/VMS-Icons.png) no-repeat -288px -163px;' onclick='CancelTableRow(" + Recentdata[i].VisitorId + ")' />";
                        RecentData_append += "<img id='tdimgedit" + Recentdata[i].VisitorId + "' title='Edit' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;' onclick='EditTableRow(" + Recentdata[i].VisitorId + ")' />";
                        RecentData_append += "</td>";
                        RecentData_append += "</tr >";
                    }
                    $("#RecentVisitortablebody").html(RecentData_append);
                    $('.divRecentvisitor').slimScroll({
                        height: '432px',
                        width: '100%'
                    });
                }
            }
        },
        error: function (result) {
        }
    });
    $.ajax({
        type: "POST",
        url: "HomePage.aspx/GetVisitorCart",
        contentType: "application/json;charset=utf-8",
        data: '{}',
        dataType: "json",
        async: true,
        success: function (data) {
            var Cart = JSON.parse(data.d);
            var Cart_append = "";
            if (Cart.length > 0) {
                $(".btnPreviewSubmit").css("background-color", "#00b140");
                $(".btnPreviewSubmit").removeAttr("disabled");
                $("#spncartcount").css("color", "#d9d9d9");
                $(".CartImg").css("background", "url('.../../images/New Images/VMS-Icons.png') no-repeat -192px -289px");
            }
            for (var i = 0; i < Cart.length; i++) {
                $("#spncartcount").text("(" + (i + 1) + ")");
                $("#spncartcount1").text((i + 1));
                $("#spncartcount").css("color", "#00b140");
                $(".CartImg").css("background", "url('.../../images/New Images/VMS-Icons.png') no-repeat -192px -228px");
                if (parseInt(Cart[i].Ismultilocation) == 0) {
                    if (i % 2 == 0) {
                        Cart_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Cart[i].CartID + "'>";
                    }
                    else {
                        Cart_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Cart[i].CartID + "'>";
                    }
                    Cart_append += "<td class='Recentvisitortabletd' style='color:#0033a0;font:14px Arial-Bold;padding-left:15px;' title=\"" + Cart[i].VisitorName + "\">";
                    if (parseInt(Cart[i].isDatacenterAccess) == 0) {
                        Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "";
                    }
                    else {
                        Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "<img src='images/New%20Images/img_trans.gif' style='background:url(images/New%20Images/VMS-Icons.png) no-repeat -452px -232px;height:21px;margin-left:4px;margin-top:3%;' />";
                    }
                    Cart_append += "</td>";
                    Cart_append += "<td class='Recentvisitortabletd' title=\"" + Cart[i].LocationName + "\">";
                    Cart_append += "" + Cart[i].LocationName.slice(0, parseInt(15)) + (Cart[i].LocationName.length > parseInt(15) ? "..." : "") + "";
                    Cart_append += "</td>";
                    Cart_append += "<td class='Recentvisitortabletd' style='width:18%;' title='" + Cart[i].HostID + "'>";
                    Cart_append += "" + Cart[i].HostID.slice(0, parseInt(15)) + (Cart[i].HostID.length > parseInt(15) ? "..." : "") + "";
                    Cart_append += "</td>";
                    Cart_append += "<td  class='Recentvisitortabletd' style='width:37%;' title=" + Cart[i].Date + ">";
                    var Splitdate = Cart[i].Date.split(',');
                    if (Splitdate.length == 1) {
                        ConcaSpt = Splitdate;
                    }
                    else {
                        var ConcaSpt = "";
                        for (var w = 0; w < Splitdate.length; w++) {
                            var splitsingledata = Splitdate[w].split('/');
                            ConcaSpt += splitsingledata[0] + "/" + splitsingledata[1] + ",";
                        }
                        ConcaSpt = ConcaSpt.slice(0, -1);
                    }

                    // var spltfrom = Splitdate[0];
                    //var spltto = Splitdate[Splitdate.length - 1];

                    //if (spltfrom == spltto) {
                    //  ConcaSpt = Splitdate;
                    //}
                    //else {
                    //  ConcaSpt = spltfrom + " to " + spltto;
                    // }

                    Cart_append += "" + ConcaSpt.slice(0, parseInt(20)) + (ConcaSpt.length > parseInt(20) ? "..." : "") + " " + "-" + " " + Cart[i].FromTime + " " + "to" + " " + Cart[i].ToTime + "<br/>";
                    //}
                    Cart_append += "</td>";
                    Cart_append += "<td style='text-align:center;'>";
                    Cart_append += "<img class='editimage' id='tdimgedit" + Cart[i].CartID + "' title='Edit' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;' onclick='EditCart(" + Cart[i].CartID + ")' />";
                    Cart_append += "<img class='cancelimage' id='tdimgcancel" + Cart[i].CartID + "' title='Delete' src='images/New Images/img_trans.gif' style='height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -203px -94px;margin-left:4%;cursor:pointer;' onclick='DeleteCart(" + Cart[i].CartID + ")' />";
                    Cart_append += "</td>";
                    Cart_append += "</tr >";
                }
                else {
                    if (i % 2 == 0) {
                        Cart_append += "<tr class='Recentvisitortablebodytrodd' id='tr" + Cart[i].CartID + "'>";
                    }
                    else {
                        Cart_append += "<tr class='Recentvisitortablebodytreven' id='tr" + Cart[i].CartID + "'>";
                    }
                    Cart_append += "<td class='Recentvisitortabletd' style='color:#0033a0;font:14px Arial-Bold;padding-left:15px;' title=\"" + Cart[i].VisitorName + "\">";
                    if (parseInt(Cart[i].isDatacenterAccess) == 0) {
                        Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "";
                    }
                    else {
                        Cart_append += "" + Cart[i].VisitorName.slice(0, parseInt(13)) + (Cart[i].VisitorName.length > parseInt(13) ? "..." : "") + "<img src='images/New%20Images/img_trans.gif' style='background:url(images/New%20Images/VMS-Icons.png) no-repeat -452px -232px;height:21px;margin-left:4px;margin-top:3%;' />";
                    }
                    Cart_append += "</td>";
                    Cart_append += "<td class='Recentvisitortabletd' title=\"" + Cart[i].LocationName + "\">";
                    Cart_append += "" + Cart[i].LocationName.slice(0, parseInt(15)) + (Cart[i].LocationName.length > parseInt(15) ? "..." : "") + "";
                    Cart_append += "</td>";
                    Cart_append += "<td class='Recentvisitortabletd' style='width:18%;' title='" + Cart[i].HostID + "'>";
                    Cart_append += "" + Cart[i].HostID.slice(0, parseInt(15)) + (Cart[i].HostID.length > parseInt(15) ? "..." : "" + "") + "";
                    Cart_append += "</td>";
                    Cart_append += "<td  class='Recentvisitortabletd' style='width:37%;' title=" + Cart[i].Date + ">";
                    var Splitdate = Cart[i].Date.split(',');
                    if (Splitdate.length == 1) {
                        ConcaSpt = Splitdate;
                    }
                    else {
                        var ConcaSpt = "";
                        for (var w = 0; w < Splitdate.length; w++) {
                            var splitsingledata = Splitdate[w].split('/');
                            ConcaSpt += splitsingledata[0] + "/" + splitsingledata[1] + ",";
                        }
                        ConcaSpt = ConcaSpt.slice(0, -1);
                    }

                    // var spltfrom = Splitdate[0];
                    //var spltto = Splitdate[Splitdate.length - 1];

                    //if (spltfrom == spltto) {
                    //  ConcaSpt = Splitdate;
                    //}
                    //else {
                    //  ConcaSpt = spltfrom + " to " + spltto;
                    // }

                    Cart_append += "" + ConcaSpt.slice(0, parseInt(20)) + (ConcaSpt.length > parseInt(20) ? "..." : "") + " " + "-" + " " + Cart[i].FromTime + " " + "to" + " " + Cart[i].ToTime + "<br/>";
                    //}
                    Cart_append += "</td>";
                    Cart_append += "<td style='text-align:center;'>";
                    Cart_append += "<img class='editimage' id='tdimgmultiple" + Cart[i].CartID + "' title='Expand' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -118px -95px;cursor:pointer;margin-left:-21px;' onclick='OpenMultiple(" + Cart[i].CartID + ")' />";
                    Cart_append += "<img class='editimage' id='tdimgedit" + Cart[i].CartID + "' title='Edit' src='images/New Images/img_trans.gif' style='height:20px;width:20px;background:url(images/New%20Images/VMS-Icons.png) no-repeat -448px -97px;cursor:pointer;margin-left:3%;' onclick='EditCart(" + Cart[i].CartID + ")' />";
                    Cart_append += "<img class='cancelimage' id='tdimgcancel" + Cart[i].CartID + "' title='Delete' src='images/New Images/img_trans.gif' style='height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -203px -94px;margin-left:4%;cursor:pointer;' onclick='DeleteCart(" + Cart[i].CartID + ")' />";
                    Cart_append += "</td>";
                    Cart_append += "</tr>";
                    for (var m = 0; m < Cart[i].LocationCount; m++) {
                        Cart_append += "<tr class='Recentvisitortablebodytrodd' style='display:none;' id='" + m + "Multipletr" + Cart[i].CartID + "'>";
                        Cart_append += "</tr>";
                    }
                }
            }
            $("#tbodycart").html(Cart_append);
            $("#tbodycart1").html(Cart_append);
            $("#fade").hide();
            $("#modal").hide();
        },
        error: function (result) {
            $("#fade").hide();
            $("#modal").hide();
        }
    });
}

function EditTableRow(ID) {
    $("#fade").show();
    $("#modal").show();
    $.ajax({
        type: "POST",
        url: "HomePage.aspx/GetVistorType",
        contentType: "application/json;charset=utf-8",
        data: "{}",
        dataType: "json",
        success: function (data) {
            var PurposeData = JSON.parse(data.d);
            $(".btnAddCart").css("background-color", "#00b140");
            $(".btnAddCart").css("pointer-events", "visible");
            $("#tr" + ID).css("background-color", "#E3EEF2");
            $("#tdtxtvisitorName" + ID).removeAttr("disabled");
            $("#tdtxtvisitorName" + ID).removeClass("Recentvisitortabletextbox");
            $("#tdtxtvisitorName" + ID).addClass("Recentvisitortableaftertextbox");
            $("#tdtxtcompany" + ID).removeAttr("disabled");
            $("#tdtxtcompany" + ID).removeClass("Recentvisitortabletextbox");
            $("#tdtxtcompany" + ID).addClass("Recentvisitortableaftertextbox");
            $("#tdtxtvisitortype" + ID).attr("disabled", "disabled");
            $("#tdtxtvisitortype" + ID).removeClass("Recentvisitortabletextbox");
            var Purpose = document.getElementById('tdtxtvisitortype' + ID).value;
            var RecentData_append = "";
            for (var i = 0; i < PurposeData.length; i++) {
                if (PurposeData[i] != "Guests" && PurposeData[i] != "Former Employee" && PurposeData[i] != "Associate Driver" && PurposeData[i] != "Auditors" && PurposeData[i] != "New Joinee" && PurposeData[i] != "Business Partner" && PurposeData[i] != "Select Purpose") {
                    RecentData_append += "<option>" + PurposeData[i] + "</option>";
                }
            }
            $("#tdtxtvisitortype" + ID).html(RecentData_append);
            $("#tdtxtvisitortype" + ID).val(Purpose);
            $("#tdtxtvisitortype" + ID).addClass("Recentvisitortableaftertextbox");
            $("#tdtxtmobileno" + ID).removeAttr("disabled");
            $("#tdtxtmobileno" + ID).removeClass("Recentvisitortabletextbox");
            $("#tdtxtmobileno" + ID).addClass("Recentvisitortableaftertextbox");
            $("#tdtxtCountryCode" + ID).show();
            $("#tdtxtCountryCode" + ID).removeAttr("disabled");
            $("#tdtxtCountryCode" + ID).removeClass("Recentvisitortabletextbox");
            $("#tdtxtCountryCode" + ID).addClass("Recentvisitortableaftertextbox");
            $("#tdtxtvisitortype" + ID).css("-webkit-appearance", "menulist");
            $("#tdtxtCountryCode" + ID).css("-webkit-appearance", "menulist");
            $("#tdtxtvisitortype" + ID).css("-moz-appearance", "menulist");
            $("#tdtxtCountryCode" + ID).css("-moz-appearance", "menulist");
            $("#tdtxtCountryCode" + ID).css("width", "55px");
            $("#tdimgcancel" + ID).show();
            $("#tdimgsave" + ID).show();
            $("#tdimgedit" + ID).hide();
            $.ajax({
                type: "POST",
                url: "HomePage.aspx/GetCountryCode",
                contentType: "application/json;charset=utf-8",
                data: "{}",
                dataType: "json",
                success: function (data) {
                    //// debugger;
                    var Locationdata = JSON.parse(data.d);
                    var Locationcode = document.getElementById("tdtxtCountryCode" + ID).value;
                    var RecentData_append = "";
                    for (var i = 0; i < Locationdata.length; i++) {
                        RecentData_append += "<option value=" + Locationdata[i].Country + ">+" + Locationdata[i].Code + "</option>";
                    }
                    $("#tdtxtCountryCode" + ID).html(RecentData_append);

                    $('#tdtxtCountryCode' + ID).select2({
                        matcher: function (params, data) {
                            if ($.trim(params.term) === '') { return data; }
                            if (typeof data.text === 'undefined') { return null; }
                            var q = params.term.toLowerCase();
                            if (data.text.toLowerCase().indexOf(q) > -1 || data.id.toLowerCase().indexOf(q) > -1) {
                                return $.extend({}, data, true);
                            }
                            return null;
                        }
                    });
                    //$("#tdtxtCountryCode" + ID).val(Locationcode);
                    ////$("#tdtxtCountryCode" + ID).val("India");
                    $('#tdtxtCountryCode' + ID + ' option').map(function () {
                        if ($(this).text() == Locationcode) return this;
                    }).attr('selected', 'selected');
                    $('#tdtxtCountryCode' + ID).trigger('change');
                },
                error: function (result) {
                    $("#fade").hide();
                    $("#modal").hide();
                }
            });
            var test = $("#tdaequipment" + ID).text();
            if (test != 'Yes') {
                $("#tdaequipment" + ID).css("color", "rgb(0, 114, 143)");
                $("#tdaequipment" + ID).css("cursor", "pointer");
                $("#tdaequipment" + ID).css("text-decoration", "underline");
                $("#tdaequipment" + ID).attr("onclick", "OpenEquipment(" + ID + ")");
            }

            $("#fade").hide();
            $("#modal").hide();
        },
        error: function (result) {
            $("#fade").hide();
            $("#modal").hide();
        }
    });
}

function SubmitEquipmentDetails(ID, ID1) {
    $("#fade").show();
    $("#modal").show();
    var txtlaptopType = $("#txtlaptopType").val();
    var txtlaptopMake = $("#txtlaptopMake").val();
    var txtlaptopModel = $("#txtlaptopModel").val();
    var txtlaptopserial = $("#txtlaptopserial").val();
    var txtdatastoragedeviceType = $("#txtdatastoragedeviceType").val();
    var txtdatastoragedeviceMake = $("#txtdatastoragedeviceMake").val();
    var txtdatastoragedeviceModel = $("#txtdatastoragedeviceModel").val();
    var txtdatastoragedeviceSerial = $("#txtdatastoragedeviceSerial").val();
    var txtUSBharddiskType = $("#txtUSBharddiskType").val();
    var txtUSBharddiskMake = $("#txtUSBharddiskMake").val();
    var txtUSBharddiskModel = $("#txtUSBharddiskModel").val();
    var txtUSBharddiskSerial = $("#txtUSBharddiskSerial").val();
    var txtcameraType = $("#txtcameraType").val();
    var txtcameraMake = $("#txtcameraMake").val();
    var txtcameraModel = $("#txtcameraModel").val();
    var txtcameraSerial = $("#txtcameraSerial").val();
    var txtIPodType = $("#txtIPodType").val();
    var txtIPodMake = $("#txtIPodMake").val();
    var txtIPodModel = $("#txtIPodModel").val();
    var txtIPodSerial = $("#txtIPodSerial").val();
    var txtotherType = $("#txtotherType").val();
    var txtotherMake = $("#txtotherMake").val();
    var txtotherModel = $("#txtotherModel").val();
    var txtotherSerial = $("#txtotherSerial").val();
    var laptopstatus = 0;
    var usbstatus = 0;
    var datastorage = 0;
    var camerastatus = 0;
    var IpodStatus = 0;
    var othersstatus = 0;
    if (txtlaptopMake != "" || txtlaptopModel != "" || txtlaptopserial != "") {
        laptopstatus = 1;
    }
    if (txtdatastoragedeviceMake != "" || txtdatastoragedeviceModel != "" || txtdatastoragedeviceSerial != "") {
        datastorage = 1;
    }
    if (txtUSBharddiskMake != "" || txtUSBharddiskModel != "" || txtUSBharddiskSerial != "") {
        usbstatus = 1;
    }
    if (txtcameraMake != "" || txtcameraModel != "" || txtcameraSerial != "") {
        camerastatus = 1;
    }
    if (txtIPodMake != "" || txtIPodModel != "" || txtIPodSerial != "") {
        IpodStatus = 1;
    }
    if (txtotherMake != "" || txtotherModel != "" || txtotherSerial != "") {
        othersstatus = 1;
    }
    if (laptopstatus == 1 || datastorage == 1 || usbstatus == 1 || camerastatus == 1 || IpodStatus == 1 || othersstatus == 1) {
        $.ajax({
            type: "POST",
            url: "HomePage.aspx/InsertEquipmentDetails",
            contentType: "application/json;charset=utf-8",
            data: '{"txtlaptopType":"' + txtlaptopType + '","txtlaptopMake":"' + txtlaptopMake + '","txtlaptopModel":"' + txtlaptopModel + '","txtlaptopserial":"' + txtlaptopserial + '","txtdatastoragedeviceType":"' + txtdatastoragedeviceType + '","txtdatastoragedeviceMake":"' + txtdatastoragedeviceMake + '","txtdatastoragedeviceModel":"' + txtdatastoragedeviceModel + '","txtdatastoragedeviceSerial":"' + txtdatastoragedeviceSerial + '","txtUSBharddiskType":"' + txtUSBharddiskType + '","txtUSBharddiskMake":"' + txtUSBharddiskMake + '","txtUSBharddiskModel":"' + txtUSBharddiskModel + '","txtUSBharddiskSerial":"' + txtUSBharddiskSerial + '","txtcameraType":"' + txtcameraType + '","txtcameraMake":"' + txtcameraMake + '","txtcameraModel":"' + txtcameraModel + '","txtcameraSerial":"' + txtcameraSerial + '","txtIPodType":"' + txtIPodType + '","txtIPodMake":"' + txtIPodMake + '","txtIPodModel":"' + txtIPodModel + '","txtIPodSerial":"' + txtIPodSerial + '","txtotherType":"' + txtotherType + '","txtotherMake":"' + txtotherMake + '","txtotherModel":"' + txtotherModel + '","txtotherSerial":"' + txtotherSerial + '","laptopstatus":"' + laptopstatus + '","datastorage":"' + datastorage + '","usbstatus":"' + usbstatus + '","camerastatus":"' + camerastatus + '","ipodStatus":"' + IpodStatus + '","othersstatus":"' + othersstatus + '"}',
            dataType: "json",
            success: function (data) {
                $("#tdaequipment" + ID).text("Yes");
                $("#tdaequipment").text("Yes");
                $("#tdaequipment" + ID).css('color', '#00b140');
                $("#tdaequipment").css('color', '#00b140');
                $("#tdaequipment" + ID).css('text-decoration', 'underline');
                $("#fade").hide();
                $("#modal").hide();
                $("#tdaequipment" + ID).attr("name", data.d);
                //$("#tdaequipment" + ID).attr("onclick", "OpenEquipment(" + data.d+",0)");
                $("#tdaequipment").attr("name", data.d);
                var name = $("#tdaequipment" + ID).attr("name");
                var span = document.getElementsByClassName("close")[0];
                var modal = document.getElementById('myModal');
                modal.style.display = "none";
            },
            error: function (result) {
                $("#fade").hide();
                $("#modal").hide();
            }
        });
    }
    else {
        var x = $("#tdaequipment" + ID).text();
        var y = $("#tdaequipment" + ID).attr("name");
        if (x == "Yes" && y == 0) {
            $("#tdaequipment" + ID).text("Yes");
            $("#tdaequipment").text("Yes");
            $("#tdaequipment" + ID).css('color', '#00b140');
            $("#tdaequipment").css('color', '#00b140');
            $("#tdaequipment" + ID).css('text-decoration', 'underline');
        }
        else {
            //if (ID1 == "" || ID1 == undefined == ID1 == null) {
            $("#tdaequipment" + ID).text("No");
            $("#tdaequipment").text("No");
            $("#tdaequipment").attr("name", "-1");
            $("#tdaequipment" + ID).attr("name", "-1");
            $("#tdaequipment" + ID).css('color', '#596679');
            $("#tdaequipment").css('color', '#596679');
            $("#tdaequipment" + ID).css('text-decoration', 'none');
            //}
            //else {
            //    $("#tdaequipment" + ID1).text("No");
            //    $("#tdaequipment").text("No");
            //    $("#tdaequipment" + ID1).attr("name", "0");
            //    $("#tdaequipment" + ID1).css('color', '#596679');
            //    $("#tdaequipment").css('color', '#596679');
            //    $("#tdaequipment" + ID1).css('text-decoration', 'none');
            //}
        }

        var span = document.getElementsByClassName("close")[0];
        var modal = document.getElementById('myModal');
        modal.style.display = "none";
        $("#fade").hide();
        $("#modal").hide();
    }
}

function RemoveExtraLocation(Count) {
    LocationCount = parseInt(LocationCount) - 1;
    $("#Locationdetails" + Count).remove();
    $("#AddMoreLocation").attr("onclick", "AddExtraLocation(" + LocationCount + ")");
    $("#AddMoreLocation").css("margin-left", "127px");
}

function OpenDatePicker(ID) {
    $("#txtvisitdate" + ID).datepicker('show');
}

function AddExtraLocation(Count) {
    $("#fade").show();
    $("#modal").show();
    $.ajax({
        type: "POST",
        url: "HomePage.aspx/GetLocation",
        contentType: "application/json;charset=utf-8",
        data: "{}",
        dataType: "json",
        success: function (data) {
            var locationData = JSON.parse(data.d);
            LocationCount = parseInt(Count) + 1;
            if (LocationCount <= 9) {
                var Location_Append = "";
                Location_Append += "<div class='divLocationdetails' id='Locationdetails" + LocationCount + "' style='margin-top:10px;'>";
                Location_Append += "<div class=='span5 col-md- 5' style='margin-top:16px;'> <span style='margin-left:16px;font:12px Arial-Regular;color:#4d4d4d;'>Visiting Date</span><span style='color:red;'>*</span><br /><div class='tooltip' style='float:left;font:14px Arial-Regular;'><img style='margin-top:-15px;margin-left:224px;' src='images/New%20Images/img_trans.gif' class='ImgHostID2'/><span style='font:12px Arial-Regular;margin-left:10px;width:199px;' class='tooltiptext'>Multiple dates can be selected.</span></div><input readonly onfocusout='datefocus(" + LocationCount + ")'  title='You will be able to select multiple continuous/non-continuous date(s)' id= 'txtvisitdate" + LocationCount + "' style='width:190px;height:36px;padding-left:10px;margin-top:5px;border-right:0px;' type= 'text' class='textBox visitdatetex' placeholder= 'MM/DD/YYYY' />";
                Location_Append += "<div id='divimgdate" + LocationCount + "' style='float:left;border:1px solid #d6d6d6;width:30px;height:36px;margin-top:5px;border-left:0px;'><img style='margin-top:10px;' onclick='OpenDatePicker(" + LocationCount + ")' title='You will be able to select multiple continuous/non-continuous date(s)' id='imgdate" + LocationCount + "' class='imgdate' src='images/New%20Images/img_trans.gif' /></div><br/> <div id='datespnerror" + LocationCount + "' style='float:left;font:13px Arial-Regular;line-height:64px;margin-left:19px;display:none;height:30px;line-height:10px;'>";
                Location_Append += "<img src ='images/New Images/img_trans.gif' style ='height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -37px -293px;' /> <span style='color:#f4633a;'>Select Visiting Date</span></div ></div>";
                Location_Append += "<div style='margin-top:-4%;'> <div style='line-height:32px;width:50%;'><br /><span style='margin-left:19px;font:12px Arial-Regular;color:#4d4d4d;'>Visiting Time</span><span style='color:red;'>*</span><br /><input type='text' id='txtstarttime" + LocationCount + "' class='textBox Starttime' onkeypress='return AllowAlphanumeric(event)' placeholder='Start Time' />";
                Location_Append += "</div>";
                Location_Append += "<div style='margin-top:-55px;float:right;margin-right:4%;width:50%;'><span style='margin-left:20px;font:12px Arial-Regular;color:#4d4d4d;'></span><span style='color: red;'></span><br /><div style='margin-top:5%;'><input type='text' id='txtendtime" + LocationCount + "' class='textBox Endtime' onkeypress='return AllowAlphanumeric(event)' placeholder='End Time' />";
                Location_Append += "</div></div><br/> <div id='Timespnerror" + LocationCount + "' style='float:left;font:13px Arial-Regular;margin-left:20px;display:none;height:30px;line-height:13px;text-align:center;'>";
                Location_Append += "<img src ='images/New Images/img_trans.gif' style = 'height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -37px -293px;' /> <span style='color:#f4633a;' id='Timespnerrorspan" + LocationCount + "'>Select Visiting Date</span></div ></div> ";
                Location_Append += "<div style='margin-top:32px;'><span style ='margin-left:20px;font:12px Arial-Regular;color:#4d4d4d;'> Visiting Location</span ><span style='color:red;'>*</span> <br /><select id='ddllocationlist" + LocationCount + "' onchange='LocationChange(" + LocationCount + ")'>";
                Location_Append += "<option>Select Visiting Location</option>";
                for (var i = 0; i < locationData.length; i++) {
                    Location_Append += "<option value=" + locationData[i].Countrydesc + ">" + locationData[i].Country + "</option>";
                }
                Location_Append += "</select><br/><div id='Locationspnerror" + LocationCount + "' style='width:60%;float:left;font:13px Arial-Regular;line-height:64px;margin-left:19px;display:none;height:30px;line-height:10px;'>";
                Location_Append += "<img src = 'images/New Images/img_trans.gif' style = 'height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -37px -293px;' /> <span style='color:#f4633a;'>Select Visiting Location</span></div ></div>";
                var Visitordrop = document.getElementById("ddlpurpose");
                VisitorType = Visitordrop.options[Visitordrop.selectedIndex].text;
                if (VisitorType == "Client") {
                    Location_Append += "<div style='margin-top:7px;display:none;' id='divhostID" + LocationCount + "'> <span style ='margin-left:20px;font:12px Arial-Regular;color:#4d4d4d;'> Host ID / Name</span> <span style='color:red;'>*</span> <br /><input type='text' onfocusout='HostIDfocus(" + LocationCount + ")' style='margin-left:18px;width:218px;height:36px;padding-left:12px;margin-top:5px;' id='txthostID" + LocationCount + "' onkeyup='GetAssociateDeails(" + LocationCount + ")' class='textBox' placeholder='Host name /ID (M+ only)' />";
                    Location_Append += "<div class='tooltip' style='margin-top:4%;margin-left:-8%;float:left;font:12px Arial-Regular'><img src='images/New%20Images/img_trans.gif' class='ImgHostID1' style='display:block;'/><span style='width:405px;margin-left:-206px;font:12px Arial-Regular' class='tooltiptext'>Host (M+ level) is accountable for client credentials provided in the request.</span></div><br/>  <div id='Hostspnerror" + LocationCount + "' style='width:60%;float:left; ont:13px Arial-Regular;line-height:64px;margin-left:19px;display:none;height:30px;line-height:10px;'>";
                    Location_Append += "<img src = 'images/New Images/img_trans.gif' style = 'height:20px;width:20px;cursor:pointer;background:url(images/New%20Images/VMS-Icons.png) no-repeat -37px -293px;' /> <span style='color:#f4633a;' id='Hostspnerrorspan" + LocationCount + "'>Enter Host ID</span></div>";
                    Location_Append += "</div>";
                }
                else {
                    Location_Append += "<div style='margin-top:7px;display:none;' id='divhostID" + LocationCount + "'> <span style ='margin-left:20px;font:12px Arial-Regular;color:#4d4d4d;'> Host ID / Name</span> <span style='color:red;'>*</span> <br /><input type='text' style='margin-left:18px;width:218px;height:36px;display:none;padding-left:12px;margin-top:5px;' id='txthostID" + LocationCount + "' onkeyup='GetAssociateDeails(" + LocationCount + ")' class='textBox' placeholder='Host name /ID (M+ only)' disabled/>";
                    Location_Append += "<div class='tooltip' style='margin-top:4%;margin-left:-8%;float:left;'><img id='imghostid" + LocationCount + "' src='images/New%20Images/img_trans.gif' style='display:none;' class='ImgHostID'/><span class='tooltiptext'>Host (M+ level) is responsible for entire Client Visit. Host must also collect/return the Smart Badges of Clients from/to Security Desk.</span></div></div>";
                }

                Location_Append += "<div class='Dataccessdiv' id='divdataaccess" + LocationCount + "' style='display:none;'>";
                Location_Append += "<a href='#' style='color:#0033a0; font:13px Arial-Regular;' onclick='OpenDatacenterform()'>Fill Datacenter Access Details</a>";
                Location_Append += "</div>";
                Location_Append += "<div class='AddmoreDiv1' onclick='RemoveExtraLocation(" + LocationCount + ")' style='color:#f4633a;'>";
                Location_Append += "<img src='images/New%20Images/img_trans.gif' class='Removeicon' /> Remove Location";
                Location_Append += "</div>";
                Location_Append += "</div>";
                $("#Locationdetails").append(Location_Append);
                $("#ddllocationlist" + LocationCount).css("width", "229px");
                $("#ddllocationlist" + LocationCount).css("height", "42px");
                $("#ddllocationlist" + LocationCount).css("padding-left", "0px");
                $("#AddMoreLocation").attr("onclick", "AddExtraLocation(" + LocationCount + ")");
                $("#AddMoreLocation").css("margin-left", "127px");
                $(".MainLocationdetails").slimScroll({
                    height: '486px',
                    width: '100%'
                });
                ////var fromNow = new Date();
                ////var minutes = 5;
                ////var hour = 3
                ////fromNow.setMinutes(fromNow.getMinutes() + minutes);
                ////var fromhour = fromNow.getHours();
                ////var fromminute = fromNow.getMinutes();
                ////var toNow = new Date();
                ////toNow.setHours(toNow.getHours() + hour);
                ////toNow.setMinutes(toNow.getMinutes() + minutes);
                ////var tohour = toNow.getHours();
                ////var tominute = toNow.getMinutes();
                ////var frommin = 0;
                ////var tomin = 0;

                ////if (fromminute >= 0 && fromminute < 15) {
                ////    fromNow.setMinutes(fromNow.getMinutes() + (15 - fromminute));
                ////    toNow.setMinutes(15);
                ////}
                ////else if (fromminute >= 15 && fromminute < 30) {
                ////    fromNow.setMinutes(fromNow.getMinutes() + (30 - fromminute));
                ////    toNow.setMinutes(30);
                ////}
                ////else if (fromminute >= 30 && fromminute < 45) {
                ////    fromNow.setMinutes(fromNow.getMinutes() + (45 - fromminute));
                ////    toNow.setMinutes(45);
                ////}
                ////else {
                ////    fromNow.setMinutes(fromNow.getMinutes() + (60 - fromminute));
                ////    toNow.setMinutes(45 + 15)//// Need to test this when the user opens the request between 45 - 59 minutes
                ////}
                ////var ampm = (fromhour >= 12) ? 'PM' : 'AM';
                ////fromhour = fromhour % 12;
                ////fromhour = fromhour ? fromhour : 12;
                ////fromhour = fromhour < 10 ? '0' + fromhour : fromhour;
                ////fromminute = fromminute < 10 ? '0' + fromminute : fromminute;
                ////var time = appendZero(fromNow.getHours(), 2) + ':' + appendZero(fromNow.getMinutes(), 2);

                $("#txtstarttime" + LocationCount).kendoTimePicker({
                    dateInput: true,
                    value: "09:00",
                    interval: 15,
                    format: "HH:mm"
                });

                ////var ampm1 = (tohour >= 12) ? 'PM' : 'AM';
                ////tohour = tohour % 12;
                ////tohour = tohour ? tohour : 12;
                ////tohour = tohour < 10 ? '0' + tohour : tohour;
                ////tominute = tominute < 10 ? '0' + tominute : tominute;
                ////var time1 = appendZero(toNow.getHours(), 2) + ':' + appendZero(toNow.getMinutes(), 2);
                $("#txtendtime" + LocationCount).kendoTimePicker({
                    dateInput: true,
                    value: "18:00",
                    interval: 15,
                    format: "HH:mm",
                    change: function (e) {
                        var start = $("#txtstarttime" + LocationCount).val();
                        var end = $("#txtendtime" + LocationCount).val();
                        if (start != "" || start != null || start != undefined) {
                            var dtStart = new window.Date("1/1/2011 " + start);
                            var dtEnd = new window.Date("1/1/2011 " + end);
                            var difference_in_milliseconds = dtEnd - dtStart;
                            if (difference_in_milliseconds <= 0) {
                                $("#Timespnerrorspan" + LocationCount).text("To Time should be greater than From Time");
                                $("#txtstarttime" + LocationCount).css('border-color', '#f4633a');
                                $("#Timespnerror" + LocationCount).show();
                                $("#txtendtime" + LocationCount).css('border-color', '#f4633a');
                                $("#fade").hide();
                                $("#modal").hide();
                                return false;
                            }
                            else {
                                $("#Timespnerror" + LocationCount).hide();
                            }
                        }
                    }
                });
                $(function () {
                    $('#txtvisitdate' + LocationCount).datepicker({
                        clearBtn: true,
                        multidate: true,
                        todayHighlight: true,
                        startDate: "new Date()"
                    });
                });

                $(function () {
                    $("#ddllocationlist" + LocationCount).select2({
                        matcher: function (params, data) {
                            if ($.trim(params.term) === '') { return data; }
                            if (typeof data.text === 'undefined') { return null; }
                            var q = params.term.toLowerCase();
                            if (data.text.toLowerCase().indexOf(q) > -1 || data.id.toLowerCase().indexOf(q) > -1) {
                                return $.extend({}, data, true);
                            }
                            return null;
                        }
                    });
                });

                var CurrentLocation = document.getElementById("hdnLocationCode").value;
                $('#ddllocationlist' + LocationCount).val(CurrentLocation);
                $('#ddllocationlist' + LocationCount).trigger('change');
                $("#txthostID" + LocationCount).val(document.getElementById("hdnMHostID").value);
            }
            else {
                document.getElementById('Sucessmessage').style.display = 'block';
                $("#Sucessmessagebody").html("Only 10 Locations per request is allowed.");
            }
            $("#fade").hide();
            $("#modal").hide();
        },
        error: function (result) {
            $("#fade").hide();
            $("#modal").hide();
        }
    });

}

function LocationChange(ID) {

    $(".select2-container--default .select2-selection--single").css('border-color', '#d6d6d6');
    var LocationNamedrop = null;
    var LocationName = null;
    if (parseInt(ID) == 0 || parseInt(ID) == null || parseInt(ID) == undefined) {
        LocationNamedrop = document.getElementById("ddllocationlist");

        // LocationName = LocationNamedrop.options[LocationNamedrop.selectedIndex].text;
        LocationName = LocationNamedrop.selectedIndex >= 0 ? LocationNamedrop.options[LocationNamedrop.selectedIndex].text : "Select Visiting Location";

        $("#Locationspnerror").hide();

    }
    else {
        LocationNamedrop = document.getElementById("ddllocationlist" + ID);
        //  LocationName = LocationNamedrop.options[LocationNamedrop.selectedIndex].text;
        LocationName = LocationNamedrop.selectedIndex > 0 ? LocationNamedrop.options[LocationNamedrop.selectedIndex].text : "Select Visiting Location";

        $("#Locationspnerror" + ID).hide();

    }
    var Visitordrop = document.getElementById("ddlpurpose");
    var VisitorType = Visitordrop.options[Visitordrop.selectedIndex].text;

    // var VisitorType = Visitordrop.selectedIndex > -1 ? Visitordrop.options[Visitordrop.selectedIndex].text: 0;
    var indexlocation = LocationName.indexOf("IND");
    if (VisitorType == "Client" && indexlocation >= 0) {
        if (parseInt(ID) == 0 || parseInt(ID) == null || parseInt(ID) == undefined) {
            $("#txthostID").removeAttr("disabled");
            $("#txthostID").show();
            $(".ImgHostID").show();
            $("#divhostID").show();
            var checkhostid = document.getElementById("hdnMHostID").value.split('(');
            if (checkhostid.length > 1) {
                var AID = checkhostid[1].substring(0, checkhostid[1].length - 1);
                $.ajax({
                    url: 'HomePage.aspx/GetAssociateDetails',
                    data: '{"text":"' + AID + '"}',
                    dataType: "json",
                    type: "POST",
                    contentType: "application/json; charset=utf-8",
                    success: function (data) {
                        var serachData = JSON.parse(data.d)
                        if (serachData.length > 0) {
                            $("#txthostID").val(document.getElementById("hdnMHostID").value);
                        }
                        else {
                            $("#txthostID").val("");
                        }
                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) {
                        var err = eval("(" + XMLHttpRequest.responseText + ")");
                        alert(err.Message)
                    }
                });
            }
            else {
                $("#txthostID").val(document.getElementById("hdnMHostID").value);
            }
            ////$("#txthostID").val("");
        }
        else {
            $("#txthostID" + ID).removeAttr("disabled");
            $("#txthostID" + ID).show();
            $(".ImgHostID1").show();
            $("#divhostID" + ID).show();
            $("#txthostID" + ID).val(document.getElementById("hdnMHostID").value);
            ////$("#txthostID" + ID).val("");
            var checkhostid = document.getElementById("hdnMHostID").value.split('(');
            var checkhostid = document.getElementById("hdnMHostID").value.split('(');
            if (checkhostid.length > 1) {
                var AID = checkhostid[1].substring(0, checkhostid[1].length - 1);
                ////$("#txthostID").val(document.getElementById("hdnMHostID").value);


                $.ajax({
                    url: 'HomePage.aspx/GetAssociateDetails',
                    data: '{"text":"' + AID + '"}',
                    dataType: "json",
                    type: "POST",
                    contentType: "application/json; charset=utf-8",
                    success: function (data) {
                        var serachData = JSON.parse(data.d)
                        if (serachData.length > 0) {
                            $("#txthostID" + ID).val(document.getElementById("hdnMHostID").value);
                        }
                        else {
                            $("#txthostID" + ID).val("");
                        }
                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) {
                        var err = eval("(" + XMLHttpRequest.responseText + ")");
                        alert(err.Message)
                    }
                });
            }
            else {
                $("#txthostID").val(document.getElementById("hdnMHostID").value);
            }
        }
    }
    else {
        if (parseInt(ID) == 0 || parseInt(ID) == null || parseInt(ID) == undefined) {
            $("#txthostID").hide();
            $("#txthostID").attr("disabled", "disabled");
            $("#txthostID").val("");
            $(".ImgHostID").hide();
            $("#divhostID").hide();
        }
        else {
            $("#txthostID" + ID).attr("disabled", "disabled");
            $("#txthostID" + ID).hide();
            $("#txthostID" + ID).val("");
            $(".ImgHostID1").hide();
            $("#divhostID" + ID).hide();
        }
    }

    if (LocationName == "IND-CHN-MEPZ (TBM)" || LocationName == "IND-PUN-COG Deccan Campus (CDC)") {
        if (VisitorType == "Vendor" || VisitorType == "Client" || VisitorType == "Auditors") {
            $("#dataccess").removeAttr("disabled");
            if (parseInt(ID) != 0) {
                $("#divdataaccess" + ID).hide();
                $("#dataccess").text("Fill Datacenter Access Details");
                $("#dataccess").attr("onclick", "OpenDatacenterform(0)");
            }
            else {
                $("#divdataaccess" + ID).hide();
                $("#dataccess").text("Fill Datacenter Access Details");
                $("#dataccess").attr("onclick", "OpenDatacenterform(0)");
            }
        }
    }
    else {
        $("#dataccess").attr("disabled", "disabled");
        if (parseInt(ID) != 0) {
            $("#divdataaccess" + ID).hide();
            $("#dataccess").text("Fill Datacenter Access Details");
            $("#dataccess").attr("onclick", "OpenDatacenterform(0)");
        }
        else {
            $("#divdataaccess" + ID).hide();
            $("#dataccess").text("Fill Datacenter Access Details");
            $("#dataccess").attr("onclick", "OpenDatacenterform(0)");
        }
    }

}

function BulkUpload() {
    var Visitordrop = document.getElementById("ddlpurpose");
    var VisitorType = Visitordrop.options[Visitordrop.selectedIndex].text;
    document.getElementById("BulkUploadframe").src = "BulkUpload.aspx?purposeText=" + VisitorType + "";
    var BulkModel = document.getElementById("BulkModel");
    BulkModel.style.display = "block";
}

function CloseBulkUpload() {
    var Visitordrop = document.getElementById("ddlpurpose");
    var VisitorType = Visitordrop.options[Visitordrop.selectedIndex].text;
    document.getElementById("BulkUploadframe").src = "BulkUpload.aspx?purposeText=" + VisitorType + "";
    //document.getElementById('BulkUploadframe').contentDocument.location.reload(true);
    //$("#fade").show();
    //$("#modal").show();
    var BulkModel = document.getElementById("BulkModel");
    BulkModel.style.display = "none";
    document.getElementById("hdnisbulkupload").value = "1";
    //var iframe = document.getElementById("BulkUploadframe");
    //iframe.src = iframe.src;
    var count = 0;
    $.ajax({
        type: "POST",
        url: "HomePage.aspx/GetBulkRecords",
        contentType: "application/json;charset=utf-8",
        data: "{}",
        dataType: "json",
        success: function (data) {
            $(".btnAddCart").text("Cancel");
            $(".btnAddCart").attr("title", "Cancel");
            $(".btnAddCart").css("background-color", "#00b140");
            $(".btnAddCart").removeAttr("disabled");
            $(".btnAddCart").css("text-align", "center");
            $(".btnAddCart").css("pointer-events", "visible");
            $(".btnPreviewSubmit").css("background-color", "#00b140");
            $(".btnPreviewSubmit").removeAttr("disabled");
            $(".btnPreviewSubmit").text("Submit Bulk Associates");
            $(".btnPreviewSubmit").attr("title", "Submit Bulk Associates");
            var Recentdata = JSON.parse(data.d);
            var RecentData_append = "";
            for (var i = 0; i < Recentdata.length; i++) {
                count++;
                if (i % 2 == 0) {
                    RecentData_append += "<tr class='Recentvisitortablebodytrodd'>";
                }
                else {
                    RecentData_append += "<tr class='Recentvisitortablebodytreven'>";
                }
                var Visitordrop = document.getElementById("ddlpurpose");
                var VisitorType = Visitordrop.options[Visitordrop.selectedIndex].text;
                var otherstext = $("#txtothers").val();
                RecentData_append += "<td style='width:44px;text-align:center;'>";
                RecentData_append += "<input type='checkbox' class='dataaccesscheckbox' id='tdchkselect" + i + "' disabled>";
                RecentData_append += "</td>";
                RecentData_append += "<td class='Recentvisitortabletd' style='width:168px;'>";
                RecentData_append += "<input type='text' maxlength='25' id='tdtxtvisitorName' class='Recentvisitortabletextbox' value='" + Recentdata[i].Name + "' disabled />";
                RecentData_append += "</td>";
                RecentData_append += "<td class='Recentvisitortabletd' style='width:215px;'>";
                var Mobile = Recentdata[i].Mobile.split('-');
                if (Mobile.length > 1) {
                    RecentData_append += "<input type='text' maxlength='25' id='tdtxtCountryCode' class='Recentvisitortabletextbox' style='width:28px;' value='" + Mobile[0] + "' disabled />-<input id='tdtxtmobileno' maxlength='10' style='margin-left:2%;width:80px;' onkeypress='return isNumberKey(event)' class='Recentvisitortabletextbox' type='text' value='" + Mobile[1] + "' disabled />";
                }
                else {
                    RecentData_append += "<input type='text' maxlength='25' id='tdtxtCountryCode' class='Recentvisitortabletextbox' style='width:28px;' value='+91' disabled />-<input id='tdtxtmobileno' maxlength='10' onkeypress='return isNumberKey(event)' style='margin-left:2%;width:80px;' class='Recentvisitortabletextbox' type='text' value='" + Mobile[0] + "' disabled />";
                }
                RecentData_append += "</td>";
                RecentData_append += "<td class='Recentvisitortabletd' style='width:150px;'>";
                if (VisitorType == "Others") {
                    RecentData_append += otherstext;
                }
                else {
                    RecentData_append += "Interview";
                }
                RecentData_append += "</td>";
                RecentData_append += "<td class='Recentvisitortabletd' style='width:158px;'>";
                RecentData_append += "<select type='text' id='tdtxtvisitortype' class='Recentvisitortabletextbox' disabled ><option>" + VisitorType + "</option></select>";
                RecentData_append += "</td>";

                RecentData_append += "<td class='Recentvisitortabletd' style='width:120px;'>";
                RecentData_append += "NO";
                RecentData_append += "</td>";
                RecentData_append += "<td style='width:48px;text-align:center;'>";
                RecentData_append += "</td>";
                RecentData_append += "</tr >";
            }
            $("#RecentVisitortablebody").html(RecentData_append);
            $(".dataaccesscheckbox1").attr("disabled", "disabled");
            $('.divRecentvisitor').slimScroll({
                height: '432px',
                width: '100%'
            });
            for (var i = 0; i < count; i++) {
                document.getElementById("tdchkselect" + i + "").checked = true;
            }
            //$("#fade").hide();
            //$("#modal").hide();
        },
        error: function (result) {
            $("#fade").hide();
            $("#modal").hide();
        }
    });
}

function PurposeChange() {
    $("#Timespnerror").hide();
    $("#ddlpurpose").css('border-color', '#0033a0');
    $("#visitorspnerror").hide();
    var Visitordrop = document.getElementById("ddlpurpose");
    var VisitorType = Visitordrop.options[Visitordrop.selectedIndex].text;
    $(".changename").html("<option>" + VisitorType + "</option>");
    if (VisitorType == "Select Visitor Type") {
        $("#btnNewVisitor").removeAttr("onclick");
        $("#btnNewVisitor").css('background-color', '#d9d9d9');
        $("#btnNewVisitor").attr('title', 'Please select the visitor type to add a new visitor.');
        $("#ddlpurpose").css('border-color', '#f4633a');
        $("#visitorspnerror").show();
    }
    else {
        $("#btnNewVisitor").attr("onclick", "AddNewvistor()");
        $("#btnNewVisitor").css('background-color', '#00b140');
        $("#btnNewVisitor").removeAttr('title');
    }
    if (VisitorType == "Family Members") {
        $(".changecomany").val("Optional");
    }
    else if (VisitorType == "Interview Candidate") {
        $(".changecomany").val("Interview");
    }
    else if (VisitorType == "Others") {
        $(".changecomany").val($("#txtothers").val());
    }
    else {
        $(".changecomany").val("");
    }
    if (VisitorType == "Client") {
        $("#txthostID").removeAttr("disabled");
        $("#txthostID").show();
        $(".tooltip").show();
        $("#divhostID").show();
        for (var i = 0; i < LocationCount; i++) {
            i = parseInt(i) + 1;
            $("#txthostID" + i).removeAttr("disabled");
            $("#txthostID" + i).show();
            $("#divhostID" + i).show();
        }
    }
    else {
        $("#txthostID").attr("disabled", "disabled");
        $("#txthostID").hide();
        $("#txtothers").hide();
        $("#divtxtothers").hide();
        $("#divhostID").hide();
        for (var i = 0; i < LocationCount; i++) {
            i = parseInt(i) + 1;
            $("#txthostID" + i).attr("disabled", "disabled");
            $("#txthostID" + i).hide();
            $("#divhostID" + i).hide();
        }
        $(".tooltip").hide();
    }
    if (VisitorType == "Interview Candidate" || VisitorType == "Others") {
        if (VisitorType == "Others") {
            $("#txtothers").val("");
            $("#txtothers").css("display", "block");
            $("#divtxtothers").show();
        }
        else {
            $("#txtothers").hide();
            $("#divtxtothers").hide();
        }
        //$(".dataaccesscheckbox").attr("disabled", "disabled");
        //$(".dataaccesscheckbox").prop("checked", false);
        //$(".dataaccesscheckbox1").attr("disabled", "disabled");
        //$(".dataaccesscheckbox").prop("checked", false);
        //$(".Recentvisitortablebodytrodd").css("background-color", "transparent"); 
        //$(".Recentvisitortablebodytreven").css("background-color", "transparent");

        //$("#txtSerachbox").attr("disabled", "disabled"); 
        //$("#btnSearch").attr("disabled", "disabled");
        $("#AddMoreLocation").html("Bulk Upload");
        $("#AddMoreLocation").css("margin-left", "178px");
        $("#AddMoreLocation").attr("onclick", "BulkUpload()");
        document.getElementById('BulkUploadframe').contentWindow.location.reload(true);
        for (f = 0; f < LocationCount; f++) {
            f = f + 1;
            $("#Locationdetails" + f).remove();
        }
    }
    else {
        $(".dataaccesscheckbox").removeAttr("disabled");
        $(".dataaccesscheckbox1").removeAttr("disabled");
        $("#txtSerachbox").removeAttr("disabled");
        $("#btnSearch").removeAttr("disabled");
        $("#AddMoreLocation").html("<img src='images/New%20Images/img_trans.gif' class='AddmoreDivimg' /> Add More Location");
        $("#AddMoreLocation").css("margin-left", "127px");
        $("#AddMoreLocation").attr("onclick", "AddExtraLocation(0)");
        $("#txtothers").hide();
        $("#divtxtothers").hide();
    }

    $(".divLocationdetails").remove();
    $('#ddllocationlist').val("0");
    LocationCount = 0;
    $('#ddllocationlist').trigger('change');
    $('#sandbox-container input').datepicker('update', '');
    ////var fromNow = new Date();
    ////var minutes = 5;
    ////var hour = 3
    ////fromNow.setMinutes(fromNow.getMinutes() + minutes);
    ////var fromhour = fromNow.getHours();
    ////var fromminute = fromNow.getMinutes();
    ////var toNow = new Date();
    ////toNow.setHours(toNow.getHours() + hour);
    ////toNow.setMinutes(toNow.getMinutes() + minutes);
    ////var tohour = toNow.getHours();
    ////var tominute = toNow.getMinutes();
    ////var frommin = 0;
    ////var tomin = 0;

    ////if (fromminute >= 0 && fromminute < 15) {
    ////    fromNow.setMinutes(fromNow.getMinutes() + (15 - fromminute));
    ////    toNow.setMinutes(15);
    ////}
    ////else if (fromminute >= 15 && fromminute < 30) {
    ////    fromNow.setMinutes(fromNow.getMinutes() + (30 - fromminute));
    ////    toNow.setMinutes(30);
    ////}
    ////else if (fromminute >= 30 && fromminute < 45) {
    ////    fromNow.setMinutes(fromNow.getMinutes() + (45 - fromminute));
    ////    toNow.setMinutes(45);
    ////}
    ////else {
    ////    fromNow.setMinutes(fromNow.getMinutes() + (60 - fromminute));
    ////    toNow.setMinutes(45 + 15)//// Need to test this when the user opens the request between 45 - 59 minutes
    ////}
    ////var ampm = (fromhour >= 12) ? 'PM' : 'AM';
    ////fromhour = fromhour % 12;
    ////fromhour = fromhour ? fromhour : 12;
    ////fromhour = fromhour < 10 ? '0' + fromhour : fromhour;
    ////fromminute = fromminute < 10 ? '0' + fromminute : fromminute;
    ////var time = appendZero(fromNow.getHours(), 2) + ':' + appendZero(fromNow.getMinutes(), 2);

    $("#txtstarttime").val("09:00");

    ////var ampm1 = (tohour >= 12) ? 'PM' : 'AM';
    ////tohour = tohour % 12;
    ////tohour = tohour ? tohour : 12;
    ////tohour = tohour < 10 ? '0' + tohour : tohour;
    ////tominute = tominute < 10 ? '0' + tominute : tominute;
    ////var time1 = appendZero(toNow.getHours(), 2) + ':' + appendZero(toNow.getMinutes(), 2);
    $("#txtendtime").val("18:00");
    $(".btnPreviewSubmit").text("Preview & Submit");
    $(".btnPreviewSubmit").attr("title", "Preview & Submit");
    $("#txthostID").val("");
    var CurrentLocation = document.getElementById("hdnLocationCode").value;
    $('#ddllocationlist').val(CurrentLocation);
    $('#ddllocationlist').trigger('change');
    $("#txthostID").val(document.getElementById("hdnMHostID").value);
}

function initPicker(picker, selectedDates) {
    var isInit = false;
    var kendoPicker = picker.data('kendoDatePicker');

    kendoPicker.bind('open', function () {
        if (!isInit) {
            var calendar = $('#' + picker.attr('id') + '_dateview > .k-calendar');
            initCalendar(calendar, selectedDates, function () {
                updatePicker(picker, selectedDates);
            });
            isInit = true;
        }
    });

    picker.on('input change blur', function () {
        updatePicker(picker, selectedDates);
    });

    updatePicker(picker, selectedDates);
}

function initCalendar(calendar, selectedDates, onUpdate) {
    var kendoCalendar = calendar.data('kendoCalendar');

    kendoCalendar.bind('navigate', function () {
        setTimeout(function () {
            updateCalendar(calendar, selectedDates);
        }, 0);
    });

    updateCalendar(calendar, selectedDates);

    calendar.on('click', function (event) {
        var cell = $(event.target).closest('td');
        var isClickedOnDayCell = cell.length !== 0 && isDayCell(cell);

        if (isClickedOnDayCell) {
            var date = dateFromCell(cell).getTime();
            var isDateAlreadySelected = selectedDates.some(function (selected) {
                return selected === date;
            });

            if (isDateAlreadySelected) {
                selectedDates.splice(selectedDates.indexOf(date), 1);

            } else {
                selectedDates.push(date);
            }

            updateCell(cell, selectedDates);

            if (onUpdate !== undefined) {
                onUpdate();
            }
        }
    });
}

function updatePicker(picker, selectedDates) {
    var datesString = selectedDates.sort().reduce(function (acc, selected, index) {
        var date = new Date(selected);
        var formattedDate = (date.getMonth() + 1) + '/' + date.getDate() + '/' + date.getFullYear();

        return acc + formattedDate + (index === (selectedDates.length - 1) ? '' : ', ');
    }, '');

    picker.val(datesString);
}

function updateCalendar(calendar, selectedDates) {
    calendar.find('td > a').parent().each(function (i, item) {
        var cell = $(item);

        if (isDayCell(cell)) {
            updateCell(cell, selectedDates);
        }
    });
}

function updateCell(cell, selectedDates) {
    var isCellSelected = selectedDates.some(function (selected) {
        return selected === dateFromCell(cell).getTime();
    });

    if (isCellSelected) {
        cell.addClass('selected1');

    } else {
        cell.removeClass('selected1');
    }
}

function isDayCell(cell) {
    return /^\d{1,2}$/.test(cell.find('a').text());
}

function dateFromCell(cell) {
    return new Date(convertDataValue(cell.find('a').attr('data-value')));
}

function convertDataValue(date) {
    var regex = /\/(\d+)\//;
    var month = +date.match(regex)[1] + 1;

    return date.replace(regex, '/' + month + '/');
}
function AgreeTerms() {
    if ($("#styled-checkbox2").is(':checked')) {

        $("#btnAgreeTerms").prop("disabled", false);
    }
    else {
        $("#btnAgreeTerms").prop("disabled", true);
    }
}
function closePopup() {

    $("#coronaguideline").removeClass('show');
    var text = "N";
    $.ajax({
        url: 'HomePage.aspx/SetCovidValue',
        data: '{"covidalertchk":"' + text + '"}',
        dataType: "json",
        type: "POST",
        contentType: "application/json; charset=utf-8",
        success: function (data) {
        },
        error: function () {
        }
    });
}
